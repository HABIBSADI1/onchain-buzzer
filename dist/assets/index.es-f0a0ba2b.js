import{r as Dw,g as eh,d as Iw,a as fd,c as Ro,_ as Sw}from"./index-d2d9d8b3.js";import{e as wr,E as th}from"./events-01c74e51.js";import{s as Aw,f as Ow,a as xw,d as Cw,g as Fw,b as pd,c as Pw,e as $w,h as ys,i as sa,r as dd,j as vs,k as oa,l as Cr,m as ms,n as Ff,o as Nw,p as Tw,q as rh,t as Rw,u as ih,v as nh,w as bi,x as Vi}from"./index.es-4a10c183.js";var sh={},aa={},Ae={},gd={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(f,p){var d=f>>>16&65535,g=f&65535,b=p>>>16&65535,E=p&65535;return g*E+(d*E+g*b<<16>>>0)|0}r.mul=Math.imul||e;function t(f,p){return f+p|0}r.add=t;function s(f,p){return f-p|0}r.sub=s;function o(f,p){return f<<p|f>>>32-p}r.rotl=o;function c(f,p){return f<<32-p|f>>>p}r.rotr=c;function h(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}r.isInteger=Number.isInteger||h,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(f){return r.isInteger(f)&&f>=-r.MAX_SAFE_INTEGER&&f<=r.MAX_SAFE_INTEGER}})(gd);Object.defineProperty(Ae,"__esModule",{value:!0});var yd=gd;function Uw(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}Ae.readInt16BE=Uw;function jw(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}Ae.readUint16BE=jw;function Bw(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}Ae.readInt16LE=Bw;function Mw(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}Ae.readUint16LE=Mw;function vd(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}Ae.writeUint16BE=vd;Ae.writeInt16BE=vd;function md(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}Ae.writeUint16LE=md;Ae.writeInt16LE=md;function Au(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}Ae.readInt32BE=Au;function Ou(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}Ae.readUint32BE=Ou;function xu(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}Ae.readInt32LE=xu;function Cu(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}Ae.readUint32LE=Cu;function Zo(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}Ae.writeUint32BE=Zo;Ae.writeInt32BE=Zo;function Xo(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}Ae.writeUint32LE=Xo;Ae.writeInt32LE=Xo;function Lw(r,e){e===void 0&&(e=0);var t=Au(r,e),s=Au(r,e+4);return t*4294967296+s-(s>>31)*4294967296}Ae.readInt64BE=Lw;function zw(r,e){e===void 0&&(e=0);var t=Ou(r,e),s=Ou(r,e+4);return t*4294967296+s}Ae.readUint64BE=zw;function qw(r,e){e===void 0&&(e=0);var t=xu(r,e),s=xu(r,e+4);return s*4294967296+t-(t>>31)*4294967296}Ae.readInt64LE=qw;function Hw(r,e){e===void 0&&(e=0);var t=Cu(r,e),s=Cu(r,e+4);return s*4294967296+t}Ae.readUint64LE=Hw;function bd(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Zo(r/4294967296>>>0,e,t),Zo(r>>>0,e,t+4),e}Ae.writeUint64BE=bd;Ae.writeInt64BE=bd;function wd(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Xo(r>>>0,e,t),Xo(r/4294967296>>>0,e,t+4),e}Ae.writeUint64LE=wd;Ae.writeInt64LE=wd;function Kw(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=r/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Ae.readUintBE=Kw;function Vw(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+r/8;c++)s+=e[c]*o,o*=256;return s}Ae.readUintLE=Vw;function kw(r,e,t,s){if(t===void 0&&(t=new Uint8Array(r/8)),s===void 0&&(s=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!yd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=r/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Ae.writeUintBE=kw;function Gw(r,e,t,s){if(t===void 0&&(t=new Uint8Array(r/8)),s===void 0&&(s=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!yd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+r/8;c++)t[c]=e/o&255,o*=256;return t}Ae.writeUintLE=Gw;function Ww(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}Ae.readFloat32BE=Ww;function Yw(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}Ae.readFloat32LE=Yw;function Jw(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}Ae.readFloat64BE=Jw;function Zw(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}Ae.readFloat64LE=Zw;function Xw(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,r),e}Ae.writeFloat32BE=Xw;function Qw(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,r,!0),e}Ae.writeFloat32LE=Qw;function e_(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,r),e}Ae.writeFloat64BE=e_;function t_(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,r,!0),e}Ae.writeFloat64LE=t_;var $r={};Object.defineProperty($r,"__esModule",{value:!0});function r_(r){for(var e=0;e<r.length;e++)r[e]=0;return r}$r.wipe=r_;Object.defineProperty(aa,"__esModule",{value:!0});var Bt=Ae,Fu=$r,i_=20;function n_(r,e,t){for(var s=1634760805,o=857760878,c=2036477234,h=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],p=t[7]<<24|t[6]<<16|t[5]<<8|t[4],d=t[11]<<24|t[10]<<16|t[9]<<8|t[8],g=t[15]<<24|t[14]<<16|t[13]<<8|t[12],b=t[19]<<24|t[18]<<16|t[17]<<8|t[16],E=t[23]<<24|t[22]<<16|t[21]<<8|t[20],I=t[27]<<24|t[26]<<16|t[25]<<8|t[24],S=t[31]<<24|t[30]<<16|t[29]<<8|t[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],B=e[7]<<24|e[6]<<16|e[5]<<8|e[4],H=e[11]<<24|e[10]<<16|e[9]<<8|e[8],P=e[15]<<24|e[14]<<16|e[13]<<8|e[12],O=s,D=o,x=c,C=h,l=f,w=p,K=d,Z=g,ae=b,ue=E,pe=I,de=S,Y=R,M=B,j=H,G=P,ne=0;ne<i_;ne+=2)O=O+l|0,Y^=O,Y=Y>>>32-16|Y<<16,ae=ae+Y|0,l^=ae,l=l>>>32-12|l<<12,D=D+w|0,M^=D,M=M>>>32-16|M<<16,ue=ue+M|0,w^=ue,w=w>>>32-12|w<<12,x=x+K|0,j^=x,j=j>>>32-16|j<<16,pe=pe+j|0,K^=pe,K=K>>>32-12|K<<12,C=C+Z|0,G^=C,G=G>>>32-16|G<<16,de=de+G|0,Z^=de,Z=Z>>>32-12|Z<<12,x=x+K|0,j^=x,j=j>>>32-8|j<<8,pe=pe+j|0,K^=pe,K=K>>>32-7|K<<7,C=C+Z|0,G^=C,G=G>>>32-8|G<<8,de=de+G|0,Z^=de,Z=Z>>>32-7|Z<<7,D=D+w|0,M^=D,M=M>>>32-8|M<<8,ue=ue+M|0,w^=ue,w=w>>>32-7|w<<7,O=O+l|0,Y^=O,Y=Y>>>32-8|Y<<8,ae=ae+Y|0,l^=ae,l=l>>>32-7|l<<7,O=O+w|0,G^=O,G=G>>>32-16|G<<16,pe=pe+G|0,w^=pe,w=w>>>32-12|w<<12,D=D+K|0,Y^=D,Y=Y>>>32-16|Y<<16,de=de+Y|0,K^=de,K=K>>>32-12|K<<12,x=x+Z|0,M^=x,M=M>>>32-16|M<<16,ae=ae+M|0,Z^=ae,Z=Z>>>32-12|Z<<12,C=C+l|0,j^=C,j=j>>>32-16|j<<16,ue=ue+j|0,l^=ue,l=l>>>32-12|l<<12,x=x+Z|0,M^=x,M=M>>>32-8|M<<8,ae=ae+M|0,Z^=ae,Z=Z>>>32-7|Z<<7,C=C+l|0,j^=C,j=j>>>32-8|j<<8,ue=ue+j|0,l^=ue,l=l>>>32-7|l<<7,D=D+K|0,Y^=D,Y=Y>>>32-8|Y<<8,de=de+Y|0,K^=de,K=K>>>32-7|K<<7,O=O+w|0,G^=O,G=G>>>32-8|G<<8,pe=pe+G|0,w^=pe,w=w>>>32-7|w<<7;Bt.writeUint32LE(O+s|0,r,0),Bt.writeUint32LE(D+o|0,r,4),Bt.writeUint32LE(x+c|0,r,8),Bt.writeUint32LE(C+h|0,r,12),Bt.writeUint32LE(l+f|0,r,16),Bt.writeUint32LE(w+p|0,r,20),Bt.writeUint32LE(K+d|0,r,24),Bt.writeUint32LE(Z+g|0,r,28),Bt.writeUint32LE(ae+b|0,r,32),Bt.writeUint32LE(ue+E|0,r,36),Bt.writeUint32LE(pe+I|0,r,40),Bt.writeUint32LE(de+S|0,r,44),Bt.writeUint32LE(Y+R|0,r,48),Bt.writeUint32LE(M+B|0,r,52),Bt.writeUint32LE(j+H|0,r,56),Bt.writeUint32LE(G+P|0,r,60)}function _d(r,e,t,s,o){if(o===void 0&&(o=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,h;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),h=c.length-e.length,c.set(e,h)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,h=o}for(var f=new Uint8Array(64),p=0;p<t.length;p+=64){n_(f,c,r);for(var d=p;d<p+64&&d<t.length;d++)s[d]=t[d]^f[d-p];o_(c,0,h)}return Fu.wipe(f),o===0&&Fu.wipe(c),s}aa.streamXOR=_d;function s_(r,e,t,s){return s===void 0&&(s=0),Fu.wipe(t),_d(r,e,t,t,s)}aa.stream=s_;function o_(r,e,t){for(var s=1;t--;)s=s+(r[e]&255)|0,r[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Ed={},Di={};Object.defineProperty(Di,"__esModule",{value:!0});function a_(r,e,t){return~(r-1)&e|r-1&t}Di.select=a_;function c_(r,e){return(r|0)-(e|0)-1>>>31&1}Di.lessOrEqual=c_;function Dd(r,e){if(r.length!==e.length)return 0;for(var t=0,s=0;s<r.length;s++)t|=r[s]^e[s];return 1&t-1>>>8}Di.compare=Dd;function u_(r,e){return r.length===0||e.length===0?!1:Dd(r,e)!==0}Di.equal=u_;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Di,t=$r;r.DIGEST_LENGTH=16;var s=function(){function h(f){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var p=f[0]|f[1]<<8;this._r[0]=p&8191;var d=f[2]|f[3]<<8;this._r[1]=(p>>>13|d<<3)&8191;var g=f[4]|f[5]<<8;this._r[2]=(d>>>10|g<<6)&7939;var b=f[6]|f[7]<<8;this._r[3]=(g>>>7|b<<9)&8191;var E=f[8]|f[9]<<8;this._r[4]=(b>>>4|E<<12)&255,this._r[5]=E>>>1&8190;var I=f[10]|f[11]<<8;this._r[6]=(E>>>14|I<<2)&8191;var S=f[12]|f[13]<<8;this._r[7]=(I>>>11|S<<5)&8065;var R=f[14]|f[15]<<8;this._r[8]=(S>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return h.prototype._blocks=function(f,p,d){for(var g=this._fin?0:2048,b=this._h[0],E=this._h[1],I=this._h[2],S=this._h[3],R=this._h[4],B=this._h[5],H=this._h[6],P=this._h[7],O=this._h[8],D=this._h[9],x=this._r[0],C=this._r[1],l=this._r[2],w=this._r[3],K=this._r[4],Z=this._r[5],ae=this._r[6],ue=this._r[7],pe=this._r[8],de=this._r[9];d>=16;){var Y=f[p+0]|f[p+1]<<8;b+=Y&8191;var M=f[p+2]|f[p+3]<<8;E+=(Y>>>13|M<<3)&8191;var j=f[p+4]|f[p+5]<<8;I+=(M>>>10|j<<6)&8191;var G=f[p+6]|f[p+7]<<8;S+=(j>>>7|G<<9)&8191;var ne=f[p+8]|f[p+9]<<8;R+=(G>>>4|ne<<12)&8191,B+=ne>>>1&8191;var se=f[p+10]|f[p+11]<<8;H+=(ne>>>14|se<<2)&8191;var ie=f[p+12]|f[p+13]<<8;P+=(se>>>11|ie<<5)&8191;var ge=f[p+14]|f[p+15]<<8;O+=(ie>>>8|ge<<8)&8191,D+=ge>>>5|g;var W=0,re=W;re+=b*x,re+=E*(5*de),re+=I*(5*pe),re+=S*(5*ue),re+=R*(5*ae),W=re>>>13,re&=8191,re+=B*(5*Z),re+=H*(5*K),re+=P*(5*w),re+=O*(5*l),re+=D*(5*C),W+=re>>>13,re&=8191;var J=W;J+=b*C,J+=E*x,J+=I*(5*de),J+=S*(5*pe),J+=R*(5*ue),W=J>>>13,J&=8191,J+=B*(5*ae),J+=H*(5*Z),J+=P*(5*K),J+=O*(5*w),J+=D*(5*l),W+=J>>>13,J&=8191;var le=W;le+=b*l,le+=E*C,le+=I*x,le+=S*(5*de),le+=R*(5*pe),W=le>>>13,le&=8191,le+=B*(5*ue),le+=H*(5*ae),le+=P*(5*Z),le+=O*(5*K),le+=D*(5*w),W+=le>>>13,le&=8191;var be=W;be+=b*w,be+=E*l,be+=I*C,be+=S*x,be+=R*(5*de),W=be>>>13,be&=8191,be+=B*(5*pe),be+=H*(5*ue),be+=P*(5*ae),be+=O*(5*Z),be+=D*(5*K),W+=be>>>13,be&=8191;var he=W;he+=b*K,he+=E*w,he+=I*l,he+=S*C,he+=R*x,W=he>>>13,he&=8191,he+=B*(5*de),he+=H*(5*pe),he+=P*(5*ue),he+=O*(5*ae),he+=D*(5*Z),W+=he>>>13,he&=8191;var ye=W;ye+=b*Z,ye+=E*K,ye+=I*w,ye+=S*l,ye+=R*C,W=ye>>>13,ye&=8191,ye+=B*x,ye+=H*(5*de),ye+=P*(5*pe),ye+=O*(5*ue),ye+=D*(5*ae),W+=ye>>>13,ye&=8191;var Ie=W;Ie+=b*ae,Ie+=E*Z,Ie+=I*K,Ie+=S*w,Ie+=R*l,W=Ie>>>13,Ie&=8191,Ie+=B*C,Ie+=H*x,Ie+=P*(5*de),Ie+=O*(5*pe),Ie+=D*(5*ue),W+=Ie>>>13,Ie&=8191;var De=W;De+=b*ue,De+=E*ae,De+=I*Z,De+=S*K,De+=R*w,W=De>>>13,De&=8191,De+=B*l,De+=H*C,De+=P*x,De+=O*(5*de),De+=D*(5*pe),W+=De>>>13,De&=8191;var Ce=W;Ce+=b*pe,Ce+=E*ue,Ce+=I*ae,Ce+=S*Z,Ce+=R*K,W=Ce>>>13,Ce&=8191,Ce+=B*w,Ce+=H*l,Ce+=P*C,Ce+=O*x,Ce+=D*(5*de),W+=Ce>>>13,Ce&=8191;var Ue=W;Ue+=b*de,Ue+=E*pe,Ue+=I*ue,Ue+=S*ae,Ue+=R*Z,W=Ue>>>13,Ue&=8191,Ue+=B*K,Ue+=H*w,Ue+=P*l,Ue+=O*C,Ue+=D*x,W+=Ue>>>13,Ue&=8191,W=(W<<2)+W|0,W=W+re|0,re=W&8191,W=W>>>13,J+=W,b=re,E=J,I=le,S=be,R=he,B=ye,H=Ie,P=De,O=Ce,D=Ue,p+=16,d-=16}this._h[0]=b,this._h[1]=E,this._h[2]=I,this._h[3]=S,this._h[4]=R,this._h[5]=B,this._h[6]=H,this._h[7]=P,this._h[8]=O,this._h[9]=D},h.prototype.finish=function(f,p){p===void 0&&(p=0);var d=new Uint16Array(10),g,b,E,I;if(this._leftover){for(I=this._leftover,this._buffer[I++]=1;I<16;I++)this._buffer[I]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(g=this._h[1]>>>13,this._h[1]&=8191,I=2;I<10;I++)this._h[I]+=g,g=this._h[I]>>>13,this._h[I]&=8191;for(this._h[0]+=g*5,g=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=g,g=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=g,d[0]=this._h[0]+5,g=d[0]>>>13,d[0]&=8191,I=1;I<10;I++)d[I]=this._h[I]+g,g=d[I]>>>13,d[I]&=8191;for(d[9]-=8192,b=(g^1)-1,I=0;I<10;I++)d[I]&=b;for(b=~b,I=0;I<10;I++)this._h[I]=this._h[I]&b|d[I];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,E=this._h[0]+this._pad[0],this._h[0]=E&65535,I=1;I<8;I++)E=(this._h[I]+this._pad[I]|0)+(E>>>16)|0,this._h[I]=E&65535;return f[p+0]=this._h[0]>>>0,f[p+1]=this._h[0]>>>8,f[p+2]=this._h[1]>>>0,f[p+3]=this._h[1]>>>8,f[p+4]=this._h[2]>>>0,f[p+5]=this._h[2]>>>8,f[p+6]=this._h[3]>>>0,f[p+7]=this._h[3]>>>8,f[p+8]=this._h[4]>>>0,f[p+9]=this._h[4]>>>8,f[p+10]=this._h[5]>>>0,f[p+11]=this._h[5]>>>8,f[p+12]=this._h[6]>>>0,f[p+13]=this._h[6]>>>8,f[p+14]=this._h[7]>>>0,f[p+15]=this._h[7]>>>8,this._finished=!0,this},h.prototype.update=function(f){var p=0,d=f.length,g;if(this._leftover){g=16-this._leftover,g>d&&(g=d);for(var b=0;b<g;b++)this._buffer[this._leftover+b]=f[p+b];if(d-=g,p+=g,this._leftover+=g,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(d>=16&&(g=d-d%16,this._blocks(f,p,g),p+=g,d-=g),d){for(var b=0;b<d;b++)this._buffer[this._leftover+b]=f[p+b];this._leftover+=d}return this},h.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},h.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},h}();r.Poly1305=s;function o(h,f){var p=new s(h);p.update(f);var d=p.digest();return p.clean(),d}r.oneTimeAuth=o;function c(h,f){return h.length!==r.DIGEST_LENGTH||f.length!==r.DIGEST_LENGTH?!1:e.equal(h,f)}r.equal=c})(Ed);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=aa,t=Ed,s=$r,o=Ae,c=Di;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var h=new Uint8Array(16),f=function(){function p(d){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,d.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(d)}return p.prototype.seal=function(d,g,b,E){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var I=new Uint8Array(16);I.set(d,I.length-d.length);var S=new Uint8Array(32);e.stream(this._key,I,S,4);var R=g.length+this.tagLength,B;if(E){if(E.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");B=E}else B=new Uint8Array(R);return e.streamXOR(this._key,I,g,B,4),this._authenticate(B.subarray(B.length-this.tagLength,B.length),S,B.subarray(0,B.length-this.tagLength),b),s.wipe(I),B},p.prototype.open=function(d,g,b,E){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(g.length<this.tagLength)return null;var I=new Uint8Array(16);I.set(d,I.length-d.length);var S=new Uint8Array(32);e.stream(this._key,I,S,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,S,g.subarray(0,g.length-this.tagLength),b),!c.equal(R,g.subarray(g.length-this.tagLength,g.length)))return null;var B=g.length-this.tagLength,H;if(E){if(E.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");H=E}else H=new Uint8Array(B);return e.streamXOR(this._key,I,g.subarray(0,g.length-this.tagLength),H,4),s.wipe(I),H},p.prototype.clean=function(){return s.wipe(this._key),this},p.prototype._authenticate=function(d,g,b,E){var I=new t.Poly1305(g);E&&(I.update(E),E.length%16>0&&I.update(h.subarray(E.length%16))),I.update(b),b.length%16>0&&I.update(h.subarray(b.length%16));var S=new Uint8Array(8);E&&o.writeUint64LE(E.length,S),I.update(S),o.writeUint64LE(b.length,S),I.update(S);for(var R=I.digest(),B=0;B<R.length;B++)d[B]=R[B];I.clean(),s.wipe(R),s.wipe(S)},p}();r.ChaCha20Poly1305=f})(sh);var Id={},bs={},oh={};Object.defineProperty(oh,"__esModule",{value:!0});function h_(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}oh.isSerializableHash=h_;Object.defineProperty(bs,"__esModule",{value:!0});var Mr=oh,l_=Di,f_=$r,Sd=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Mr.isSerializableHash(this._inner)&&Mr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),f_.wipe(s)}return r.prototype.reset=function(){if(!Mr.isSerializableHash(this._inner)||!Mr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Mr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Mr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Mr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Mr.isSerializableHash(this._inner)||!Mr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Mr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();bs.HMAC=Sd;function p_(r,e,t){var s=new Sd(r,e);s.update(t);var o=s.digest();return s.clean(),o}bs.hmac=p_;bs.equal=l_.equal;Object.defineProperty(Id,"__esModule",{value:!0});var Pf=bs,$f=$r,d_=function(){function r(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Pf.hmac(this._hash,s,t);this._hmac=new Pf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),$f.wipe(this._buffer),$f.wipe(this._counter),this._bufpos=0},r}(),g_=Id.HKDF=d_,ca={},ua={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.BrowserRandomSource=void 0;const Nf=65536;class y_{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=Nf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,Nf)));return t}}ha.BrowserRandomSource=y_;function v_(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var la={};Object.defineProperty(la,"__esModule",{value:!0});la.NodeRandomSource=void 0;const m_=$r;class b_{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof v_<"u"){const e=Dw;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,m_.wipe)(t),s}}la.NodeRandomSource=b_;Object.defineProperty(ua,"__esModule",{value:!0});ua.SystemRandomSource=void 0;const w_=ha,__=la;class E_{constructor(){if(this.isAvailable=!1,this.name="",this._source=new w_.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new __.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ua.SystemRandomSource=E_;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=ua,t=Ae,s=$r;r.defaultRandomSource=new e.SystemRandomSource;function o(d,g=r.defaultRandomSource){return g.randomBytes(d)}r.randomBytes=o;function c(d=r.defaultRandomSource){const g=o(4,d),b=(0,t.readUint32LE)(g);return(0,s.wipe)(g),b}r.randomUint32=c;const h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(d,g=h,b=r.defaultRandomSource){if(g.length<2)throw new Error("randomString charset is too short");if(g.length>256)throw new Error("randomString charset is too long");let E="";const I=g.length,S=256-256%I;for(;d>0;){const R=o(Math.ceil(d*256/S),b);for(let B=0;B<R.length&&d>0;B++){const H=R[B];H<S&&(E+=g.charAt(H%I),d--)}(0,s.wipe)(R)}return E}r.randomString=f;function p(d,g=h,b=r.defaultRandomSource){const E=Math.ceil(d/(Math.log(g.length)/Math.LN2));return f(E,g,b)}r.randomStringForEntropy=p})(ca);var fa={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Ae,t=$r;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(p,d){if(d===void 0&&(d=p.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var g=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&d>0;)this._buffer[this._bufferLength++]=p[g++],d--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(g=c(this._temp,this._state,p,g,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=p[g++],d--;return this},f.prototype.finish=function(p){if(!this._finished){var d=this._bytesHashed,g=this._bufferLength,b=d/536870912|0,E=d<<3,I=d%64<56?64:128;this._buffer[g]=128;for(var S=g+1;S<I-8;S++)this._buffer[S]=0;e.writeUint32BE(b,this._buffer,I-8),e.writeUint32BE(E,this._buffer,I-4),c(this._temp,this._state,this._buffer,0,I),this._finished=!0}for(var S=0;S<this.digestLength/4;S++)e.writeUint32BE(this._state[S],p,S*4);return this},f.prototype.digest=function(){var p=new Uint8Array(this.digestLength);return this.finish(p),p},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(p){return this._state.set(p.state),this._bufferLength=p.bufferLength,p.buffer&&this._buffer.set(p.buffer),this._bytesHashed=p.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(p){t.wipe(p.state),p.buffer&&t.wipe(p.buffer),p.bufferLength=0,p.bytesHashed=0},f}();r.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,p,d,g,b){for(;b>=64;){for(var E=p[0],I=p[1],S=p[2],R=p[3],B=p[4],H=p[5],P=p[6],O=p[7],D=0;D<16;D++){var x=g+D*4;f[D]=e.readUint32BE(d,x)}for(var D=16;D<64;D++){var C=f[D-2],l=(C>>>17|C<<32-17)^(C>>>19|C<<32-19)^C>>>10;C=f[D-15];var w=(C>>>7|C<<32-7)^(C>>>18|C<<32-18)^C>>>3;f[D]=(l+f[D-7]|0)+(w+f[D-16]|0)}for(var D=0;D<64;D++){var l=(((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&H^~B&P)|0)+(O+(o[D]+f[D]|0)|0)|0,w=((E>>>2|E<<32-2)^(E>>>13|E<<32-13)^(E>>>22|E<<32-22))+(E&I^E&S^I&S)|0;O=P,P=H,H=B,B=R+l|0,R=S,S=I,I=E,E=l+w|0}p[0]+=E,p[1]+=I,p[2]+=S,p[3]+=R,p[4]+=B,p[5]+=H,p[6]+=P,p[7]+=O,g+=64,b-=64}return g}function h(f){var p=new s;p.update(f);var d=p.digest();return p.clean(),d}r.hash=h})(fa);var ah={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=ca,t=$r;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function s(D){const x=new Float64Array(16);if(D)for(let C=0;C<D.length;C++)x[C]=D[C];return x}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function h(D){let x=1;for(let C=0;C<16;C++){let l=D[C]+x+65535;x=Math.floor(l/65536),D[C]=l-x*65536}D[0]+=x-1+37*(x-1)}function f(D,x,C){const l=~(C-1);for(let w=0;w<16;w++){const K=l&(D[w]^x[w]);D[w]^=K,x[w]^=K}}function p(D,x){const C=s(),l=s();for(let w=0;w<16;w++)l[w]=x[w];h(l),h(l),h(l);for(let w=0;w<2;w++){C[0]=l[0]-65517;for(let Z=1;Z<15;Z++)C[Z]=l[Z]-65535-(C[Z-1]>>16&1),C[Z-1]&=65535;C[15]=l[15]-32767-(C[14]>>16&1);const K=C[15]>>16&1;C[14]&=65535,f(l,C,1-K)}for(let w=0;w<16;w++)D[2*w]=l[w]&255,D[2*w+1]=l[w]>>8}function d(D,x){for(let C=0;C<16;C++)D[C]=x[2*C]+(x[2*C+1]<<8);D[15]&=32767}function g(D,x,C){for(let l=0;l<16;l++)D[l]=x[l]+C[l]}function b(D,x,C){for(let l=0;l<16;l++)D[l]=x[l]-C[l]}function E(D,x,C){let l,w,K=0,Z=0,ae=0,ue=0,pe=0,de=0,Y=0,M=0,j=0,G=0,ne=0,se=0,ie=0,ge=0,W=0,re=0,J=0,le=0,be=0,he=0,ye=0,Ie=0,De=0,Ce=0,Ue=0,Xe=0,Rt=0,_r=0,St=0,Nr=0,Vr=0,Ke=C[0],Re=C[1],Ve=C[2],Ze=C[3],nt=C[4],ke=C[5],st=C[6],Le=C[7],ze=C[8],Qe=C[9],je=C[10],ot=C[11],at=C[12],ht=C[13],ct=C[14],et=C[15];l=x[0],K+=l*Ke,Z+=l*Re,ae+=l*Ve,ue+=l*Ze,pe+=l*nt,de+=l*ke,Y+=l*st,M+=l*Le,j+=l*ze,G+=l*Qe,ne+=l*je,se+=l*ot,ie+=l*at,ge+=l*ht,W+=l*ct,re+=l*et,l=x[1],Z+=l*Ke,ae+=l*Re,ue+=l*Ve,pe+=l*Ze,de+=l*nt,Y+=l*ke,M+=l*st,j+=l*Le,G+=l*ze,ne+=l*Qe,se+=l*je,ie+=l*ot,ge+=l*at,W+=l*ht,re+=l*ct,J+=l*et,l=x[2],ae+=l*Ke,ue+=l*Re,pe+=l*Ve,de+=l*Ze,Y+=l*nt,M+=l*ke,j+=l*st,G+=l*Le,ne+=l*ze,se+=l*Qe,ie+=l*je,ge+=l*ot,W+=l*at,re+=l*ht,J+=l*ct,le+=l*et,l=x[3],ue+=l*Ke,pe+=l*Re,de+=l*Ve,Y+=l*Ze,M+=l*nt,j+=l*ke,G+=l*st,ne+=l*Le,se+=l*ze,ie+=l*Qe,ge+=l*je,W+=l*ot,re+=l*at,J+=l*ht,le+=l*ct,be+=l*et,l=x[4],pe+=l*Ke,de+=l*Re,Y+=l*Ve,M+=l*Ze,j+=l*nt,G+=l*ke,ne+=l*st,se+=l*Le,ie+=l*ze,ge+=l*Qe,W+=l*je,re+=l*ot,J+=l*at,le+=l*ht,be+=l*ct,he+=l*et,l=x[5],de+=l*Ke,Y+=l*Re,M+=l*Ve,j+=l*Ze,G+=l*nt,ne+=l*ke,se+=l*st,ie+=l*Le,ge+=l*ze,W+=l*Qe,re+=l*je,J+=l*ot,le+=l*at,be+=l*ht,he+=l*ct,ye+=l*et,l=x[6],Y+=l*Ke,M+=l*Re,j+=l*Ve,G+=l*Ze,ne+=l*nt,se+=l*ke,ie+=l*st,ge+=l*Le,W+=l*ze,re+=l*Qe,J+=l*je,le+=l*ot,be+=l*at,he+=l*ht,ye+=l*ct,Ie+=l*et,l=x[7],M+=l*Ke,j+=l*Re,G+=l*Ve,ne+=l*Ze,se+=l*nt,ie+=l*ke,ge+=l*st,W+=l*Le,re+=l*ze,J+=l*Qe,le+=l*je,be+=l*ot,he+=l*at,ye+=l*ht,Ie+=l*ct,De+=l*et,l=x[8],j+=l*Ke,G+=l*Re,ne+=l*Ve,se+=l*Ze,ie+=l*nt,ge+=l*ke,W+=l*st,re+=l*Le,J+=l*ze,le+=l*Qe,be+=l*je,he+=l*ot,ye+=l*at,Ie+=l*ht,De+=l*ct,Ce+=l*et,l=x[9],G+=l*Ke,ne+=l*Re,se+=l*Ve,ie+=l*Ze,ge+=l*nt,W+=l*ke,re+=l*st,J+=l*Le,le+=l*ze,be+=l*Qe,he+=l*je,ye+=l*ot,Ie+=l*at,De+=l*ht,Ce+=l*ct,Ue+=l*et,l=x[10],ne+=l*Ke,se+=l*Re,ie+=l*Ve,ge+=l*Ze,W+=l*nt,re+=l*ke,J+=l*st,le+=l*Le,be+=l*ze,he+=l*Qe,ye+=l*je,Ie+=l*ot,De+=l*at,Ce+=l*ht,Ue+=l*ct,Xe+=l*et,l=x[11],se+=l*Ke,ie+=l*Re,ge+=l*Ve,W+=l*Ze,re+=l*nt,J+=l*ke,le+=l*st,be+=l*Le,he+=l*ze,ye+=l*Qe,Ie+=l*je,De+=l*ot,Ce+=l*at,Ue+=l*ht,Xe+=l*ct,Rt+=l*et,l=x[12],ie+=l*Ke,ge+=l*Re,W+=l*Ve,re+=l*Ze,J+=l*nt,le+=l*ke,be+=l*st,he+=l*Le,ye+=l*ze,Ie+=l*Qe,De+=l*je,Ce+=l*ot,Ue+=l*at,Xe+=l*ht,Rt+=l*ct,_r+=l*et,l=x[13],ge+=l*Ke,W+=l*Re,re+=l*Ve,J+=l*Ze,le+=l*nt,be+=l*ke,he+=l*st,ye+=l*Le,Ie+=l*ze,De+=l*Qe,Ce+=l*je,Ue+=l*ot,Xe+=l*at,Rt+=l*ht,_r+=l*ct,St+=l*et,l=x[14],W+=l*Ke,re+=l*Re,J+=l*Ve,le+=l*Ze,be+=l*nt,he+=l*ke,ye+=l*st,Ie+=l*Le,De+=l*ze,Ce+=l*Qe,Ue+=l*je,Xe+=l*ot,Rt+=l*at,_r+=l*ht,St+=l*ct,Nr+=l*et,l=x[15],re+=l*Ke,J+=l*Re,le+=l*Ve,be+=l*Ze,he+=l*nt,ye+=l*ke,Ie+=l*st,De+=l*Le,Ce+=l*ze,Ue+=l*Qe,Xe+=l*je,Rt+=l*ot,_r+=l*at,St+=l*ht,Nr+=l*ct,Vr+=l*et,K+=38*J,Z+=38*le,ae+=38*be,ue+=38*he,pe+=38*ye,de+=38*Ie,Y+=38*De,M+=38*Ce,j+=38*Ue,G+=38*Xe,ne+=38*Rt,se+=38*_r,ie+=38*St,ge+=38*Nr,W+=38*Vr,w=1,l=K+w+65535,w=Math.floor(l/65536),K=l-w*65536,l=Z+w+65535,w=Math.floor(l/65536),Z=l-w*65536,l=ae+w+65535,w=Math.floor(l/65536),ae=l-w*65536,l=ue+w+65535,w=Math.floor(l/65536),ue=l-w*65536,l=pe+w+65535,w=Math.floor(l/65536),pe=l-w*65536,l=de+w+65535,w=Math.floor(l/65536),de=l-w*65536,l=Y+w+65535,w=Math.floor(l/65536),Y=l-w*65536,l=M+w+65535,w=Math.floor(l/65536),M=l-w*65536,l=j+w+65535,w=Math.floor(l/65536),j=l-w*65536,l=G+w+65535,w=Math.floor(l/65536),G=l-w*65536,l=ne+w+65535,w=Math.floor(l/65536),ne=l-w*65536,l=se+w+65535,w=Math.floor(l/65536),se=l-w*65536,l=ie+w+65535,w=Math.floor(l/65536),ie=l-w*65536,l=ge+w+65535,w=Math.floor(l/65536),ge=l-w*65536,l=W+w+65535,w=Math.floor(l/65536),W=l-w*65536,l=re+w+65535,w=Math.floor(l/65536),re=l-w*65536,K+=w-1+37*(w-1),w=1,l=K+w+65535,w=Math.floor(l/65536),K=l-w*65536,l=Z+w+65535,w=Math.floor(l/65536),Z=l-w*65536,l=ae+w+65535,w=Math.floor(l/65536),ae=l-w*65536,l=ue+w+65535,w=Math.floor(l/65536),ue=l-w*65536,l=pe+w+65535,w=Math.floor(l/65536),pe=l-w*65536,l=de+w+65535,w=Math.floor(l/65536),de=l-w*65536,l=Y+w+65535,w=Math.floor(l/65536),Y=l-w*65536,l=M+w+65535,w=Math.floor(l/65536),M=l-w*65536,l=j+w+65535,w=Math.floor(l/65536),j=l-w*65536,l=G+w+65535,w=Math.floor(l/65536),G=l-w*65536,l=ne+w+65535,w=Math.floor(l/65536),ne=l-w*65536,l=se+w+65535,w=Math.floor(l/65536),se=l-w*65536,l=ie+w+65535,w=Math.floor(l/65536),ie=l-w*65536,l=ge+w+65535,w=Math.floor(l/65536),ge=l-w*65536,l=W+w+65535,w=Math.floor(l/65536),W=l-w*65536,l=re+w+65535,w=Math.floor(l/65536),re=l-w*65536,K+=w-1+37*(w-1),D[0]=K,D[1]=Z,D[2]=ae,D[3]=ue,D[4]=pe,D[5]=de,D[6]=Y,D[7]=M,D[8]=j,D[9]=G,D[10]=ne,D[11]=se,D[12]=ie,D[13]=ge,D[14]=W,D[15]=re}function I(D,x){E(D,x,x)}function S(D,x){const C=s();for(let l=0;l<16;l++)C[l]=x[l];for(let l=253;l>=0;l--)I(C,C),l!==2&&l!==4&&E(C,C,x);for(let l=0;l<16;l++)D[l]=C[l]}function R(D,x){const C=new Uint8Array(32),l=new Float64Array(80),w=s(),K=s(),Z=s(),ae=s(),ue=s(),pe=s();for(let j=0;j<31;j++)C[j]=D[j];C[31]=D[31]&127|64,C[0]&=248,d(l,x);for(let j=0;j<16;j++)K[j]=l[j];w[0]=ae[0]=1;for(let j=254;j>=0;--j){const G=C[j>>>3]>>>(j&7)&1;f(w,K,G),f(Z,ae,G),g(ue,w,Z),b(w,w,Z),g(Z,K,ae),b(K,K,ae),I(ae,ue),I(pe,w),E(w,Z,w),E(Z,K,ue),g(ue,w,Z),b(w,w,Z),I(K,w),b(Z,ae,pe),E(w,Z,c),g(w,w,ae),E(Z,Z,w),E(w,ae,pe),E(ae,K,l),I(K,ue),f(w,K,G),f(Z,ae,G)}for(let j=0;j<16;j++)l[j+16]=w[j],l[j+32]=Z[j],l[j+48]=K[j],l[j+64]=ae[j];const de=l.subarray(32),Y=l.subarray(16);S(de,de),E(Y,Y,de);const M=new Uint8Array(32);return p(M,Y),M}r.scalarMult=R;function B(D){return R(D,o)}r.scalarMultBase=B;function H(D){if(D.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const x=new Uint8Array(D);return{publicKey:B(x),secretKey:x}}r.generateKeyPairFromSeed=H;function P(D){const x=(0,e.randomBytes)(32,D),C=H(x);return(0,t.wipe)(x),C}r.generateKeyPair=P;function O(D,x,C=!1){if(D.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(x.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const l=R(D,x);if(C){let w=0;for(let K=0;K<l.length;K++)w|=l[K];if(w===0)throw new Error("X25519: invalid shared key")}return l}r.sharedKey=O})(ah);function ch(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Ad(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ch(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Tf(r,e){e||(e=r.reduce((o,c)=>o+c.length,0));const t=Ad(e);let s=0;for(const o of r)t.set(o,s),s+=o.length;return ch(t)}function D_(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<r.length;o++){var c=r.charAt(o),h=c.charCodeAt(0);if(t[h]!==255)throw new TypeError(c+" is ambiguous");t[h]=o}var f=r.length,p=r.charAt(0),d=Math.log(f)/Math.log(256),g=Math.log(256)/Math.log(f);function b(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var R=0,B=0,H=0,P=S.length;H!==P&&S[H]===0;)H++,R++;for(var O=(P-H)*g+1>>>0,D=new Uint8Array(O);H!==P;){for(var x=S[H],C=0,l=O-1;(x!==0||C<B)&&l!==-1;l--,C++)x+=256*D[l]>>>0,D[l]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");B=C,H++}for(var w=O-B;w!==O&&D[w]===0;)w++;for(var K=p.repeat(R);w<O;++w)K+=r.charAt(D[w]);return K}function E(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var R=0;if(S[R]!==" "){for(var B=0,H=0;S[R]===p;)B++,R++;for(var P=(S.length-R)*d+1>>>0,O=new Uint8Array(P);S[R];){var D=t[S.charCodeAt(R)];if(D===255)return;for(var x=0,C=P-1;(D!==0||x<H)&&C!==-1;C--,x++)D+=f*O[C]>>>0,O[C]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");H=x,R++}if(S[R]!==" "){for(var l=P-H;l!==P&&O[l]===0;)l++;for(var w=new Uint8Array(B+(P-l)),K=B;l!==P;)w[K++]=O[l++];return w}}}function I(S){var R=E(S);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:E,decode:I}}var I_=D_,S_=I_;const A_=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},O_=r=>new TextEncoder().encode(r),x_=r=>new TextDecoder().decode(r);class C_{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class F_{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Od(this,e)}}class P_{constructor(e){this.decoders=e}or(e){return Od(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Od=(r,e)=>new P_({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class $_{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new C_(e,t,s),this.decoder=new F_(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pa=({name:r,prefix:e,encode:t,decode:s})=>new $_(r,e,t,s),ws=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:o}=S_(t,e);return pa({prefix:r,name:e,encode:s,decode:c=>A_(o(c))})},N_=(r,e,t,s)=>{const o={};for(let g=0;g<e.length;++g)o[e[g]]=g;let c=r.length;for(;r[c-1]==="=";)--c;const h=new Uint8Array(c*t/8|0);let f=0,p=0,d=0;for(let g=0;g<c;++g){const b=o[r[g]];if(b===void 0)throw new SyntaxError(`Non-${s} character`);p=p<<t|b,f+=t,f>=8&&(f-=8,h[d++]=255&p>>f)}if(f>=t||255&p<<8-f)throw new SyntaxError("Unexpected end of data");return h},T_=(r,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",h=0,f=0;for(let p=0;p<r.length;++p)for(f=f<<8|r[p],h+=8;h>t;)h-=t,c+=e[o&f>>h];if(h&&(c+=e[o&f<<t-h]),s)for(;c.length*t&7;)c+="=";return c},$t=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>pa({prefix:e,name:r,encode(o){return T_(o,s,t)},decode(o){return N_(o,s,t,r)}}),R_=pa({prefix:"\0",name:"identity",encode:r=>x_(r),decode:r=>O_(r)}),U_=Object.freeze(Object.defineProperty({__proto__:null,identity:R_},Symbol.toStringTag,{value:"Module"})),j_=$t({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),B_=Object.freeze(Object.defineProperty({__proto__:null,base2:j_},Symbol.toStringTag,{value:"Module"})),M_=$t({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),L_=Object.freeze(Object.defineProperty({__proto__:null,base8:M_},Symbol.toStringTag,{value:"Module"})),z_=ws({prefix:"9",name:"base10",alphabet:"0123456789"}),q_=Object.freeze(Object.defineProperty({__proto__:null,base10:z_},Symbol.toStringTag,{value:"Module"})),H_=$t({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),K_=$t({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),V_=Object.freeze(Object.defineProperty({__proto__:null,base16:H_,base16upper:K_},Symbol.toStringTag,{value:"Module"})),k_=$t({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),G_=$t({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),W_=$t({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Y_=$t({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),J_=$t({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Z_=$t({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),X_=$t({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Q_=$t({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eE=$t({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tE=Object.freeze(Object.defineProperty({__proto__:null,base32:k_,base32hex:J_,base32hexpad:X_,base32hexpadupper:Q_,base32hexupper:Z_,base32pad:W_,base32padupper:Y_,base32upper:G_,base32z:eE},Symbol.toStringTag,{value:"Module"})),rE=ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iE=ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),nE=Object.freeze(Object.defineProperty({__proto__:null,base36:rE,base36upper:iE},Symbol.toStringTag,{value:"Module"})),sE=ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),oE=ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),aE=Object.freeze(Object.defineProperty({__proto__:null,base58btc:sE,base58flickr:oE},Symbol.toStringTag,{value:"Module"})),cE=$t({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uE=$t({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hE=$t({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lE=$t({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),fE=Object.freeze(Object.defineProperty({__proto__:null,base64:cE,base64pad:uE,base64url:hE,base64urlpad:lE},Symbol.toStringTag,{value:"Module"})),xd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),pE=xd.reduce((r,e,t)=>(r[t]=e,r),[]),dE=xd.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function gE(r){return r.reduce((e,t)=>(e+=pE[t],e),"")}function yE(r){const e=[];for(const t of r){const s=dE[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const vE=pa({prefix:"🚀",name:"base256emoji",encode:gE,decode:yE}),mE=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:vE},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Rf={...U_,...B_,...L_,...q_,...V_,...tE,...nE,...aE,...fE,...mE};function Cd(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const Uf=Cd("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Xc=Cd("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Ad(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Fd={utf8:Uf,"utf-8":Uf,hex:Rf.base16,latin1:Xc,ascii:Xc,binary:Xc,...Rf};function Pr(r,e="utf8"){const t=Fd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ch(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function mr(r,e="utf8"){const t=Fd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var ce={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pu=function(r,e){return Pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Pu(r,e)};function bE(r,e){Pu(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $u=function(){return $u=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},$u.apply(this,arguments)};function wE(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t}function _E(r,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,s);else for(var f=r.length-1;f>=0;f--)(h=r[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function EE(r,e){return function(t,s){e(t,s,r)}}function DE(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function IE(r,e,t,s){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(g){try{d(s.next(g))}catch(b){h(b)}}function p(g){try{d(s.throw(g))}catch(b){h(b)}}function d(g){g.done?c(g.value):o(g.value).then(f,p)}d((s=s.apply(r,e||[])).next())})}function SE(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(d){return function(g){return p([d,g])}}function p(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(r,t)}catch(g){d=[6,g],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function AE(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}function OE(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Nu(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pd(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return c}function xE(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Pd(arguments[e]));return r}function CE(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)s[o]=c[h];return s}function ls(r){return this instanceof ls?(this.v=r,this):new ls(r)}function FE(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(E){s[E]&&(o[E]=function(I){return new Promise(function(S,R){c.push([E,I,S,R])>1||f(E,I)})})}function f(E,I){try{p(s[E](I))}catch(S){b(c[0][3],S)}}function p(E){E.value instanceof ls?Promise.resolve(E.value.v).then(d,g):b(c[0][2],E)}function d(E){f("next",E)}function g(E){f("throw",E)}function b(E,I){E(I),c.shift(),c.length&&f(c[0][0],c[0][1])}}function PE(r){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=r[o]?function(h){return(t=!t)?{value:ls(r[o](h)),done:o==="return"}:c?c(h):h}:c}}function $E(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Nu=="function"?Nu(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=r[c]&&function(h){return new Promise(function(f,p){h=r[c](h),o(f,p,h.done,h.value)})}}function o(c,h,f,p){Promise.resolve(p).then(function(d){c({value:d,done:f})},h)}}function NE(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function TE(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function RE(r){return r&&r.__esModule?r:{default:r}}function UE(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function jE(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const BE=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return $u},__asyncDelegator:PE,__asyncGenerator:FE,__asyncValues:$E,__await:ls,__awaiter:IE,__classPrivateFieldGet:UE,__classPrivateFieldSet:jE,__createBinding:AE,__decorate:_E,__exportStar:OE,__extends:bE,__generator:SE,__importDefault:RE,__importStar:TE,__makeTemplateObject:NE,__metadata:DE,__param:EE,__read:Pd,__rest:wE,__spread:xE,__spreadArrays:CE,__values:Nu},Symbol.toStringTag,{value:"Module"})),da=eh(BE);var Qc={},es={},jf;function ME(){if(jf)return es;jf=1,Object.defineProperty(es,"__esModule",{value:!0}),es.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return es.delay=r,es}var Li={},eu={},zi={},Bf;function LE(){return Bf||(Bf=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.ONE_THOUSAND=zi.ONE_HUNDRED=void 0,zi.ONE_HUNDRED=100,zi.ONE_THOUSAND=1e3),zi}var tu={},Mf;function zE(){return Mf||(Mf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(tu)),tu}var Lf;function $d(){return Lf||(Lf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=da;e.__exportStar(LE(),r),e.__exportStar(zE(),r)}(eu)),eu}var zf;function qE(){if(zf)return Li;zf=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.fromMiliseconds=Li.toMiliseconds=void 0;const r=$d();function e(s){return s*r.ONE_THOUSAND}Li.toMiliseconds=e;function t(s){return Math.floor(s/r.ONE_THOUSAND)}return Li.fromMiliseconds=t,Li}var qf;function HE(){return qf||(qf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=da;e.__exportStar(ME(),r),e.__exportStar(qE(),r)}(Qc)),Qc}var wn={},Hf;function KE(){if(Hf)return wn;Hf=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return wn.Watch=r,wn.default=r,wn}var ru={},ts={},Kf;function VE(){if(Kf)return ts;Kf=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.IWatch=void 0;class r{}return ts.IWatch=r,ts}var Vf;function kE(){return Vf||(Vf=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),da.__exportStar(VE(),r)}(ru)),ru}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=da;e.__exportStar(HE(),r),e.__exportStar(KE(),r),e.__exportStar(kE(),r),e.__exportStar($d(),r)})(ce);var fs={};(function(r){const e=xw,t=Cw,s=Aw,o=Ow,c=P=>P==null,h=Symbol("encodeFragmentIdentifier");function f(P){switch(P.arrayFormat){case"index":return O=>(D,x)=>{const C=D.length;return x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?D:x===null?[...D,[g(O,P),"[",C,"]"].join("")]:[...D,[g(O,P),"[",g(C,P),"]=",g(x,P)].join("")]};case"bracket":return O=>(D,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?D:x===null?[...D,[g(O,P),"[]"].join("")]:[...D,[g(O,P),"[]=",g(x,P)].join("")];case"colon-list-separator":return O=>(D,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?D:x===null?[...D,[g(O,P),":list="].join("")]:[...D,[g(O,P),":list=",g(x,P)].join("")];case"comma":case"separator":case"bracket-separator":{const O=P.arrayFormat==="bracket-separator"?"[]=":"=";return D=>(x,C)=>C===void 0||P.skipNull&&C===null||P.skipEmptyString&&C===""?x:(C=C===null?"":C,x.length===0?[[g(D,P),O,g(C,P)].join("")]:[[x,g(C,P)].join(P.arrayFormatSeparator)])}default:return O=>(D,x)=>x===void 0||P.skipNull&&x===null||P.skipEmptyString&&x===""?D:x===null?[...D,g(O,P)]:[...D,[g(O,P),"=",g(x,P)].join("")]}}function p(P){let O;switch(P.arrayFormat){case"index":return(D,x,C)=>{if(O=/\[(\d*)\]$/.exec(D),D=D.replace(/\[\d*\]$/,""),!O){C[D]=x;return}C[D]===void 0&&(C[D]={}),C[D][O[1]]=x};case"bracket":return(D,x,C)=>{if(O=/(\[\])$/.exec(D),D=D.replace(/\[\]$/,""),!O){C[D]=x;return}if(C[D]===void 0){C[D]=[x];return}C[D]=[].concat(C[D],x)};case"colon-list-separator":return(D,x,C)=>{if(O=/(:list)$/.exec(D),D=D.replace(/:list$/,""),!O){C[D]=x;return}if(C[D]===void 0){C[D]=[x];return}C[D]=[].concat(C[D],x)};case"comma":case"separator":return(D,x,C)=>{const l=typeof x=="string"&&x.includes(P.arrayFormatSeparator),w=typeof x=="string"&&!l&&b(x,P).includes(P.arrayFormatSeparator);x=w?b(x,P):x;const K=l||w?x.split(P.arrayFormatSeparator).map(Z=>b(Z,P)):x===null?x:b(x,P);C[D]=K};case"bracket-separator":return(D,x,C)=>{const l=/(\[\])$/.test(D);if(D=D.replace(/\[\]$/,""),!l){C[D]=x&&b(x,P);return}const w=x===null?[]:x.split(P.arrayFormatSeparator).map(K=>b(K,P));if(C[D]===void 0){C[D]=w;return}C[D]=[].concat(C[D],w)};default:return(D,x,C)=>{if(C[D]===void 0){C[D]=x;return}C[D]=[].concat(C[D],x)}}}function d(P){if(typeof P!="string"||P.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function g(P,O){return O.encode?O.strict?e(P):encodeURIComponent(P):P}function b(P,O){return O.decode?t(P):P}function E(P){return Array.isArray(P)?P.sort():typeof P=="object"?E(Object.keys(P)).sort((O,D)=>Number(O)-Number(D)).map(O=>P[O]):P}function I(P){const O=P.indexOf("#");return O!==-1&&(P=P.slice(0,O)),P}function S(P){let O="";const D=P.indexOf("#");return D!==-1&&(O=P.slice(D)),O}function R(P){P=I(P);const O=P.indexOf("?");return O===-1?"":P.slice(O+1)}function B(P,O){return O.parseNumbers&&!Number.isNaN(Number(P))&&typeof P=="string"&&P.trim()!==""?P=Number(P):O.parseBooleans&&P!==null&&(P.toLowerCase()==="true"||P.toLowerCase()==="false")&&(P=P.toLowerCase()==="true"),P}function H(P,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),d(O.arrayFormatSeparator);const D=p(O),x=Object.create(null);if(typeof P!="string"||(P=P.trim().replace(/^[?#&]/,""),!P))return x;for(const C of P.split("&")){if(C==="")continue;let[l,w]=s(O.decode?C.replace(/\+/g," "):C,"=");w=w===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?w:b(w,O),D(b(l,O),w,x)}for(const C of Object.keys(x)){const l=x[C];if(typeof l=="object"&&l!==null)for(const w of Object.keys(l))l[w]=B(l[w],O);else x[C]=B(l,O)}return O.sort===!1?x:(O.sort===!0?Object.keys(x).sort():Object.keys(x).sort(O.sort)).reduce((C,l)=>{const w=x[l];return w&&typeof w=="object"&&!Array.isArray(w)?C[l]=E(w):C[l]=w,C},Object.create(null))}r.extract=R,r.parse=H,r.stringify=(P,O)=>{if(!P)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),d(O.arrayFormatSeparator);const D=w=>O.skipNull&&c(P[w])||O.skipEmptyString&&P[w]==="",x=f(O),C={};for(const w of Object.keys(P))D(w)||(C[w]=P[w]);const l=Object.keys(C);return O.sort!==!1&&l.sort(O.sort),l.map(w=>{const K=P[w];return K===void 0?"":K===null?g(w,O):Array.isArray(K)?K.length===0&&O.arrayFormat==="bracket-separator"?g(w,O)+"[]":K.reduce(x(w),[]).join("&"):g(w,O)+"="+g(K,O)}).filter(w=>w.length>0).join("&")},r.parseUrl=(P,O)=>{O=Object.assign({decode:!0},O);const[D,x]=s(P,"#");return Object.assign({url:D.split("?")[0]||"",query:H(R(P),O)},O&&O.parseFragmentIdentifier&&x?{fragmentIdentifier:b(x,O)}:{})},r.stringifyUrl=(P,O)=>{O=Object.assign({encode:!0,strict:!0,[h]:!0},O);const D=I(P.url).split("?")[0]||"",x=r.extract(P.url),C=r.parse(x,{sort:!1}),l=Object.assign(C,P.query);let w=r.stringify(l,O);w&&(w=`?${w}`);let K=S(P.url);return P.fragmentIdentifier&&(K=`#${O[h]?g(P.fragmentIdentifier,O):P.fragmentIdentifier}`),`${D}${w}${K}`},r.pick=(P,O,D)=>{D=Object.assign({parseFragmentIdentifier:!0,[h]:!1},D);const{url:x,query:C,fragmentIdentifier:l}=r.parseUrl(P,D);return r.stringifyUrl({url:x,query:o(C,O),fragmentIdentifier:l},D)},r.exclude=(P,O,D)=>{const x=Array.isArray(O)?C=>!O.includes(C):(C,l)=>!O(C,l);return r.pick(P,x,D)}})(fs);const GE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};function WE(r,e=[]){const t=[];return Object.keys(r).forEach(s=>{if(e.length&&!e.includes(s))return;const o=r[s];t.push(...o.accounts)}),t}function Nd(r,e){return r.includes(":")?[r]:e.chains||[]}const Td="base10",Kt="base16",Tu="base64pad",uh="utf8",Rd=0,ki=1,YE=0,kf=1,Ru=12,hh=32;function JE(){const r=ah.generateKeyPair();return{privateKey:mr(r.secretKey,Kt),publicKey:mr(r.publicKey,Kt)}}function Uu(){const r=ca.randomBytes(hh);return mr(r,Kt)}function ZE(r,e){const t=ah.sharedKey(Pr(r,Kt),Pr(e,Kt)),s=new g_(fa.SHA256,t).expand(hh);return mr(s,Kt)}function XE(r){const e=fa.hash(Pr(r,Kt));return mr(e,Kt)}function Sn(r){const e=fa.hash(Pr(r,uh));return mr(e,Kt)}function QE(r){return Pr(`${r}`,Td)}function _s(r){return Number(mr(r,Td))}function e3(r){const e=QE(typeof r.type<"u"?r.type:Rd);if(_s(e)===ki&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?Pr(r.senderPublicKey,Kt):void 0,s=typeof r.iv<"u"?Pr(r.iv,Kt):ca.randomBytes(Ru),o=new sh.ChaCha20Poly1305(Pr(r.symKey,Kt)).seal(s,Pr(r.message,uh));return r3({type:e,sealed:o,iv:s,senderPublicKey:t})}function t3(r){const e=new sh.ChaCha20Poly1305(Pr(r.symKey,Kt)),{sealed:t,iv:s}=Qo(r.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return mr(o,uh)}function r3(r){if(_s(r.type)===ki){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return mr(Tf([r.type,r.senderPublicKey,r.iv,r.sealed]),Tu)}return mr(Tf([r.type,r.iv,r.sealed]),Tu)}function Qo(r){const e=Pr(r,Tu),t=e.slice(YE,kf),s=kf;if(_s(t)===ki){const f=s+hh,p=f+Ru,d=e.slice(s,f),g=e.slice(f,p),b=e.slice(p);return{type:t,sealed:b,iv:g,senderPublicKey:d}}const o=s+Ru,c=e.slice(s,o),h=e.slice(o);return{type:t,sealed:h,iv:c}}function i3(r,e){const t=Qo(r);return Ud({type:_s(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?mr(t.senderPublicKey,Kt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Ud(r){const e=(r==null?void 0:r.type)||Rd;if(e===ki){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Gf(r){return r.type===ki&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}var n3=Object.defineProperty,Wf=Object.getOwnPropertySymbols,s3=Object.prototype.hasOwnProperty,o3=Object.prototype.propertyIsEnumerable,Yf=(r,e,t)=>e in r?n3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Jf=(r,e)=>{for(var t in e||(e={}))s3.call(e,t)&&Yf(r,t,e[t]);if(Wf)for(var t of Wf(e))o3.call(e,t)&&Yf(r,t,e[t]);return r};const a3="ReactNative",_i={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},c3="js";function lh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function jd(){return!Pw()&&!!pd()&&navigator.product===a3}function fh(){return!lh()&&!!pd()}function ph(){return jd()?_i.reactNative:lh()?_i.node:fh()?_i.browser:_i.unknown}function u3(r,e){let t=fs.parse(r);return t=Jf(Jf({},t),e),r=fs.stringify(t),r}function h3(){return Fw()||{name:"",description:"",url:"",icons:[""]}}function l3(){if(ph()===_i.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const r=Iw();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function f3(){var r;const e=ph();return e===_i.browser?[e,((r=$w())==null?void 0:r.host)||"unknown"].join(":"):e}function p3(r,e,t){const s=l3(),o=f3();return[[r,e].join("-"),[c3,t].join("-"),s,o].join("/")}function d3({protocol:r,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:h}){const f=t.split("?"),p=p3(r,e,s),d={auth:o,ua:p,projectId:c,useOnCloseEvent:h||void 0},g=u3(f[1]||"",d);return f[0]+"?"+g}function Ki(r,e){return r.filter(t=>e.includes(t)).length===r.length}function Bd(r){return Object.fromEntries(r.entries())}function Md(r){return new Map(Object.entries(r))}function In(r=ce.FIVE_MINUTES,e){const t=ce.toMiliseconds(r||ce.FIVE_MINUTES);let s,o,c;return{resolve:h=>{c&&s&&(clearTimeout(c),s(h))},reject:h=>{c&&o&&(clearTimeout(c),o(h))},done:()=>new Promise((h,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=h,o=f})}}function ea(r,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const h=await r;s(h)}catch(h){o(h)}clearTimeout(c)})}function Ld(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function g3(r){return Ld("topic",r)}function y3(r){return Ld("id",r)}function zd(r){const[e,t]=r.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Fr(r,e){return ce.fromMiliseconds((e||Date.now())+ce.toMiliseconds(r))}function wi(r){return Date.now()>=ce.toMiliseconds(r)}function _t(r,e){return`${r}${e?`:${e}`:""}`}function iu(r=[],e=[]){return[...new Set([...r,...e])]}async function v3({id:r,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${r}&sessionTopic=${e}`,h=ph();h===_i.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):h===_i.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}const m3="irn";function ju(r){return(r==null?void 0:r.relay)||{protocol:m3}}function Vo(r){const e=GE[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var b3=Object.defineProperty,Zf=Object.getOwnPropertySymbols,w3=Object.prototype.hasOwnProperty,_3=Object.prototype.propertyIsEnumerable,Xf=(r,e,t)=>e in r?b3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,E3=(r,e)=>{for(var t in e||(e={}))w3.call(e,t)&&Xf(r,t,e[t]);if(Zf)for(var t of Zf(e))_3.call(e,t)&&Xf(r,t,e[t]);return r};function D3(r,e="-"){const t={},s="relay"+e;return Object.keys(r).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),h=r[o];t[c]=h}}),t}function I3(r){const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,s=r.substring(0,e),o=r.substring(e+1,t).split("@"),c=typeof t<"u"?r.substring(t):"",h=fs.parse(c);return{protocol:s,topic:S3(o[0]),version:parseInt(o[1],10),symKey:h.symKey,relay:D3(h)}}function S3(r){return r.startsWith("//")?r.substring(2):r}function A3(r,e="-"){const t="relay",s={};return Object.keys(r).forEach(o=>{const c=t+e+o;r[o]&&(s[c]=r[o])}),s}function O3(r){return`${r.protocol}:${r.topic}@${r.version}?`+fs.stringify(E3({symKey:r.symKey},A3(r.relay)))}function On(r){const e=[];return r.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function x3(r){const e=[];return Object.values(r).forEach(t=>{e.push(...On(t.accounts))}),e}function C3(r,e){const t=[];return Object.values(r).forEach(s=>{On(s.accounts).includes(e)&&t.push(...s.methods)}),t}function F3(r,e){const t=[];return Object.values(r).forEach(s=>{On(s.accounts).includes(e)&&t.push(...s.events)}),t}function P3(r,e){const t=Go(r,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(r))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(h=>`${h.split(":")[0]}:${h.split(":")[1]}`)};return s}function dh(r){return r.includes(":")}function ko(r){return dh(r)?r.split(":")[0]:r}const $3={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},N3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Q(r,e){const{message:t,code:s}=N3[r];return{message:e?`${t} ${e}`:t,code:s}}function yt(r,e){const{message:t,code:s}=$3[r];return{message:e?`${t} ${e}`:t,code:s}}function Kr(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function An(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function Ht(r){return typeof r>"u"}function Ct(r,e){return e&&Ht(r)?!0:typeof r=="string"&&!!r.trim().length}function gh(r,e){return e&&Ht(r)?!0:typeof r=="number"&&!isNaN(r)}function T3(r,e){const{requiredNamespaces:t}=e,s=Object.keys(r.namespaces),o=Object.keys(t);let c=!0;return Ki(o,s)?(s.forEach(h=>{const{accounts:f,methods:p,events:d}=r.namespaces[h],g=On(f),b=t[h];(!Ki(Nd(h,b),g)||!Ki(b.methods,p)||!Ki(b.events,d))&&(c=!1)}),c):!1}function ta(r){return Ct(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function R3(r){if(Ct(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&ta(t)}}return!1}function U3(r){if(Ct(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function j3(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function B3(r){return r==null?void 0:r.topic}function M3(r,e){let t=null;return Ct(r==null?void 0:r.publicKey,!1)||(t=Q("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Qf(r){let e=!0;return Kr(r)?r.length&&(e=r.every(t=>Ct(t,!1))):e=!1,e}function L3(r,e,t){let s=null;return Kr(e)&&e.length?e.forEach(o=>{s||ta(o)||(s=yt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):ta(r)||(s=yt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function z3(r,e,t){let s=null;return Object.entries(r).forEach(([o,c])=>{if(s)return;const h=L3(o,Nd(o,c),`${e} ${t}`);h&&(s=h)}),s}function q3(r,e){let t=null;return Kr(r)?r.forEach(s=>{t||R3(s)||(t=yt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=yt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function H3(r,e){let t=null;return Object.values(r).forEach(s=>{if(t)return;const o=q3(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function K3(r,e){let t=null;return Qf(r==null?void 0:r.methods)?Qf(r==null?void 0:r.events)||(t=yt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=yt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function qd(r,e){let t=null;return Object.values(r).forEach(s=>{if(t)return;const o=K3(s,`${e}, namespace`);o&&(t=o)}),t}function V3(r,e,t){let s=null;if(r&&An(r)){const o=qd(r,e);o&&(s=o);const c=z3(r,e,t);c&&(s=c)}else s=Q("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Go(r,e){let t=null;if(r&&An(r)){const s=qd(r,e);s&&(t=s);const o=H3(r,e);o&&(t=o)}else t=Q("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Hd(r){return Ct(r.protocol,!0)}function k3(r,e){let t=!1;return e&&!r?t=!0:r&&Kr(r)&&r.length&&r.forEach(s=>{t=Hd(s)}),t}function G3(r){return typeof r=="number"}function Xt(r){return typeof r<"u"&&typeof r!==null}function W3(r){return!(!r||typeof r!="object"||!r.code||!gh(r.code,!1)||!r.message||!Ct(r.message,!1))}function Y3(r){return!(Ht(r)||!Ct(r.method,!1))}function J3(r){return!(Ht(r)||Ht(r.result)&&Ht(r.error)||!gh(r.id,!1)||!Ct(r.jsonrpc,!1))}function Z3(r){return!(Ht(r)||!Ct(r.name,!1))}function ep(r,e){return!(!ta(e)||!x3(r).includes(e))}function X3(r,e,t){return Ct(t,!1)?C3(r,e).includes(t):!1}function Q3(r,e,t){return Ct(t,!1)?F3(r,e).includes(t):!1}function tp(r,e,t){let s=null;const o=e2(r),c=t2(e),h=Object.keys(o),f=Object.keys(c),p=rp(Object.keys(r)),d=rp(Object.keys(e)),g=p.filter(b=>!d.includes(b));return g.length&&(s=Q("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${g.toString()}
      Received: ${Object.keys(e).toString()}`)),Ki(h,f)||(s=Q("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(b=>{if(!b.includes(":")||s)return;const E=On(e[b].accounts);E.includes(b)||(s=Q("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${b}
        Required: ${b}
        Approved: ${E.toString()}`))}),h.forEach(b=>{s||(Ki(o[b].methods,c[b].methods)?Ki(o[b].events,c[b].events)||(s=Q("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${b}`)):s=Q("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${b}`))}),s}function e2(r){const e={};return Object.keys(r).forEach(t=>{var s;t.includes(":")?e[t]=r[t]:(s=r[t].chains)==null||s.forEach(o=>{e[o]={methods:r[t].methods,events:r[t].events}})}),e}function rp(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function t2(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const s=On(r[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:r[t].accounts.filter(c=>c.includes(`${o}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function r2(r,e){return gh(r,!1)&&r<=e.max&&r>=e.min}const i2=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,n2=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,s2=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function o2(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){a2(r);return}return e}function a2(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Uo(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!s2.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(i2.test(r)||n2.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,o2)}return JSON.parse(r)}catch(s){if(e.strict)throw s;return r}}function c2(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function xt(r,...e){try{return c2(r(...e))}catch(t){return Promise.reject(t)}}function u2(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function h2(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Wo(r){if(u2(r))return String(r);if(h2(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Wo(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Bu="base64:";function l2(r){return typeof r=="string"?r:Bu+d2(r)}function f2(r){return typeof r!="string"||!r.startsWith(Bu)?r:p2(r.slice(Bu.length))}function p2(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function d2(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Zt(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function g2(...r){return Zt(r.join(":"))}function jo(r){return r=Zt(r),r?r+":":""}function y2(r,e){if(e===void 0)return!0;let t=0,s=r.indexOf(":");for(;s>-1;)t++,s=r.indexOf(":",s+1);return t<=e}function v2(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const m2="memory",b2=()=>{const r=new Map;return{name:m2,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function w2(r={}){const e={mounts:{"":r.driver||b2()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=d=>{for(const g of e.mountpoints)if(d.startsWith(g))return{base:g,relativeKey:d.slice(g.length),driver:e.mounts[g]};return{base:"",relativeKey:d,driver:e.mounts[""]}},s=(d,g)=>e.mountpoints.filter(b=>b.startsWith(d)||g&&d.startsWith(b)).map(b=>({relativeBase:d.length>b.length?d.slice(b.length):void 0,mountpoint:b,driver:e.mounts[b]})),o=(d,g)=>{if(e.watching){g=Zt(g);for(const b of e.watchListeners)b(d,g)}},c=async()=>{if(!e.watching){e.watching=!0;for(const d in e.mounts)e.unwatch[d]=await ip(e.mounts[d],o,d)}},h=async()=>{if(e.watching){for(const d in e.unwatch)await e.unwatch[d]();e.unwatch={},e.watching=!1}},f=(d,g,b)=>{const E=new Map,I=S=>{let R=E.get(S.base);return R||(R={driver:S.driver,base:S.base,items:[]},E.set(S.base,R)),R};for(const S of d){const R=typeof S=="string",B=Zt(R?S:S.key),H=R?void 0:S.value,P=R||!S.options?g:{...g,...S.options},O=t(B);I(O).items.push({key:B,value:H,relativeKey:O.relativeKey,options:P})}return Promise.all([...E.values()].map(S=>b(S))).then(S=>S.flat())},p={hasItem(d,g={}){d=Zt(d);const{relativeKey:b,driver:E}=t(d);return xt(E.hasItem,b,g)},getItem(d,g={}){d=Zt(d);const{relativeKey:b,driver:E}=t(d);return xt(E.getItem,b,g).then(I=>Uo(I))},getItems(d,g={}){return f(d,g,b=>b.driver.getItems?xt(b.driver.getItems,b.items.map(E=>({key:E.relativeKey,options:E.options})),g).then(E=>E.map(I=>({key:g2(b.base,I.key),value:Uo(I.value)}))):Promise.all(b.items.map(E=>xt(b.driver.getItem,E.relativeKey,E.options).then(I=>({key:E.key,value:Uo(I)})))))},getItemRaw(d,g={}){d=Zt(d);const{relativeKey:b,driver:E}=t(d);return E.getItemRaw?xt(E.getItemRaw,b,g):xt(E.getItem,b,g).then(I=>f2(I))},async setItem(d,g,b={}){if(g===void 0)return p.removeItem(d);d=Zt(d);const{relativeKey:E,driver:I}=t(d);I.setItem&&(await xt(I.setItem,E,Wo(g),b),I.watch||o("update",d))},async setItems(d,g){await f(d,g,async b=>{if(b.driver.setItems)return xt(b.driver.setItems,b.items.map(E=>({key:E.relativeKey,value:Wo(E.value),options:E.options})),g);b.driver.setItem&&await Promise.all(b.items.map(E=>xt(b.driver.setItem,E.relativeKey,Wo(E.value),E.options)))})},async setItemRaw(d,g,b={}){if(g===void 0)return p.removeItem(d,b);d=Zt(d);const{relativeKey:E,driver:I}=t(d);if(I.setItemRaw)await xt(I.setItemRaw,E,g,b);else if(I.setItem)await xt(I.setItem,E,l2(g),b);else return;I.watch||o("update",d)},async removeItem(d,g={}){typeof g=="boolean"&&(g={removeMeta:g}),d=Zt(d);const{relativeKey:b,driver:E}=t(d);E.removeItem&&(await xt(E.removeItem,b,g),(g.removeMeta||g.removeMata)&&await xt(E.removeItem,b+"$",g),E.watch||o("remove",d))},async getMeta(d,g={}){typeof g=="boolean"&&(g={nativeOnly:g}),d=Zt(d);const{relativeKey:b,driver:E}=t(d),I=Object.create(null);if(E.getMeta&&Object.assign(I,await xt(E.getMeta,b,g)),!g.nativeOnly){const S=await xt(E.getItem,b+"$",g).then(R=>Uo(R));S&&typeof S=="object"&&(typeof S.atime=="string"&&(S.atime=new Date(S.atime)),typeof S.mtime=="string"&&(S.mtime=new Date(S.mtime)),Object.assign(I,S))}return I},setMeta(d,g,b={}){return this.setItem(d+"$",g,b)},removeMeta(d,g={}){return this.removeItem(d+"$",g)},async getKeys(d,g={}){var B;d=jo(d);const b=s(d,!0);let E=[];const I=[];let S=!0;for(const H of b){(B=H.driver.flags)!=null&&B.maxDepth||(S=!1);const P=await xt(H.driver.getKeys,H.relativeBase,g);for(const O of P){const D=H.mountpoint+Zt(O);E.some(x=>D.startsWith(x))||I.push(D)}E=[H.mountpoint,...E.filter(O=>!O.startsWith(H.mountpoint))]}const R=g.maxDepth!==void 0&&!S;return I.filter(H=>(!R||y2(H,g.maxDepth))&&v2(H,d))},async clear(d,g={}){d=jo(d),await Promise.all(s(d,!1).map(async b=>{if(b.driver.clear)return xt(b.driver.clear,b.relativeBase,g);if(b.driver.removeItem){const E=await b.driver.getKeys(b.relativeBase||"",g);return Promise.all(E.map(I=>b.driver.removeItem(I,g)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(d=>np(d)))},async watch(d){return await c(),e.watchListeners.push(d),async()=>{e.watchListeners=e.watchListeners.filter(g=>g!==d),e.watchListeners.length===0&&await h()}},async unwatch(){e.watchListeners=[],await h()},mount(d,g){if(d=jo(d),d&&e.mounts[d])throw new Error(`already mounted at ${d}`);return d&&(e.mountpoints.push(d),e.mountpoints.sort((b,E)=>E.length-b.length)),e.mounts[d]=g,e.watching&&Promise.resolve(ip(g,o,d)).then(b=>{e.unwatch[d]=b}).catch(console.error),p},async unmount(d,g=!0){var b,E;d=jo(d),!(!d||!e.mounts[d])&&(e.watching&&d in e.unwatch&&((E=(b=e.unwatch)[d])==null||E.call(b),delete e.unwatch[d]),g&&await np(e.mounts[d]),e.mountpoints=e.mountpoints.filter(I=>I!==d),delete e.mounts[d])},getMount(d=""){d=Zt(d)+":";const g=t(d);return{driver:g.driver,base:g.base}},getMounts(d="",g={}){return d=Zt(d),s(d,g.parents).map(E=>({driver:E.driver,base:E.mountpoint}))},keys:(d,g={})=>p.getKeys(d,g),get:(d,g={})=>p.getItem(d,g),set:(d,g,b={})=>p.setItem(d,g,b),has:(d,g={})=>p.hasItem(d,g),del:(d,g={})=>p.removeItem(d,g),remove:(d,g={})=>p.removeItem(d,g)};return p}function ip(r,e,t){return r.watch?r.watch((s,o)=>e(s,t+o)):()=>{}}async function np(r){typeof r.dispose=="function"&&await xt(r.dispose)}function Gi(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function Kd(r,e){let t;const s=()=>{if(t)return t;const o=indexedDB.open(r);return o.onupgradeneeded=()=>o.result.createObjectStore(e),t=Gi(o),t.then(c=>{c.onclose=()=>t=void 0},()=>{}),t};return(o,c)=>s().then(h=>c(h.transaction(e,o).objectStore(e)))}let nu;function Es(){return nu||(nu=Kd("keyval-store","keyval")),nu}function sp(r,e=Es()){return e("readonly",t=>Gi(t.get(r)))}function _2(r,e,t=Es()){return t("readwrite",s=>(s.put(e,r),Gi(s.transaction)))}function E2(r,e=Es()){return e("readwrite",t=>(t.delete(r),Gi(t.transaction)))}function D2(r=Es()){return r("readwrite",e=>(e.clear(),Gi(e.transaction)))}function I2(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Gi(r.transaction)}function S2(r=Es()){return r("readonly",e=>{if(e.getAllKeys)return Gi(e.getAllKeys());const t=[];return I2(e,s=>t.push(s.key)).then(()=>t)})}const A2="idb-keyval";var O2=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=o=>e+o;let s;return r.dbName&&r.storeName&&(s=Kd(r.dbName,r.storeName)),{name:A2,options:r,async hasItem(o){return!(typeof await sp(t(o),s)>"u")},async getItem(o){return await sp(t(o),s)??null},setItem(o,c){return _2(t(o),c,s)},removeItem(o){return E2(t(o),s)},getKeys(){return S2(s)},clear(){return D2(s)}}};const x2="WALLET_CONNECT_V2_INDEXED_DB",C2="keyvaluestorage";let F2=class{constructor(){this.indexedDb=w2({driver:O2({dbName:x2,storeName:C2})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,ys(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yo={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,s){this[t]=String(s)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof su<"u"&&su.localStorage?Yo.exports=su.localStorage:typeof window<"u"&&window.localStorage?Yo.exports=window.localStorage:Yo.exports=new e})();function P2(r){var e;return[r[0],sa((e=r[1])!=null?e:"")]}let $2=class{constructor(){this.localStorage=Yo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(P2)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return sa(t)}async setItem(e,t){this.localStorage.setItem(e,ys(t))}async removeItem(e){this.localStorage.removeItem(e)}};const N2="wc_storage_version",op=1,T2=async(r,e,t)=>{const s=N2,o=await e.getItem(s);if(o&&o>=op){t(e);return}const c=await r.getKeys();if(!c.length){t(e);return}const h=[];for(;c.length;){const f=c.shift();if(!f)continue;const p=f.toLowerCase();if(p.includes("wc@")||p.includes("walletconnect")||p.includes("wc_")||p.includes("wallet_connect")){const d=await r.getItem(f);await e.setItem(f,d),h.push(f)}}await e.setItem(s,op),t(e),R2(r,h)},R2=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let U2=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new $2;this.storage=e;try{const t=new F2;T2(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var xn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Mu=function(r,e){return Mu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Mu(r,e)};function j2(r,e){Mu(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Lu=function(){return Lu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Lu.apply(this,arguments)};function B2(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t}function M2(r,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,s);else for(var f=r.length-1;f>=0;f--)(h=r[f])&&(c=(o<3?h(c):o>3?h(e,t,c):h(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function L2(r,e){return function(t,s){e(t,s,r)}}function z2(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function q2(r,e,t,s){function o(c){return c instanceof t?c:new t(function(h){h(c)})}return new(t||(t=Promise))(function(c,h){function f(g){try{d(s.next(g))}catch(b){h(b)}}function p(g){try{d(s.throw(g))}catch(b){h(b)}}function d(g){g.done?c(g.value):o(g.value).then(f,p)}d((s=s.apply(r,e||[])).next())})}function H2(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,h;return h={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function f(d){return function(g){return p([d,g])}}function p(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(r,t)}catch(g){d=[6,g],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function K2(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}function V2(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function zu(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vd(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),o,c=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){h={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return c}function k2(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Vd(arguments[e]));return r}function G2(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],h=0,f=c.length;h<f;h++,o++)s[o]=c[h];return s}function ps(r){return this instanceof ps?(this.v=r,this):new ps(r)}function W2(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),o,c=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(E){s[E]&&(o[E]=function(I){return new Promise(function(S,R){c.push([E,I,S,R])>1||f(E,I)})})}function f(E,I){try{p(s[E](I))}catch(S){b(c[0][3],S)}}function p(E){E.value instanceof ps?Promise.resolve(E.value.v).then(d,g):b(c[0][2],E)}function d(E){f("next",E)}function g(E){f("throw",E)}function b(E,I){E(I),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Y2(r){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=r[o]?function(h){return(t=!t)?{value:ps(r[o](h)),done:o==="return"}:c?c(h):h}:c}}function J2(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof zu=="function"?zu(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=r[c]&&function(h){return new Promise(function(f,p){h=r[c](h),o(f,p,h.done,h.value)})}}function o(c,h,f,p){Promise.resolve(p).then(function(d){c({value:d,done:f})},h)}}function Z2(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function X2(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Q2(r){return r&&r.__esModule?r:{default:r}}function eD(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function tD(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const rD=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Lu},__asyncDelegator:Y2,__asyncGenerator:W2,__asyncValues:J2,__await:ps,__awaiter:q2,__classPrivateFieldGet:eD,__classPrivateFieldSet:tD,__createBinding:K2,__decorate:M2,__exportStar:V2,__extends:j2,__generator:H2,__importDefault:Q2,__importStar:X2,__makeTemplateObject:Z2,__metadata:z2,__param:L2,__read:Vd,__rest:B2,__spread:k2,__spreadArrays:G2,__values:zu},Symbol.toStringTag,{value:"Module"})),ga=eh(rD);var rs={},ou={},is={};class Wi{}const iD=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Wi},Symbol.toStringTag,{value:"Module"})),nD=eh(iD);var ap;function sD(){if(ap)return is;ap=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IHeartBeat=void 0;const r=nD;class e extends r.IEvents{constructor(s){super()}}return is.IHeartBeat=e,is}var cp;function kd(){return cp||(cp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),ga.__exportStar(sD(),r)}(ou)),ou}var au={},qi={},up;function oD(){if(up)return qi;up=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.HEARTBEAT_EVENTS=qi.HEARTBEAT_INTERVAL=void 0;const r=ce;return qi.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,qi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},qi}var hp;function Gd(){return hp||(hp=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),ga.__exportStar(oD(),r)}(au)),au}var lp;function aD(){if(lp)return rs;lp=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.HeartBeat=void 0;const r=ga,e=wr,t=ce,s=kd(),o=Gd();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return r.__awaiter(this,void 0,void 0,function*(){const p=new c(f);return yield p.init(),p})}init(){return r.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,p){this.events.on(f,p)}once(f,p){this.events.once(f,p)}off(f,p){this.events.off(f,p)}removeListener(f,p){this.events.removeListener(f,p)}initialize(){return r.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return rs.HeartBeat=c,rs}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ga;e.__exportStar(aD(),r),e.__exportStar(kd(),r),e.__exportStar(Gd(),r)})(xn);function cD(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var uD=hD;function hD(r,e,t){var s=t&&t.stringify||cD,o=1;if(typeof r=="object"&&r!==null){var c=e.length+o;if(c===1)return r;var h=new Array(c);h[0]=s(r);for(var f=1;f<c;f++)h[f]=s(e[f]);return h.join(" ")}if(typeof r!="string")return r;var p=e.length;if(p===0)return r;for(var d="",g=1-o,b=-1,E=r&&r.length||0,I=0;I<E;){if(r.charCodeAt(I)===37&&I+1<E){switch(b=b>-1?b:0,r.charCodeAt(I+1)){case 100:case 102:if(g>=p||e[g]==null)break;b<I&&(d+=r.slice(b,I)),d+=Number(e[g]),b=I+2,I++;break;case 105:if(g>=p||e[g]==null)break;b<I&&(d+=r.slice(b,I)),d+=Math.floor(Number(e[g])),b=I+2,I++;break;case 79:case 111:case 106:if(g>=p||e[g]===void 0)break;b<I&&(d+=r.slice(b,I));var S=typeof e[g];if(S==="string"){d+="'"+e[g]+"'",b=I+2,I++;break}if(S==="function"){d+=e[g].name||"<anonymous>",b=I+2,I++;break}d+=s(e[g]),b=I+2,I++;break;case 115:if(g>=p)break;b<I&&(d+=r.slice(b,I)),d+=String(e[g]),b=I+2,I++;break;case 37:b<I&&(d+=r.slice(b,I)),d+="%",b=I+2,I++,g--;break}++g}++I}return b===-1?r:(b<E&&(d+=r.slice(b)),d)}const fp=uD;var lD=Hr;const ds=_D().console||{},fD={mapHttpRequest:Bo,mapHttpResponse:Bo,wrapRequestSerializer:cu,wrapResponseSerializer:cu,wrapErrorSerializer:cu,req:Bo,res:Bo,err:vD};function pD(r,e){return Array.isArray(r)?r.filter(function(s){return s!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function Hr(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||ds;r.browser.write&&(r.browser.asObject=!0);const s=r.serializers||{},o=pD(r.browser.serialize,s);let c=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const h=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const f=r.level||"info",p=Object.create(t);p.log||(p.log=gs),Object.defineProperty(p,"levelVal",{get:g}),Object.defineProperty(p,"level",{get:b,set:E});const d={transmit:e,serialize:o,asObject:r.browser.asObject,levels:h,timestamp:mD(r)};p.levels=Hr.levels,p.level=f,p.setMaxListeners=p.getMaxListeners=p.emit=p.addListener=p.on=p.prependListener=p.once=p.prependOnceListener=p.removeListener=p.removeAllListeners=p.listeners=p.listenerCount=p.eventNames=p.write=p.flush=gs,p.serializers=s,p._serialize=o,p._stdErrSerialize=c,p.child=I,e&&(p._logEvent=qu());function g(){return this.level==="silent"?1/0:this.levels.values[this.level]}function b(){return this._level}function E(S){if(S!=="silent"&&!this.levels.values[S])throw Error("unknown level "+S);this._level=S,_n(d,p,"error","log"),_n(d,p,"fatal","error"),_n(d,p,"warn","error"),_n(d,p,"info","log"),_n(d,p,"debug","log"),_n(d,p,"trace","log")}function I(S,R){if(!S)throw new Error("missing bindings for child Pino");R=R||{},o&&S.serializers&&(R.serializers=S.serializers);const B=R.serializers;if(o&&B){var H=Object.assign({},s,B),P=r.browser.serialize===!0?Object.keys(H):o;delete S.serializers,ya([S],P,H,this._stdErrSerialize)}function O(D){this._childLevel=(D._childLevel|0)+1,this.error=En(D,S,"error"),this.fatal=En(D,S,"fatal"),this.warn=En(D,S,"warn"),this.info=En(D,S,"info"),this.debug=En(D,S,"debug"),this.trace=En(D,S,"trace"),H&&(this.serializers=H,this._serialize=P),e&&(this._logEvent=qu([].concat(D._logEvent.bindings,S)))}return O.prototype=this,new O(this)}return p}Hr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Hr.stdSerializers=fD;Hr.stdTimeFunctions=Object.assign({},{nullTime:Wd,epochTime:Yd,unixTime:bD,isoTime:wD});function _n(r,e,t,s){const o=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?gs:o[t]?o[t]:ds[t]||ds[s]||gs,dD(r,e,t)}function dD(r,e,t){!r.transmit&&e[t]===gs||(e[t]=function(s){return function(){const c=r.timestamp(),h=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ds?ds:this;for(var p=0;p<h.length;p++)h[p]=arguments[p];if(r.serialize&&!r.asObject&&ya(h,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?s.call(f,gD(this,t,h,c)):s.apply(f,h),r.transmit){const d=r.transmit.level||e.level,g=Hr.levels.values[d],b=Hr.levels.values[t];if(b<g)return;yD(this,{ts:c,methodLevel:t,methodValue:b,transmitLevel:d,transmitValue:Hr.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},h)}}}(e[t]))}function gD(r,e,t,s){r._serialize&&ya(t,r._serialize,r.serializers,r._stdErrSerialize);const o=t.slice();let c=o[0];const h={};s&&(h.time=s),h.level=Hr.levels.values[e];let f=(r._childLevel|0)+1;if(f<1&&(f=1),c!==null&&typeof c=="object"){for(;f--&&typeof o[0]=="object";)Object.assign(h,o.shift());c=o.length?fp(o.shift(),o):void 0}else typeof c=="string"&&(c=fp(o.shift(),o));return c!==void 0&&(h.msg=c),h}function ya(r,e,t,s){for(const o in r)if(s&&r[o]instanceof Error)r[o]=Hr.stdSerializers.err(r[o]);else if(typeof r[o]=="object"&&!Array.isArray(r[o]))for(const c in r[o])e&&e.indexOf(c)>-1&&c in t&&(r[o][c]=t[c](r[o][c]))}function En(r,e,t){return function(){const s=new Array(1+arguments.length);s[0]=e;for(var o=1;o<s.length;o++)s[o]=arguments[o-1];return r[t].apply(this,s)}}function yD(r,e,t){const s=e.send,o=e.ts,c=e.methodLevel,h=e.methodValue,f=e.val,p=r._logEvent.bindings;ya(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=o,r._logEvent.messages=t.filter(function(d){return p.indexOf(d)===-1}),r._logEvent.level.label=c,r._logEvent.level.value=h,s(c,r._logEvent,f),r._logEvent=qu(p)}function qu(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function vD(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function mD(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?Wd:Yd}function Bo(){return{}}function cu(r){return r}function gs(){}function Wd(){return!1}function Yd(){return Date.now()}function bD(){return Math.round(Date.now()/1e3)}function wD(){return new Date(Date.now()).toISOString()}function _D(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const va=fd(lD),ED={level:"info"},Ds="custom_context";var DD=Object.defineProperty,ID=Object.defineProperties,SD=Object.getOwnPropertyDescriptors,pp=Object.getOwnPropertySymbols,AD=Object.prototype.hasOwnProperty,OD=Object.prototype.propertyIsEnumerable,dp=(r,e,t)=>e in r?DD(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xD=(r,e)=>{for(var t in e||(e={}))AD.call(e,t)&&dp(r,t,e[t]);if(pp)for(var t of pp(e))OD.call(e,t)&&dp(r,t,e[t]);return r},CD=(r,e)=>ID(r,SD(e));function ma(r){return CD(xD({},r),{level:(r==null?void 0:r.level)||ED.level})}function FD(r,e=Ds){return r[e]||""}function PD(r,e,t=Ds){return r[t]=e,r}function Qt(r,e=Ds){let t="";return typeof r.bindings>"u"?t=FD(r,e):t=r.bindings().context||"",t}function $D(r,e,t=Ds){const s=Qt(r,t);return s.trim()?`${s}/${e}`:e}function or(r,e,t=Ds){const s=$D(r,e,t),o=r.child({context:s});return PD(o,s,t)}class ND extends Wi{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class TD extends Wi{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class RD{constructor(e,t){this.logger=e,this.core=t}}let UD=class extends Wi{constructor(e,t){super(),this.relayer=e,this.logger=t}},jD=class extends Wi{constructor(e){super()}},BD=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class MD extends Wi{constructor(e,t){super(),this.relayer=e,this.logger=t}}let LD=class extends Wi{constructor(e,t){super(),this.core=e,this.logger=t}},zD=class{constructor(e,t){this.projectId=e,this.logger=t}},qD=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},HD=class{constructor(e){this.client=e}};function KD(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Jd(r,...e){if(!KD(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function gp(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function VD(r,e){Jd(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Dn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const uu=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function kD(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Zd(r){return typeof r=="string"&&(r=kD(r)),Jd(r),r}class GD{clone(){return this._cloneInto()}}function WD(r){const e=s=>r().update(Zd(s)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Xd(r=32){if(Dn&&typeof Dn.getRandomValues=="function")return Dn.getRandomValues(new Uint8Array(r));if(Dn&&typeof Dn.randomBytes=="function")return Dn.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function YD(r,e,t,s){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,s);const o=BigInt(32),c=BigInt(4294967295),h=Number(t>>o&c),f=Number(t&c),p=s?4:0,d=s?0:4;r.setUint32(e+p,h,s),r.setUint32(e+d,f,s)}class JD extends GD{constructor(e,t,s,o){super(),this.blockLen=e,this.outputLen=t,this.padOffset=s,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=uu(this.buffer)}update(e){gp(this);const{view:t,buffer:s,blockLen:o}=this;e=Zd(e);const c=e.length;for(let h=0;h<c;){const f=Math.min(o-this.pos,c-h);if(f===o){const p=uu(e);for(;o<=c-h;h+=o)this.process(p,h);continue}s.set(e.subarray(h,h+f),this.pos),this.pos+=f,h+=f,this.pos===o&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){gp(this),VD(e,this),this.finished=!0;const{buffer:t,view:s,blockLen:o,isLE:c}=this;let{pos:h}=this;t[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>o-h&&(this.process(s,0),h=0);for(let b=h;b<o;b++)t[b]=0;YD(s,o-8,BigInt(this.length*8),c),this.process(s,0);const f=uu(e),p=this.outputLen;if(p%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=p/4,g=this.get();if(d>g.length)throw new Error("_sha2: outputLen bigger than state");for(let b=0;b<d;b++)f.setUint32(4*b,g[b],c)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const s=e.slice(0,t);return this.destroy(),s}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:s,length:o,finished:c,destroyed:h,pos:f}=this;return e.length=o,e.pos=f,e.finished=c,e.destroyed=h,o%t&&e.buffer.set(s),e}}const Mo=BigInt(2**32-1),Hu=BigInt(32);function Qd(r,e=!1){return e?{h:Number(r&Mo),l:Number(r>>Hu&Mo)}:{h:Number(r>>Hu&Mo)|0,l:Number(r&Mo)|0}}function ZD(r,e=!1){let t=new Uint32Array(r.length),s=new Uint32Array(r.length);for(let o=0;o<r.length;o++){const{h:c,l:h}=Qd(r[o],e);[t[o],s[o]]=[c,h]}return[t,s]}const XD=(r,e)=>BigInt(r>>>0)<<Hu|BigInt(e>>>0),QD=(r,e,t)=>r>>>t,eI=(r,e,t)=>r<<32-t|e>>>t,tI=(r,e,t)=>r>>>t|e<<32-t,rI=(r,e,t)=>r<<32-t|e>>>t,iI=(r,e,t)=>r<<64-t|e>>>t-32,nI=(r,e,t)=>r>>>t-32|e<<64-t,sI=(r,e)=>e,oI=(r,e)=>r,aI=(r,e,t)=>r<<t|e>>>32-t,cI=(r,e,t)=>e<<t|r>>>32-t,uI=(r,e,t)=>e<<t-32|r>>>64-t,hI=(r,e,t)=>r<<t-32|e>>>64-t;function lI(r,e,t,s){const o=(e>>>0)+(s>>>0);return{h:r+t+(o/2**32|0)|0,l:o|0}}const fI=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),pI=(r,e,t,s)=>e+t+s+(r/2**32|0)|0,dI=(r,e,t,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(s>>>0),gI=(r,e,t,s,o)=>e+t+s+o+(r/2**32|0)|0,yI=(r,e,t,s,o)=>(r>>>0)+(e>>>0)+(t>>>0)+(s>>>0)+(o>>>0),vI=(r,e,t,s,o,c)=>e+t+s+o+c+(r/2**32|0)|0,xe={fromBig:Qd,split:ZD,toBig:XD,shrSH:QD,shrSL:eI,rotrSH:tI,rotrSL:rI,rotrBH:iI,rotrBL:nI,rotr32H:sI,rotr32L:oI,rotlSH:aI,rotlSL:cI,rotlBH:uI,rotlBL:hI,add:lI,add3L:fI,add3H:pI,add4L:dI,add4H:gI,add5H:vI,add5L:yI},[mI,bI]=(()=>xe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))))(),vi=new Uint32Array(80),mi=new Uint32Array(80);class wI extends JD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:s,Bl:o,Ch:c,Cl:h,Dh:f,Dl:p,Eh:d,El:g,Fh:b,Fl:E,Gh:I,Gl:S,Hh:R,Hl:B}=this;return[e,t,s,o,c,h,f,p,d,g,b,E,I,S,R,B]}set(e,t,s,o,c,h,f,p,d,g,b,E,I,S,R,B){this.Ah=e|0,this.Al=t|0,this.Bh=s|0,this.Bl=o|0,this.Ch=c|0,this.Cl=h|0,this.Dh=f|0,this.Dl=p|0,this.Eh=d|0,this.El=g|0,this.Fh=b|0,this.Fl=E|0,this.Gh=I|0,this.Gl=S|0,this.Hh=R|0,this.Hl=B|0}process(e,t){for(let O=0;O<16;O++,t+=4)vi[O]=e.getUint32(t),mi[O]=e.getUint32(t+=4);for(let O=16;O<80;O++){const D=vi[O-15]|0,x=mi[O-15]|0,C=xe.rotrSH(D,x,1)^xe.rotrSH(D,x,8)^xe.shrSH(D,x,7),l=xe.rotrSL(D,x,1)^xe.rotrSL(D,x,8)^xe.shrSL(D,x,7),w=vi[O-2]|0,K=mi[O-2]|0,Z=xe.rotrSH(w,K,19)^xe.rotrBH(w,K,61)^xe.shrSH(w,K,6),ae=xe.rotrSL(w,K,19)^xe.rotrBL(w,K,61)^xe.shrSL(w,K,6),ue=xe.add4L(l,ae,mi[O-7],mi[O-16]),pe=xe.add4H(ue,C,Z,vi[O-7],vi[O-16]);vi[O]=pe|0,mi[O]=ue|0}let{Ah:s,Al:o,Bh:c,Bl:h,Ch:f,Cl:p,Dh:d,Dl:g,Eh:b,El:E,Fh:I,Fl:S,Gh:R,Gl:B,Hh:H,Hl:P}=this;for(let O=0;O<80;O++){const D=xe.rotrSH(b,E,14)^xe.rotrSH(b,E,18)^xe.rotrBH(b,E,41),x=xe.rotrSL(b,E,14)^xe.rotrSL(b,E,18)^xe.rotrBL(b,E,41),C=b&I^~b&R,l=E&S^~E&B,w=xe.add5L(P,x,l,bI[O],mi[O]),K=xe.add5H(w,H,D,C,mI[O],vi[O]),Z=w|0,ae=xe.rotrSH(s,o,28)^xe.rotrBH(s,o,34)^xe.rotrBH(s,o,39),ue=xe.rotrSL(s,o,28)^xe.rotrBL(s,o,34)^xe.rotrBL(s,o,39),pe=s&c^s&f^c&f,de=o&h^o&p^h&p;H=R|0,P=B|0,R=I|0,B=S|0,I=b|0,S=E|0,{h:b,l:E}=xe.add(d|0,g|0,K|0,Z|0),d=f|0,g=p|0,f=c|0,p=h|0,c=s|0,h=o|0;const Y=xe.add3L(Z,ue,de);s=xe.add3H(Y,K,ae,pe),o=Y|0}({h:s,l:o}=xe.add(this.Ah|0,this.Al|0,s|0,o|0)),{h:c,l:h}=xe.add(this.Bh|0,this.Bl|0,c|0,h|0),{h:f,l:p}=xe.add(this.Ch|0,this.Cl|0,f|0,p|0),{h:d,l:g}=xe.add(this.Dh|0,this.Dl|0,d|0,g|0),{h:b,l:E}=xe.add(this.Eh|0,this.El|0,b|0,E|0),{h:I,l:S}=xe.add(this.Fh|0,this.Fl|0,I|0,S|0),{h:R,l:B}=xe.add(this.Gh|0,this.Gl|0,R|0,B|0),{h:H,l:P}=xe.add(this.Hh|0,this.Hl|0,H|0,P|0),this.set(s,o,c,h,f,p,d,g,b,E,I,S,R,B,H,P)}roundClean(){vi.fill(0),mi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const _I=WD(()=>new wI);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yh=BigInt(0),eg=BigInt(1),EI=BigInt(2);function vh(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function mh(r){if(!vh(r))throw new Error("Uint8Array expected")}function hu(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const DI=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function bh(r){mh(r);let e="";for(let t=0;t<r.length;t++)e+=DI[r[t]];return e}function tg(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?yh:BigInt("0x"+r)}const si={_0:48,_9:57,A:65,F:70,a:97,f:102};function yp(r){if(r>=si._0&&r<=si._9)return r-si._0;if(r>=si.A&&r<=si.F)return r-(si.A-10);if(r>=si.a&&r<=si.f)return r-(si.a-10)}function rg(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const s=new Uint8Array(t);for(let o=0,c=0;o<t;o++,c+=2){const h=yp(r.charCodeAt(c)),f=yp(r.charCodeAt(c+1));if(h===void 0||f===void 0){const p=r[c]+r[c+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+c)}s[o]=h*16+f}return s}function II(r){return tg(bh(r))}function Jo(r){return mh(r),tg(bh(Uint8Array.from(r).reverse()))}function ig(r,e){return rg(r.toString(16).padStart(e*2,"0"))}function Ku(r,e){return ig(r,e).reverse()}function oi(r,e,t){let s;if(typeof e=="string")try{s=rg(e)}catch(c){throw new Error(r+" must be hex string or Uint8Array, cause: "+c)}else if(vh(e))s=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const o=s.length;if(typeof t=="number"&&o!==t)throw new Error(r+" of length "+t+" expected, got "+o);return s}function vp(...r){let e=0;for(let s=0;s<r.length;s++){const o=r[s];mh(o),e+=o.length}const t=new Uint8Array(e);for(let s=0,o=0;s<r.length;s++){const c=r[s];t.set(c,o),o+=c.length}return t}const lu=r=>typeof r=="bigint"&&yh<=r;function SI(r,e,t){return lu(r)&&lu(e)&&lu(t)&&e<=r&&r<t}function ns(r,e,t,s){if(!SI(e,t,s))throw new Error("expected valid "+r+": "+t+" <= n < "+s+", got "+e)}function AI(r){let e;for(e=0;r>yh;r>>=eg,e+=1);return e}const OI=r=>(EI<<BigInt(r-1))-eg,xI={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||vh(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function wh(r,e,t={}){const s=(o,c,h)=>{const f=xI[c];if(typeof f!="function")throw new Error("invalid validator function");const p=r[o];if(!(h&&p===void 0)&&!f(p,r))throw new Error("param "+String(o)+" is invalid. Expected "+c+", got "+p)};for(const[o,c]of Object.entries(e))s(o,c,!1);for(const[o,c]of Object.entries(t))s(o,c,!0);return r}function mp(r){const e=new WeakMap;return(t,...s)=>{const o=e.get(t);if(o!==void 0)return o;const c=r(t,...s);return e.set(t,c),c}}const Ft=BigInt(0),vt=BigInt(1),Hi=BigInt(2),CI=BigInt(3),Vu=BigInt(4),bp=BigInt(5),wp=BigInt(8);function It(r,e){const t=r%e;return t>=Ft?t:e+t}function FI(r,e,t){if(e<Ft)throw new Error("invalid exponent, negatives unsupported");if(t<=Ft)throw new Error("invalid modulus");if(t===vt)return Ft;let s=vt;for(;e>Ft;)e&vt&&(s=s*r%t),r=r*r%t,e>>=vt;return s}function Lr(r,e,t){let s=r;for(;e-- >Ft;)s*=s,s%=t;return s}function _p(r,e){if(r===Ft)throw new Error("invert: expected non-zero number");if(e<=Ft)throw new Error("invert: expected positive modulus, got "+e);let t=It(r,e),s=e,o=Ft,c=vt;for(;t!==Ft;){const h=s/t,f=s%t,p=o-c*h;s=t,t=f,o=c,c=p}if(s!==vt)throw new Error("invert: does not exist");return It(o,e)}function PI(r){const e=(r-vt)/Hi;let t,s,o;for(t=r-vt,s=0;t%Hi===Ft;t/=Hi,s++);for(o=Hi;o<r&&FI(o,e,r)!==r-vt;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(s===1){const h=(r+vt)/Vu;return function(f,p){const d=f.pow(p,h);if(!f.eql(f.sqr(d),p))throw new Error("Cannot find square root");return d}}const c=(t+vt)/Hi;return function(h,f){if(h.pow(f,e)===h.neg(h.ONE))throw new Error("Cannot find square root");let p=s,d=h.pow(h.mul(h.ONE,o),t),g=h.pow(f,c),b=h.pow(f,t);for(;!h.eql(b,h.ONE);){if(h.eql(b,h.ZERO))return h.ZERO;let E=1;for(let S=h.sqr(b);E<p&&!h.eql(S,h.ONE);E++)S=h.sqr(S);const I=h.pow(d,vt<<BigInt(p-E-1));d=h.sqr(I),g=h.mul(g,I),b=h.mul(b,d),p=E}return g}}function $I(r){if(r%Vu===CI){const e=(r+vt)/Vu;return function(t,s){const o=t.pow(s,e);if(!t.eql(t.sqr(o),s))throw new Error("Cannot find square root");return o}}if(r%wp===bp){const e=(r-bp)/wp;return function(t,s){const o=t.mul(s,Hi),c=t.pow(o,e),h=t.mul(s,c),f=t.mul(t.mul(h,Hi),c),p=t.mul(h,t.sub(f,t.ONE));if(!t.eql(t.sqr(p),s))throw new Error("Cannot find square root");return p}}return PI(r)}const NI=(r,e)=>(It(r,e)&vt)===vt,TI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function RI(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=TI.reduce((s,o)=>(s[o]="function",s),e);return wh(r,t)}function UI(r,e,t){if(t<Ft)throw new Error("invalid exponent, negatives unsupported");if(t===Ft)return r.ONE;if(t===vt)return e;let s=r.ONE,o=e;for(;t>Ft;)t&vt&&(s=r.mul(s,o)),o=r.sqr(o),t>>=vt;return s}function jI(r,e){const t=new Array(e.length),s=e.reduce((c,h,f)=>r.is0(h)?c:(t[f]=c,r.mul(c,h)),r.ONE),o=r.inv(s);return e.reduceRight((c,h,f)=>r.is0(h)?c:(t[f]=r.mul(c,t[f]),r.mul(c,h)),o),t}function ng(r,e){const t=e!==void 0?e:r.toString(2).length,s=Math.ceil(t/8);return{nBitLength:t,nByteLength:s}}function sg(r,e,t=!1,s={}){if(r<=Ft)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:o,nByteLength:c}=ng(r,e);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let h;const f=Object.freeze({ORDER:r,isLE:t,BITS:o,BYTES:c,MASK:OI(o),ZERO:Ft,ONE:vt,create:p=>It(p,r),isValid:p=>{if(typeof p!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof p);return Ft<=p&&p<r},is0:p=>p===Ft,isOdd:p=>(p&vt)===vt,neg:p=>It(-p,r),eql:(p,d)=>p===d,sqr:p=>It(p*p,r),add:(p,d)=>It(p+d,r),sub:(p,d)=>It(p-d,r),mul:(p,d)=>It(p*d,r),pow:(p,d)=>UI(f,p,d),div:(p,d)=>It(p*_p(d,r),r),sqrN:p=>p*p,addN:(p,d)=>p+d,subN:(p,d)=>p-d,mulN:(p,d)=>p*d,inv:p=>_p(p,r),sqrt:s.sqrt||(p=>(h||(h=$I(r)),h(f,p))),invertBatch:p=>jI(f,p),cmov:(p,d,g)=>g?d:p,toBytes:p=>t?Ku(p,c):ig(p,c),fromBytes:p=>{if(p.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+p.length);return t?Jo(p):II(p)}});return Object.freeze(f)}const Ep=BigInt(0),Lo=BigInt(1);function fu(r,e){const t=e.negate();return r?t:e}function og(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function pu(r,e){og(r,e);const t=Math.ceil(e/r)+1,s=2**(r-1);return{windows:t,windowSize:s}}function BI(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,s)=>{if(!(t instanceof e))throw new Error("invalid point at index "+s)})}function MI(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,s)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+s)})}const du=new WeakMap,ag=new WeakMap;function gu(r){return ag.get(r)||1}function LI(r,e){return{constTimeNegate:fu,hasPrecomputes(t){return gu(t)!==1},unsafeLadder(t,s,o=r.ZERO){let c=t;for(;s>Ep;)s&Lo&&(o=o.add(c)),c=c.double(),s>>=Lo;return o},precomputeWindow(t,s){const{windows:o,windowSize:c}=pu(s,e),h=[];let f=t,p=f;for(let d=0;d<o;d++){p=f,h.push(p);for(let g=1;g<c;g++)p=p.add(f),h.push(p);f=p.double()}return h},wNAF(t,s,o){const{windows:c,windowSize:h}=pu(t,e);let f=r.ZERO,p=r.BASE;const d=BigInt(2**t-1),g=2**t,b=BigInt(t);for(let E=0;E<c;E++){const I=E*h;let S=Number(o&d);o>>=b,S>h&&(S-=g,o+=Lo);const R=I,B=I+Math.abs(S)-1,H=E%2!==0,P=S<0;S===0?p=p.add(fu(H,s[R])):f=f.add(fu(P,s[B]))}return{p:f,f:p}},wNAFUnsafe(t,s,o,c=r.ZERO){const{windows:h,windowSize:f}=pu(t,e),p=BigInt(2**t-1),d=2**t,g=BigInt(t);for(let b=0;b<h;b++){const E=b*f;if(o===Ep)break;let I=Number(o&p);if(o>>=g,I>f&&(I-=d,o+=Lo),I===0)continue;let S=s[E+Math.abs(I)-1];I<0&&(S=S.negate()),c=c.add(S)}return c},getPrecomputes(t,s,o){let c=du.get(s);return c||(c=this.precomputeWindow(s,t),t!==1&&du.set(s,o(c))),c},wNAFCached(t,s,o){const c=gu(t);return this.wNAF(c,this.getPrecomputes(c,t,o),s)},wNAFCachedUnsafe(t,s,o,c){const h=gu(t);return h===1?this.unsafeLadder(t,s,c):this.wNAFUnsafe(h,this.getPrecomputes(h,t,o),s,c)},setWindowSize(t,s){og(s,e),ag.set(t,s),du.delete(t)}}}function zI(r,e,t,s){if(BI(t,r),MI(s,e),t.length!==s.length)throw new Error("arrays of points and scalars must have equal length");const o=r.ZERO,c=AI(BigInt(t.length)),h=c>12?c-3:c>4?c-2:c?2:1,f=(1<<h)-1,p=new Array(f+1).fill(o),d=Math.floor((e.BITS-1)/h)*h;let g=o;for(let b=d;b>=0;b-=h){p.fill(o);for(let I=0;I<s.length;I++){const S=s[I],R=Number(S>>BigInt(b)&BigInt(f));p[R]=p[R].add(t[I])}let E=o;for(let I=p.length-1,S=o;I>0;I--)S=S.add(p[I]),E=E.add(S);if(g=g.add(E),b!==0)for(let I=0;I<h;I++)g=g.double()}return g}function qI(r){return RI(r.Fp),wh(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ng(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const xr=BigInt(0),Jt=BigInt(1),zo=BigInt(2),HI=BigInt(8),KI={zip215:!0};function VI(r){const e=qI(r);return wh(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function kI(r){const e=VI(r),{Fp:t,n:s,prehash:o,hash:c,randomBytes:h,nByteLength:f,h:p}=e,d=zo<<BigInt(f*8)-Jt,g=t.create,b=sg(e.n,e.nBitLength),E=e.uvRatio||((Y,M)=>{try{return{isValid:!0,value:t.sqrt(Y*t.inv(M))}}catch{return{isValid:!1,value:xr}}}),I=e.adjustScalarBytes||(Y=>Y),S=e.domain||((Y,M,j)=>{if(hu("phflag",j),M.length||j)throw new Error("Contexts/pre-hash are not supported");return Y});function R(Y,M){ns("coordinate "+Y,M,xr,d)}function B(Y){if(!(Y instanceof O))throw new Error("ExtendedPoint expected")}const H=mp((Y,M)=>{const{ex:j,ey:G,ez:ne}=Y,se=Y.is0();M==null&&(M=se?HI:t.inv(ne));const ie=g(j*M),ge=g(G*M),W=g(ne*M);if(se)return{x:xr,y:Jt};if(W!==Jt)throw new Error("invZ was invalid");return{x:ie,y:ge}}),P=mp(Y=>{const{a:M,d:j}=e;if(Y.is0())throw new Error("bad point: ZERO");const{ex:G,ey:ne,ez:se,et:ie}=Y,ge=g(G*G),W=g(ne*ne),re=g(se*se),J=g(re*re),le=g(ge*M),be=g(re*g(le+W)),he=g(J+g(j*g(ge*W)));if(be!==he)throw new Error("bad point: equation left != right (1)");const ye=g(G*ne),Ie=g(se*ie);if(ye!==Ie)throw new Error("bad point: equation left != right (2)");return!0});class O{constructor(M,j,G,ne){this.ex=M,this.ey=j,this.ez=G,this.et=ne,R("x",M),R("y",j),R("z",G),R("t",ne),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(M){if(M instanceof O)throw new Error("extended point not allowed");const{x:j,y:G}=M||{};return R("x",j),R("y",G),new O(j,G,Jt,g(j*G))}static normalizeZ(M){const j=t.invertBatch(M.map(G=>G.ez));return M.map((G,ne)=>G.toAffine(j[ne])).map(O.fromAffine)}static msm(M,j){return zI(O,b,M,j)}_setWindowSize(M){C.setWindowSize(this,M)}assertValidity(){P(this)}equals(M){B(M);const{ex:j,ey:G,ez:ne}=this,{ex:se,ey:ie,ez:ge}=M,W=g(j*ge),re=g(se*ne),J=g(G*ge),le=g(ie*ne);return W===re&&J===le}is0(){return this.equals(O.ZERO)}negate(){return new O(g(-this.ex),this.ey,this.ez,g(-this.et))}double(){const{a:M}=e,{ex:j,ey:G,ez:ne}=this,se=g(j*j),ie=g(G*G),ge=g(zo*g(ne*ne)),W=g(M*se),re=j+G,J=g(g(re*re)-se-ie),le=W+ie,be=le-ge,he=W-ie,ye=g(J*be),Ie=g(le*he),De=g(J*he),Ce=g(be*le);return new O(ye,Ie,Ce,De)}add(M){B(M);const{a:j,d:G}=e,{ex:ne,ey:se,ez:ie,et:ge}=this,{ex:W,ey:re,ez:J,et:le}=M;if(j===BigInt(-1)){const Vr=g((se-ne)*(re+W)),Ke=g((se+ne)*(re-W)),Re=g(Ke-Vr);if(Re===xr)return this.double();const Ve=g(ie*zo*le),Ze=g(ge*zo*J),nt=Ze+Ve,ke=Ke+Vr,st=Ze-Ve,Le=g(nt*Re),ze=g(ke*st),Qe=g(nt*st),je=g(Re*ke);return new O(Le,ze,je,Qe)}const be=g(ne*W),he=g(se*re),ye=g(ge*G*le),Ie=g(ie*J),De=g((ne+se)*(W+re)-be-he),Ce=Ie-ye,Ue=Ie+ye,Xe=g(he-j*be),Rt=g(De*Ce),_r=g(Ue*Xe),St=g(De*Xe),Nr=g(Ce*Ue);return new O(Rt,_r,Nr,St)}subtract(M){return this.add(M.negate())}wNAF(M){return C.wNAFCached(this,M,O.normalizeZ)}multiply(M){const j=M;ns("scalar",j,Jt,s);const{p:G,f:ne}=this.wNAF(j);return O.normalizeZ([G,ne])[0]}multiplyUnsafe(M,j=O.ZERO){const G=M;return ns("scalar",G,xr,s),G===xr?x:this.is0()||G===Jt?this:C.wNAFCachedUnsafe(this,G,O.normalizeZ,j)}isSmallOrder(){return this.multiplyUnsafe(p).is0()}isTorsionFree(){return C.unsafeLadder(this,s).is0()}toAffine(M){return H(this,M)}clearCofactor(){const{h:M}=e;return M===Jt?this:this.multiplyUnsafe(M)}static fromHex(M,j=!1){const{d:G,a:ne}=e,se=t.BYTES;M=oi("pointHex",M,se),hu("zip215",j);const ie=M.slice(),ge=M[se-1];ie[se-1]=ge&-129;const W=Jo(ie),re=j?d:t.ORDER;ns("pointHex.y",W,xr,re);const J=g(W*W),le=g(J-Jt),be=g(G*J-ne);let{isValid:he,value:ye}=E(le,be);if(!he)throw new Error("Point.fromHex: invalid y coordinate");const Ie=(ye&Jt)===Jt,De=(ge&128)!==0;if(!j&&ye===xr&&De)throw new Error("Point.fromHex: x=0 and x_0=1");return De!==Ie&&(ye=g(-ye)),O.fromAffine({x:ye,y:W})}static fromPrivateKey(M){return K(M).point}toRawBytes(){const{x:M,y:j}=this.toAffine(),G=Ku(j,t.BYTES);return G[G.length-1]|=M&Jt?128:0,G}toHex(){return bh(this.toRawBytes())}}O.BASE=new O(e.Gx,e.Gy,Jt,g(e.Gx*e.Gy)),O.ZERO=new O(xr,Jt,Jt,xr);const{BASE:D,ZERO:x}=O,C=LI(O,f*8);function l(Y){return It(Y,s)}function w(Y){return l(Jo(Y))}function K(Y){const M=t.BYTES;Y=oi("private key",Y,M);const j=oi("hashed private key",c(Y),2*M),G=I(j.slice(0,M)),ne=j.slice(M,2*M),se=w(G),ie=D.multiply(se),ge=ie.toRawBytes();return{head:G,prefix:ne,scalar:se,point:ie,pointBytes:ge}}function Z(Y){return K(Y).pointBytes}function ae(Y=new Uint8Array,...M){const j=vp(...M);return w(c(S(j,oi("context",Y),!!o)))}function ue(Y,M,j={}){Y=oi("message",Y),o&&(Y=o(Y));const{prefix:G,scalar:ne,pointBytes:se}=K(M),ie=ae(j.context,G,Y),ge=D.multiply(ie).toRawBytes(),W=ae(j.context,ge,se,Y),re=l(ie+W*ne);ns("signature.s",re,xr,s);const J=vp(ge,Ku(re,t.BYTES));return oi("result",J,t.BYTES*2)}const pe=KI;function de(Y,M,j,G=pe){const{context:ne,zip215:se}=G,ie=t.BYTES;Y=oi("signature",Y,2*ie),M=oi("message",M),j=oi("publicKey",j,ie),se!==void 0&&hu("zip215",se),o&&(M=o(M));const ge=Jo(Y.slice(ie,2*ie));let W,re,J;try{W=O.fromHex(j,se),re=O.fromHex(Y.slice(0,ie),se),J=D.multiplyUnsafe(ge)}catch{return!1}if(!se&&W.isSmallOrder())return!1;const le=ae(ne,re.toRawBytes(),W.toRawBytes(),M);return re.add(W.multiplyUnsafe(le)).subtract(J).clearCofactor().equals(O.ZERO)}return D._setWindowSize(8),{CURVE:e,getPublicKey:Z,sign:ue,verify:de,ExtendedPoint:O,utils:{getExtendedPublicKey:K,randomPrivateKey:()=>h(t.BYTES),precompute(Y=8,M=O.BASE){return M._setWindowSize(Y),M.multiply(BigInt(3)),M}}}}BigInt(0),BigInt(1);const _h=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Dp=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const GI=BigInt(1),Ip=BigInt(2);BigInt(3);const WI=BigInt(5),YI=BigInt(8);function JI(r){const e=BigInt(10),t=BigInt(20),s=BigInt(40),o=BigInt(80),c=_h,h=r*r%c*r%c,f=Lr(h,Ip,c)*h%c,p=Lr(f,GI,c)*r%c,d=Lr(p,WI,c)*p%c,g=Lr(d,e,c)*d%c,b=Lr(g,t,c)*g%c,E=Lr(b,s,c)*b%c,I=Lr(E,o,c)*E%c,S=Lr(I,o,c)*E%c,R=Lr(S,e,c)*d%c;return{pow_p_5_8:Lr(R,Ip,c)*r%c,b2:h}}function ZI(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function XI(r,e){const t=_h,s=It(e*e*e,t),o=It(s*s*e,t),c=JI(r*o).pow_p_5_8;let h=It(r*s*c,t);const f=It(e*h*h,t),p=h,d=It(h*Dp,t),g=f===r,b=f===It(-r,t),E=f===It(-r*Dp,t);return g&&(h=p),(b||E)&&(h=d),NI(h,t)&&(h=It(-h,t)),{isValid:g||b,value:h}}const QI=(()=>sg(_h,void 0,!0))(),eS=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:QI,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:YI,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:_I,randomBytes:Xd,adjustScalarBytes:ZI,uvRatio:XI}))(),cg=(()=>kI(eS))(),tS="EdDSA",rS="JWT",ug=".",hg="base64url",iS="utf8",nS="utf8",sS=":",oS="did",aS="key",Sp="base58btc",cS="z",uS="K36",hS=32;function Eh(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function lg(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Eh(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function fg(r,e){e||(e=r.reduce((o,c)=>o+c.length,0));const t=lg(e);let s=0;for(const o of r)t.set(o,s),s+=o.length;return Eh(t)}function lS(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<r.length;o++){var c=r.charAt(o),h=c.charCodeAt(0);if(t[h]!==255)throw new TypeError(c+" is ambiguous");t[h]=o}var f=r.length,p=r.charAt(0),d=Math.log(f)/Math.log(256),g=Math.log(256)/Math.log(f);function b(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var R=0,B=0,H=0,P=S.length;H!==P&&S[H]===0;)H++,R++;for(var O=(P-H)*g+1>>>0,D=new Uint8Array(O);H!==P;){for(var x=S[H],C=0,l=O-1;(x!==0||C<B)&&l!==-1;l--,C++)x+=256*D[l]>>>0,D[l]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");B=C,H++}for(var w=O-B;w!==O&&D[w]===0;)w++;for(var K=p.repeat(R);w<O;++w)K+=r.charAt(D[w]);return K}function E(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var R=0;if(S[R]!==" "){for(var B=0,H=0;S[R]===p;)B++,R++;for(var P=(S.length-R)*d+1>>>0,O=new Uint8Array(P);S[R];){var D=t[S.charCodeAt(R)];if(D===255)return;for(var x=0,C=P-1;(D!==0||x<H)&&C!==-1;C--,x++)D+=f*O[C]>>>0,O[C]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");H=x,R++}if(S[R]!==" "){for(var l=P-H;l!==P&&O[l]===0;)l++;for(var w=new Uint8Array(B+(P-l)),K=B;l!==P;)w[K++]=O[l++];return w}}}function I(S){var R=E(S);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:E,decode:I}}var fS=lS,pS=fS;const pg=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},dS=r=>new TextEncoder().encode(r),gS=r=>new TextDecoder().decode(r);class yS{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vS{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return dg(this,e)}}class mS{constructor(e){this.decoders=e}or(e){return dg(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const dg=(r,e)=>new mS({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class bS{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new yS(e,t,s),this.decoder=new vS(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ba=({name:r,prefix:e,encode:t,decode:s})=>new bS(r,e,t,s),Is=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:o}=pS(t,e);return ba({prefix:r,name:e,encode:s,decode:c=>pg(o(c))})},wS=(r,e,t,s)=>{const o={};for(let g=0;g<e.length;++g)o[e[g]]=g;let c=r.length;for(;r[c-1]==="=";)--c;const h=new Uint8Array(c*t/8|0);let f=0,p=0,d=0;for(let g=0;g<c;++g){const b=o[r[g]];if(b===void 0)throw new SyntaxError(`Non-${s} character`);p=p<<t|b,f+=t,f>=8&&(f-=8,h[d++]=255&p>>f)}if(f>=t||255&p<<8-f)throw new SyntaxError("Unexpected end of data");return h},_S=(r,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",h=0,f=0;for(let p=0;p<r.length;++p)for(f=f<<8|r[p],h+=8;h>t;)h-=t,c+=e[o&f>>h];if(h&&(c+=e[o&f<<t-h]),s)for(;c.length*t&7;)c+="=";return c},Nt=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>ba({prefix:e,name:r,encode(o){return _S(o,s,t)},decode(o){return wS(o,s,t,r)}}),ES=ba({prefix:"\0",name:"identity",encode:r=>gS(r),decode:r=>dS(r)});var DS=Object.freeze({__proto__:null,identity:ES});const IS=Nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var SS=Object.freeze({__proto__:null,base2:IS});const AS=Nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var OS=Object.freeze({__proto__:null,base8:AS});const xS=Is({prefix:"9",name:"base10",alphabet:"0123456789"});var CS=Object.freeze({__proto__:null,base10:xS});const FS=Nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),PS=Nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $S=Object.freeze({__proto__:null,base16:FS,base16upper:PS});const NS=Nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),TS=Nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),RS=Nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),US=Nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),jS=Nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),BS=Nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),MS=Nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),LS=Nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zS=Nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var qS=Object.freeze({__proto__:null,base32:NS,base32upper:TS,base32pad:RS,base32padupper:US,base32hex:jS,base32hexupper:BS,base32hexpad:MS,base32hexpadupper:LS,base32z:zS});const HS=Is({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),KS=Is({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var VS=Object.freeze({__proto__:null,base36:HS,base36upper:KS});const kS=Is({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),GS=Is({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var WS=Object.freeze({__proto__:null,base58btc:kS,base58flickr:GS});const YS=Nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),JS=Nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ZS=Nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),XS=Nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var QS=Object.freeze({__proto__:null,base64:YS,base64pad:JS,base64url:ZS,base64urlpad:XS});const gg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),e6=gg.reduce((r,e,t)=>(r[t]=e,r),[]),t6=gg.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function r6(r){return r.reduce((e,t)=>(e+=e6[t],e),"")}function i6(r){const e=[];for(const t of r){const s=t6[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const n6=ba({prefix:"🚀",name:"base256emoji",encode:r6,decode:i6});var s6=Object.freeze({__proto__:null,base256emoji:n6}),o6=yg,Ap=128,a6=127,c6=~a6,u6=Math.pow(2,31);function yg(r,e,t){e=e||[],t=t||0;for(var s=t;r>=u6;)e[t++]=r&255|Ap,r/=128;for(;r&c6;)e[t++]=r&255|Ap,r>>>=7;return e[t]=r|0,yg.bytes=t-s+1,e}var h6=ku,l6=128,Op=127;function ku(r,s){var t=0,s=s||0,o=0,c=s,h,f=r.length;do{if(c>=f)throw ku.bytes=0,new RangeError("Could not decode varint");h=r[c++],t+=o<28?(h&Op)<<o:(h&Op)*Math.pow(2,o),o+=7}while(h>=l6);return ku.bytes=c-s,t}var f6=Math.pow(2,7),p6=Math.pow(2,14),d6=Math.pow(2,21),g6=Math.pow(2,28),y6=Math.pow(2,35),v6=Math.pow(2,42),m6=Math.pow(2,49),b6=Math.pow(2,56),w6=Math.pow(2,63),_6=function(r){return r<f6?1:r<p6?2:r<d6?3:r<g6?4:r<y6?5:r<v6?6:r<m6?7:r<b6?8:r<w6?9:10},E6={encode:o6,decode:h6,encodingLength:_6},vg=E6;const xp=(r,e,t=0)=>(vg.encode(r,e,t),e),Cp=r=>vg.encodingLength(r),Gu=(r,e)=>{const t=e.byteLength,s=Cp(r),o=s+Cp(t),c=new Uint8Array(o+t);return xp(r,c,0),xp(t,c,s),c.set(e,o),new D6(r,t,e,c)};class D6{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const mg=({name:r,code:e,encode:t})=>new I6(r,e,t);class I6{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Gu(this.code,t):t.then(s=>Gu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const bg=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),S6=mg({name:"sha2-256",code:18,encode:bg("SHA-256")}),A6=mg({name:"sha2-512",code:19,encode:bg("SHA-512")});var O6=Object.freeze({__proto__:null,sha256:S6,sha512:A6});const wg=0,x6="identity",_g=pg,C6=r=>Gu(wg,_g(r)),F6={code:wg,name:x6,encode:_g,digest:C6};var P6=Object.freeze({__proto__:null,identity:F6});new TextEncoder,new TextDecoder;const Fp={...DS,...SS,...OS,...CS,...$S,...qS,...VS,...WS,...QS,...s6};({...O6,...P6});function Eg(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const Pp=Eg("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),yu=Eg("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=lg(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Dg={utf8:Pp,"utf-8":Pp,hex:Fp.base16,latin1:yu,ascii:yu,binary:yu,...Fp};function Dh(r,e="utf8"){const t=Dg[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function Ih(r,e="utf8"){const t=Dg[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Eh(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function ra(r){return Dh(Ih(ys(r),iS),hg)}function Ig(r){const e=Ih(uS,Sp),t=cS+Dh(fg([e,r]),Sp);return[oS,aS,t].join(sS)}function $6(r){return Dh(r,hg)}function N6(r){return Ih([ra(r.header),ra(r.payload)].join(ug),nS)}function T6(r){return[ra(r.header),ra(r.payload),$6(r.signature)].join(ug)}function $p(r=Xd(hS)){const e=cg.getPublicKey(r);return{secretKey:fg([r,e]),publicKey:e}}async function R6(r,e,t,s,o=ce.fromMiliseconds(Date.now())){const c={alg:tS,typ:rS},h=Ig(s.publicKey),f=o+t,p={iss:h,sub:r,aud:e,iat:o,exp:f},d=N6({header:c,payload:p}),g=cg.sign(d,s.secretKey.slice(0,32));return T6({header:c,payload:p,signature:g})}let U6=class extends dd{constructor(e){super(e),this.events=new wr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(vs(e.method,e.params||[],e.id||oa().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Cr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ms(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const j6=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),B6=()=>typeof window<"u",Np=r=>r.split("?")[0],Tp=10,M6=j6();class L6{constructor(e){if(this.url=e,this.events=new wr.EventEmitter,this.registering=!1,!Ff(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ys(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Ff(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=Nw.isReactNative()?void 0:{rejectUnauthorized:!Tw(e)},c=new M6(e,[],o);B6()?c.onerror=h=>{const f=h;s(this.emitError(f.error))}:c.on("error",h=>{s(this.emitError(h))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?sa(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=rh(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Rw(e,Np(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Tp&&this.events.setMaxListeners(Tp)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Np(this.url)}`));return this.events.emit("register_error",t),t}}var ia={exports:{}};ia.exports;(function(r,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,h=9007199254740991,f="[object Arguments]",p="[object Array]",d="[object AsyncFunction]",g="[object Boolean]",b="[object Date]",E="[object Error]",I="[object Function]",S="[object GeneratorFunction]",R="[object Map]",B="[object Number]",H="[object Null]",P="[object Object]",O="[object Promise]",D="[object Proxy]",x="[object RegExp]",C="[object Set]",l="[object String]",w="[object Symbol]",K="[object Undefined]",Z="[object WeakMap]",ae="[object ArrayBuffer]",ue="[object DataView]",pe="[object Float32Array]",de="[object Float64Array]",Y="[object Int8Array]",M="[object Int16Array]",j="[object Int32Array]",G="[object Uint8Array]",ne="[object Uint8ClampedArray]",se="[object Uint16Array]",ie="[object Uint32Array]",ge=/[\\^$.*+?()[\]{}|]/g,W=/^\[object .+?Constructor\]$/,re=/^(?:0|[1-9]\d*)$/,J={};J[pe]=J[de]=J[Y]=J[M]=J[j]=J[G]=J[ne]=J[se]=J[ie]=!0,J[f]=J[p]=J[ae]=J[g]=J[ue]=J[b]=J[E]=J[I]=J[R]=J[B]=J[P]=J[x]=J[C]=J[l]=J[Z]=!1;var le=typeof Ro=="object"&&Ro&&Ro.Object===Object&&Ro,be=typeof self=="object"&&self&&self.Object===Object&&self,he=le||be||Function("return this")(),ye=e&&!e.nodeType&&e,Ie=ye&&!0&&r&&!r.nodeType&&r,De=Ie&&Ie.exports===ye,Ce=De&&le.process,Ue=function(){try{return Ce&&Ce.binding&&Ce.binding("util")}catch{}}(),Xe=Ue&&Ue.isTypedArray;function Rt(_,$){for(var V=-1,ee=_==null?0:_.length,We=0,_e=[];++V<ee;){var tt=_[V];$(tt,V,_)&&(_e[We++]=tt)}return _e}function _r(_,$){for(var V=-1,ee=$.length,We=_.length;++V<ee;)_[We+V]=$[V];return _}function St(_,$){for(var V=-1,ee=_==null?0:_.length;++V<ee;)if($(_[V],V,_))return!0;return!1}function Nr(_,$){for(var V=-1,ee=Array(_);++V<_;)ee[V]=$(V);return ee}function Vr(_){return function($){return _($)}}function Ke(_,$){return _.has($)}function Re(_,$){return _==null?void 0:_[$]}function Ve(_){var $=-1,V=Array(_.size);return _.forEach(function(ee,We){V[++$]=[We,ee]}),V}function Ze(_,$){return function(V){return _($(V))}}function nt(_){var $=-1,V=Array(_.size);return _.forEach(function(ee){V[++$]=ee}),V}var ke=Array.prototype,st=Function.prototype,Le=Object.prototype,ze=he["__core-js_shared__"],Qe=st.toString,je=Le.hasOwnProperty,ot=function(){var _=/[^.]+$/.exec(ze&&ze.keys&&ze.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),at=Le.toString,ht=RegExp("^"+Qe.call(je).replace(ge,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ct=De?he.Buffer:void 0,et=he.Symbol,Ji=he.Uint8Array,Zi=Le.propertyIsEnumerable,Ea=ke.splice,kr=et?et.toStringTag:void 0,As=Object.getOwnPropertySymbols,Os=ct?ct.isBuffer:void 0,xs=Ze(Object.keys,Object),Cn=er(he,"DataView"),Si=er(he,"Map"),Fn=er(he,"Promise"),Pn=er(he,"Set"),Xi=er(he,"WeakMap"),Ai=er(Object,"create"),Da=Yr(Cn),Ia=Yr(Si),$n=Yr(Fn),Sa=Yr(Pn),Nn=Yr(Xi),Cs=et?et.prototype:void 0,Tn=Cs?Cs.valueOf:void 0;function Gr(_){var $=-1,V=_==null?0:_.length;for(this.clear();++$<V;){var ee=_[$];this.set(ee[0],ee[1])}}function Aa(){this.__data__=Ai?Ai(null):{},this.size=0}function Oa(_){var $=this.has(_)&&delete this.__data__[_];return this.size-=$?1:0,$}function xa(_){var $=this.__data__;if(Ai){var V=$[_];return V===s?void 0:V}return je.call($,_)?$[_]:void 0}function Ca(_){var $=this.__data__;return Ai?$[_]!==void 0:je.call($,_)}function Fa(_,$){var V=this.__data__;return this.size+=this.has(_)?0:1,V[_]=Ai&&$===void 0?s:$,this}Gr.prototype.clear=Aa,Gr.prototype.delete=Oa,Gr.prototype.get=xa,Gr.prototype.has=Ca,Gr.prototype.set=Fa;function ar(_){var $=-1,V=_==null?0:_.length;for(this.clear();++$<V;){var ee=_[$];this.set(ee[0],ee[1])}}function Pa(){this.__data__=[],this.size=0}function $a(_){var $=this.__data__,V=Oi($,_);if(V<0)return!1;var ee=$.length-1;return V==ee?$.pop():Ea.call($,V,1),--this.size,!0}function Na(_){var $=this.__data__,V=Oi($,_);return V<0?void 0:$[V][1]}function Ta(_){return Oi(this.__data__,_)>-1}function Ra(_,$){var V=this.__data__,ee=Oi(V,_);return ee<0?(++this.size,V.push([_,$])):V[ee][1]=$,this}ar.prototype.clear=Pa,ar.prototype.delete=$a,ar.prototype.get=Na,ar.prototype.has=Ta,ar.prototype.set=Ra;function Wr(_){var $=-1,V=_==null?0:_.length;for(this.clear();++$<V;){var ee=_[$];this.set(ee[0],ee[1])}}function Qi(){this.size=0,this.__data__={hash:new Gr,map:new(Si||ar),string:new Gr}}function Ua(_){var $=ai(this,_).delete(_);return this.size-=$?1:0,$}function en(_){return ai(this,_).get(_)}function ja(_){return ai(this,_).has(_)}function Ba(_,$){var V=ai(this,_),ee=V.size;return V.set(_,$),this.size+=V.size==ee?0:1,this}Wr.prototype.clear=Qi,Wr.prototype.delete=Ua,Wr.prototype.get=en,Wr.prototype.has=ja,Wr.prototype.set=Ba;function tn(_){var $=-1,V=_==null?0:_.length;for(this.__data__=new Wr;++$<V;)this.add(_[$])}function Fs(_){return this.__data__.set(_,s),this}function Ps(_){return this.__data__.has(_)}tn.prototype.add=tn.prototype.push=Fs,tn.prototype.has=Ps;function Er(_){var $=this.__data__=new ar(_);this.size=$.size}function Ma(){this.__data__=new ar,this.size=0}function La(_){var $=this.__data__,V=$.delete(_);return this.size=$.size,V}function za(_){return this.__data__.get(_)}function qa(_){return this.__data__.has(_)}function $s(_,$){var V=this.__data__;if(V instanceof ar){var ee=V.__data__;if(!Si||ee.length<t-1)return ee.push([_,$]),this.size=++V.size,this;V=this.__data__=new Wr(ee)}return V.set(_,$),this.size=V.size,this}Er.prototype.clear=Ma,Er.prototype.delete=La,Er.prototype.get=za,Er.prototype.has=qa,Er.prototype.set=$s;function Ns(_,$){var V=sn(_),ee=!V&&Vs(_),We=!V&&!ee&&jn(_),_e=!V&&!ee&&!We&&Ws(_),tt=V||ee||We||_e,bt=tt?Nr(_.length,String):[],Ne=bt.length;for(var Ye in _)($||je.call(_,Ye))&&!(tt&&(Ye=="length"||We&&(Ye=="offset"||Ye=="parent")||_e&&(Ye=="buffer"||Ye=="byteLength"||Ye=="byteOffset")||Ls(Ye,Ne)))&&bt.push(Ye);return bt}function Oi(_,$){for(var V=_.length;V--;)if(Ks(_[V][0],$))return V;return-1}function Rn(_,$,V){var ee=$(_);return sn(_)?ee:_r(ee,V(_))}function xi(_){return _==null?_===void 0?K:H:kr&&kr in Object(_)?Bs(_):Va(_)}function Un(_){return Fi(_)&&xi(_)==f}function Ci(_,$,V,ee,We){return _===$?!0:_==null||$==null||!Fi(_)&&!Fi($)?_!==_&&$!==$:Ts(_,$,V,ee,Ci,We)}function Ts(_,$,V,ee,We,_e){var tt=sn(_),bt=sn($),Ne=tt?p:Tr(_),Ye=bt?p:Tr($);Ne=Ne==f?P:Ne,Ye=Ye==f?P:Ye;var pt=Ne==P,Vt=Ye==P,wt=Ne==Ye;if(wt&&jn(_)){if(!jn($))return!1;tt=!0,pt=!1}if(wt&&!pt)return _e||(_e=new Er),tt||Ws(_)?rn(_,$,V,ee,We,_e):Ka(_,$,Ne,V,ee,We,_e);if(!(V&o)){var rt=pt&&je.call(_,"__wrapped__"),Mt=Vt&&je.call($,"__wrapped__");if(rt||Mt){var Dr=rt?_.value():_,cr=Mt?$.value():$;return _e||(_e=new Er),We(Dr,cr,V,ee,_e)}}return wt?(_e||(_e=new Er),js(_,$,V,ee,We,_e)):!1}function Ha(_){if(!Gs(_)||qs(_))return!1;var $=on(_)?ht:W;return $.test(Yr(_))}function Rs(_){return Fi(_)&&ks(_.length)&&!!J[xi(_)]}function Us(_){if(!Hs(_))return xs(_);var $=[];for(var V in Object(_))je.call(_,V)&&V!="constructor"&&$.push(V);return $}function rn(_,$,V,ee,We,_e){var tt=V&o,bt=_.length,Ne=$.length;if(bt!=Ne&&!(tt&&Ne>bt))return!1;var Ye=_e.get(_);if(Ye&&_e.get($))return Ye==$;var pt=-1,Vt=!0,wt=V&c?new tn:void 0;for(_e.set(_,$),_e.set($,_);++pt<bt;){var rt=_[pt],Mt=$[pt];if(ee)var Dr=tt?ee(Mt,rt,pt,$,_,_e):ee(rt,Mt,pt,_,$,_e);if(Dr!==void 0){if(Dr)continue;Vt=!1;break}if(wt){if(!St($,function(cr,Rr){if(!Ke(wt,Rr)&&(rt===cr||We(rt,cr,V,ee,_e)))return wt.push(Rr)})){Vt=!1;break}}else if(!(rt===Mt||We(rt,Mt,V,ee,_e))){Vt=!1;break}}return _e.delete(_),_e.delete($),Vt}function Ka(_,$,V,ee,We,_e,tt){switch(V){case ue:if(_.byteLength!=$.byteLength||_.byteOffset!=$.byteOffset)return!1;_=_.buffer,$=$.buffer;case ae:return!(_.byteLength!=$.byteLength||!_e(new Ji(_),new Ji($)));case g:case b:case B:return Ks(+_,+$);case E:return _.name==$.name&&_.message==$.message;case x:case l:return _==$+"";case R:var bt=Ve;case C:var Ne=ee&o;if(bt||(bt=nt),_.size!=$.size&&!Ne)return!1;var Ye=tt.get(_);if(Ye)return Ye==$;ee|=c,tt.set(_,$);var pt=rn(bt(_),bt($),ee,We,_e,tt);return tt.delete(_),pt;case w:if(Tn)return Tn.call(_)==Tn.call($)}return!1}function js(_,$,V,ee,We,_e){var tt=V&o,bt=nn(_),Ne=bt.length,Ye=nn($),pt=Ye.length;if(Ne!=pt&&!tt)return!1;for(var Vt=Ne;Vt--;){var wt=bt[Vt];if(!(tt?wt in $:je.call($,wt)))return!1}var rt=_e.get(_);if(rt&&_e.get($))return rt==$;var Mt=!0;_e.set(_,$),_e.set($,_);for(var Dr=tt;++Vt<Ne;){wt=bt[Vt];var cr=_[wt],Rr=$[wt];if(ee)var Bn=tt?ee(Rr,cr,wt,$,_,_e):ee(cr,Rr,wt,_,$,_e);if(!(Bn===void 0?cr===Rr||We(cr,Rr,V,ee,_e):Bn)){Mt=!1;break}Dr||(Dr=wt=="constructor")}if(Mt&&!Dr){var Pi=_.constructor,At=$.constructor;Pi!=At&&"constructor"in _&&"constructor"in $&&!(typeof Pi=="function"&&Pi instanceof Pi&&typeof At=="function"&&At instanceof At)&&(Mt=!1)}return _e.delete(_),_e.delete($),Mt}function nn(_){return Rn(_,Wa,Ms)}function ai(_,$){var V=_.__data__;return zs($)?V[typeof $=="string"?"string":"hash"]:V.map}function er(_,$){var V=Re(_,$);return Ha(V)?V:void 0}function Bs(_){var $=je.call(_,kr),V=_[kr];try{_[kr]=void 0;var ee=!0}catch{}var We=at.call(_);return ee&&($?_[kr]=V:delete _[kr]),We}var Ms=As?function(_){return _==null?[]:(_=Object(_),Rt(As(_),function($){return Zi.call(_,$)}))}:Ge,Tr=xi;(Cn&&Tr(new Cn(new ArrayBuffer(1)))!=ue||Si&&Tr(new Si)!=R||Fn&&Tr(Fn.resolve())!=O||Pn&&Tr(new Pn)!=C||Xi&&Tr(new Xi)!=Z)&&(Tr=function(_){var $=xi(_),V=$==P?_.constructor:void 0,ee=V?Yr(V):"";if(ee)switch(ee){case Da:return ue;case Ia:return R;case $n:return O;case Sa:return C;case Nn:return Z}return $});function Ls(_,$){return $=$??h,!!$&&(typeof _=="number"||re.test(_))&&_>-1&&_%1==0&&_<$}function zs(_){var $=typeof _;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?_!=="__proto__":_===null}function qs(_){return!!ot&&ot in _}function Hs(_){var $=_&&_.constructor,V=typeof $=="function"&&$.prototype||Le;return _===V}function Va(_){return at.call(_)}function Yr(_){if(_!=null){try{return Qe.call(_)}catch{}try{return _+""}catch{}}return""}function Ks(_,$){return _===$||_!==_&&$!==$}var Vs=Un(function(){return arguments}())?Un:function(_){return Fi(_)&&je.call(_,"callee")&&!Zi.call(_,"callee")},sn=Array.isArray;function ka(_){return _!=null&&ks(_.length)&&!on(_)}var jn=Os||He;function Ga(_,$){return Ci(_,$)}function on(_){if(!Gs(_))return!1;var $=xi(_);return $==I||$==S||$==d||$==D}function ks(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=h}function Gs(_){var $=typeof _;return _!=null&&($=="object"||$=="function")}function Fi(_){return _!=null&&typeof _=="object"}var Ws=Xe?Vr(Xe):Rs;function Wa(_){return ka(_)?Ns(_):Us(_)}function Ge(){return[]}function He(){return!1}r.exports=Ga})(ia,ia.exports);var z6=ia.exports;const q6=fd(z6);function H6(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<r.length;o++){var c=r.charAt(o),h=c.charCodeAt(0);if(t[h]!==255)throw new TypeError(c+" is ambiguous");t[h]=o}var f=r.length,p=r.charAt(0),d=Math.log(f)/Math.log(256),g=Math.log(256)/Math.log(f);function b(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var R=0,B=0,H=0,P=S.length;H!==P&&S[H]===0;)H++,R++;for(var O=(P-H)*g+1>>>0,D=new Uint8Array(O);H!==P;){for(var x=S[H],C=0,l=O-1;(x!==0||C<B)&&l!==-1;l--,C++)x+=256*D[l]>>>0,D[l]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");B=C,H++}for(var w=O-B;w!==O&&D[w]===0;)w++;for(var K=p.repeat(R);w<O;++w)K+=r.charAt(D[w]);return K}function E(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var R=0;if(S[R]!==" "){for(var B=0,H=0;S[R]===p;)B++,R++;for(var P=(S.length-R)*d+1>>>0,O=new Uint8Array(P);S[R];){var D=t[S.charCodeAt(R)];if(D===255)return;for(var x=0,C=P-1;(D!==0||x<H)&&C!==-1;C--,x++)D+=f*O[C]>>>0,O[C]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");H=x,R++}if(S[R]!==" "){for(var l=P-H;l!==P&&O[l]===0;)l++;for(var w=new Uint8Array(B+(P-l)),K=B;l!==P;)w[K++]=O[l++];return w}}}function I(S){var R=E(S);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:E,decode:I}}var K6=H6,V6=K6;const Sg=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},k6=r=>new TextEncoder().encode(r),G6=r=>new TextDecoder().decode(r);class W6{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Y6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ag(this,e)}}class J6{constructor(e){this.decoders=e}or(e){return Ag(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ag=(r,e)=>new J6({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Z6{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new W6(e,t,s),this.decoder=new Y6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wa=({name:r,prefix:e,encode:t,decode:s})=>new Z6(r,e,t,s),Ss=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:o}=V6(t,e);return wa({prefix:r,name:e,encode:s,decode:c=>Sg(o(c))})},X6=(r,e,t,s)=>{const o={};for(let g=0;g<e.length;++g)o[e[g]]=g;let c=r.length;for(;r[c-1]==="=";)--c;const h=new Uint8Array(c*t/8|0);let f=0,p=0,d=0;for(let g=0;g<c;++g){const b=o[r[g]];if(b===void 0)throw new SyntaxError(`Non-${s} character`);p=p<<t|b,f+=t,f>=8&&(f-=8,h[d++]=255&p>>f)}if(f>=t||255&p<<8-f)throw new SyntaxError("Unexpected end of data");return h},Q6=(r,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",h=0,f=0;for(let p=0;p<r.length;++p)for(f=f<<8|r[p],h+=8;h>t;)h-=t,c+=e[o&f>>h];if(h&&(c+=e[o&f<<t-h]),s)for(;c.length*t&7;)c+="=";return c},Tt=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>wa({prefix:e,name:r,encode(o){return Q6(o,s,t)},decode(o){return X6(o,s,t,r)}}),e8=wa({prefix:"\0",name:"identity",encode:r=>G6(r),decode:r=>k6(r)});var t8=Object.freeze({__proto__:null,identity:e8});const r8=Tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var i8=Object.freeze({__proto__:null,base2:r8});const n8=Tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var s8=Object.freeze({__proto__:null,base8:n8});const o8=Ss({prefix:"9",name:"base10",alphabet:"0123456789"});var a8=Object.freeze({__proto__:null,base10:o8});const c8=Tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),u8=Tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var h8=Object.freeze({__proto__:null,base16:c8,base16upper:u8});const l8=Tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),f8=Tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),p8=Tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),d8=Tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),g8=Tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),y8=Tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),v8=Tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),m8=Tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),b8=Tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var w8=Object.freeze({__proto__:null,base32:l8,base32upper:f8,base32pad:p8,base32padupper:d8,base32hex:g8,base32hexupper:y8,base32hexpad:v8,base32hexpadupper:m8,base32z:b8});const _8=Ss({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),E8=Ss({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var D8=Object.freeze({__proto__:null,base36:_8,base36upper:E8});const I8=Ss({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),S8=Ss({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var A8=Object.freeze({__proto__:null,base58btc:I8,base58flickr:S8});const O8=Tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),x8=Tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),C8=Tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),F8=Tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var P8=Object.freeze({__proto__:null,base64:O8,base64pad:x8,base64url:C8,base64urlpad:F8});const Og=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),$8=Og.reduce((r,e,t)=>(r[t]=e,r),[]),N8=Og.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function T8(r){return r.reduce((e,t)=>(e+=$8[t],e),"")}function R8(r){const e=[];for(const t of r){const s=N8[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const U8=wa({prefix:"🚀",name:"base256emoji",encode:T8,decode:R8});var j8=Object.freeze({__proto__:null,base256emoji:U8}),B8=xg,Rp=128,M8=127,L8=~M8,z8=Math.pow(2,31);function xg(r,e,t){e=e||[],t=t||0;for(var s=t;r>=z8;)e[t++]=r&255|Rp,r/=128;for(;r&L8;)e[t++]=r&255|Rp,r>>>=7;return e[t]=r|0,xg.bytes=t-s+1,e}var q8=Wu,H8=128,Up=127;function Wu(r,s){var t=0,s=s||0,o=0,c=s,h,f=r.length;do{if(c>=f)throw Wu.bytes=0,new RangeError("Could not decode varint");h=r[c++],t+=o<28?(h&Up)<<o:(h&Up)*Math.pow(2,o),o+=7}while(h>=H8);return Wu.bytes=c-s,t}var K8=Math.pow(2,7),V8=Math.pow(2,14),k8=Math.pow(2,21),G8=Math.pow(2,28),W8=Math.pow(2,35),Y8=Math.pow(2,42),J8=Math.pow(2,49),Z8=Math.pow(2,56),X8=Math.pow(2,63),Q8=function(r){return r<K8?1:r<V8?2:r<k8?3:r<G8?4:r<W8?5:r<Y8?6:r<J8?7:r<Z8?8:r<X8?9:10},e5={encode:B8,decode:q8,encodingLength:Q8},Cg=e5;const jp=(r,e,t=0)=>(Cg.encode(r,e,t),e),Bp=r=>Cg.encodingLength(r),Yu=(r,e)=>{const t=e.byteLength,s=Bp(r),o=s+Bp(t),c=new Uint8Array(o+t);return jp(r,c,0),jp(t,c,s),c.set(e,o),new t5(r,t,e,c)};class t5{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Fg=({name:r,code:e,encode:t})=>new r5(r,e,t);class r5{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Yu(this.code,t):t.then(s=>Yu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Pg=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),i5=Fg({name:"sha2-256",code:18,encode:Pg("SHA-256")}),n5=Fg({name:"sha2-512",code:19,encode:Pg("SHA-512")});var s5=Object.freeze({__proto__:null,sha256:i5,sha512:n5});const $g=0,o5="identity",Ng=Sg,a5=r=>Yu($g,Ng(r)),c5={code:$g,name:o5,encode:Ng,digest:a5};var u5=Object.freeze({__proto__:null,identity:c5});new TextEncoder,new TextDecoder;const Mp={...t8,...i8,...s8,...a8,...h8,...w8,...D8,...A8,...P8,...j8};({...s5,...u5});function Tg(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function h5(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Tg(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Rg(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const Lp=Rg("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),vu=Rg("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=h5(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),l5={utf8:Lp,"utf-8":Lp,hex:Mp.base16,latin1:vu,ascii:vu,binary:vu,...Mp};function f5(r,e="utf8"){const t=l5[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Tg(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}const Ug="wc",p5=2,Sh="core",Ei=`${Ug}@2:${Sh}:`,d5={name:Sh,logger:"error"},g5={database:":memory:"},y5="crypto",zp="client_ed25519_seed",v5=ce.ONE_DAY,m5="keychain",b5="0.3",w5="messages",_5="0.3",E5=ce.SIX_HOURS,D5="publisher",jg="irn",I5="error",Bg="wss://relay.walletconnect.com",qp="wss://relay.walletconnect.org",S5="relayer",ft={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},A5="_subscription",ss={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},O5=ce.ONE_SECOND/2,x5="2.9.0",C5=1e4,F5="0.3",P5="WALLETCONNECT_CLIENT_ID",qr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},$5="subscription",N5="0.3",T5=ce.FIVE_SECONDS*1e3,R5="pairing",U5="0.3",os={wc_pairingDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:0},res:{ttl:ce.ONE_DAY,prompt:!1,tag:0}}},zr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},j5="history",B5="0.3",M5="expirer",vr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},L5="0.3",mu="verify-api",Hp="https://verify.walletconnect.com";class z5{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=m5,this.version=b5,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=Q("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=or(t,this.name)}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Bd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Md(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class q5{constructor(e,t,s){this.core=e,this.logger=t,this.name=y5,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=$p(o);return Ig(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=JE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),h=$p(c),f=Uu();return await R6(f,o,v5,h)},this.generateSharedKey=(o,c,h)=>{this.isInitialized();const f=this.getPrivateKey(o),p=ZE(f,c);return this.setSymKey(p,h)},this.setSymKey=async(o,c)=>{this.isInitialized();const h=c||XE(o);return await this.keychain.set(h,o),h},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,h)=>{this.isInitialized();const f=Ud(h),p=ys(c);if(Gf(f)){const E=f.senderPublicKey,I=f.receiverPublicKey;o=await this.generateSharedKey(E,I)}const d=this.getSymKey(o),{type:g,senderPublicKey:b}=f;return e3({type:g,symKey:d,message:p,senderPublicKey:b})},this.decode=async(o,c,h)=>{this.isInitialized();const f=i3(c,h);if(Gf(f)){const g=f.receiverPublicKey,b=f.senderPublicKey;o=await this.generateSharedKey(g,b)}const p=this.getSymKey(o),d=t3({symKey:p,encoded:c});return sa(d)},this.getPayloadType=o=>{const c=Qo(o);return _s(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Qo(o);return c.senderPublicKey?mr(c.senderPublicKey,Kt):void 0},this.core=e,this.logger=or(t,this.name),this.keychain=s||new z5(this.core,this.logger)}get context(){return Qt(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(zp)}catch{e=Uu(),await this.keychain.set(zp,e)}return f5(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class H5 extends RD{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=w5,this.version=_5,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Sn(o);let h=this.messages.get(s);return typeof h>"u"&&(h={}),typeof h[c]<"u"||(h[c]=o,this.messages.set(s,h),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),h=Sn(o);return typeof c[h]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=or(e,this.name),this.core=t}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Bd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Md(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class K5 extends UD{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new wr.EventEmitter,this.name=D5,this.queue=new Map,this.publishTimeout=ce.toMiliseconds(ce.TEN_SECONDS),this.queueTimeout=ce.toMiliseconds(ce.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const h=(c==null?void 0:c.ttl)||E5,f=ju(c),p=(c==null?void 0:c.prompt)||!1,d=(c==null?void 0:c.tag)||0,g=(c==null?void 0:c.id)||oa().toString(),b={topic:s,message:o,opts:{ttl:h,relay:f,prompt:p,tag:d,id:g}},E=setTimeout(()=>this.queue.set(g,b),this.queueTimeout);try{await await ea(this.rpcPublish(s,o,h,f,p,d,g),this.publishTimeout),clearTimeout(E),this.relayer.events.emit(ft.publish,b)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(h){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(h),h}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=or(t,this.name),this.registerEventListeners()}get context(){return Qt(this.logger)}rpcPublish(e,t,s,o,c,h,f){var p,d,g,b;const E={method:Vo(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:h},id:f};return Ht((p=E.params)==null?void 0:p.prompt)&&((d=E.params)==null||delete d.prompt),Ht((g=E.params)==null?void 0:g.tag)&&((b=E.params)==null||delete b.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:E}),this.relayer.request(E)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ft.connection_stalled);return}this.checkQueue()}),this.relayer.on(ft.message_ack,e=>{this.onPublish(e.id.toString())})}}class V5{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var k5=Object.defineProperty,G5=Object.defineProperties,W5=Object.getOwnPropertyDescriptors,Kp=Object.getOwnPropertySymbols,Y5=Object.prototype.hasOwnProperty,J5=Object.prototype.propertyIsEnumerable,Vp=(r,e,t)=>e in r?k5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,as=(r,e)=>{for(var t in e||(e={}))Y5.call(e,t)&&Vp(r,t,e[t]);if(Kp)for(var t of Kp(e))J5.call(e,t)&&Vp(r,t,e[t]);return r},bu=(r,e)=>G5(r,W5(e));class Z5 extends MD{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new V5,this.events=new wr.EventEmitter,this.name=$5,this.version=N5,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ei,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=ju(o),h={topic:s,relay:c};this.pending.set(s,h);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const h=new ce.Watch;h.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),o(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=T5&&(clearInterval(f),h.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=or(t,this.name),this.clientId=""}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=ju(s);await this.rpcUnsubscribe(e,t,o);const c=yt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Vo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ea(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ft.connection_stalled)}return Sn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Vo(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ea(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ft.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Vo(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,bu(as({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,as({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,as({},t)),this.topicMap.set(t.topic,e),this.events.emit(qr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(qr.deleted,bu(as({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(qr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(qr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Kr(t)&&this.onBatchSubscribe(t.map((s,o)=>bu(as({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(ft.connect,async()=>{await this.onConnect()}),this.relayer.on(ft.disconnect,()=>{this.onDisconnect()}),this.events.on(qr.created,async e=>{const t=qr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(qr.deleted,async e=>{const t=qr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var X5=Object.defineProperty,kp=Object.getOwnPropertySymbols,Q5=Object.prototype.hasOwnProperty,eA=Object.prototype.propertyIsEnumerable,Gp=(r,e,t)=>e in r?X5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tA=(r,e)=>{for(var t in e||(e={}))Q5.call(e,t)&&Gp(r,t,e[t]);if(kp)for(var t of kp(e))eA.call(e,t)&&Gp(r,t,e[t]);return r};class rA extends jD{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new wr.EventEmitter,this.name=S5,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?or(e.logger,this.name):va(ma({level:e.logger||I5})),this.messages=new H5(this.logger,e.core),this.subscriber=new Z5(this,this.logger),this.publisher=new K5(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Bg,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${qp}...`),await this.restartTransport(qp)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},C5)}get context(){return Qt(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(c=>{this.subscriber.once(qr.created,h=>{h.topic===e&&c()})}),new Promise(async c=>{o=await this.subscriber.subscribe(e,t),c()})]),o)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(ft.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(qr.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,s)=>{await ea(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>s(o)).then(()=>t()).finally(()=>this.removeListener(ft.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(ft.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.events.emit(ft.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(ss.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new U6(new L6(d3({sdkVersion:x5,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,s):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ih(e)){if(!e.method.endsWith(A5))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,h={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(tA({type:"event",event:t.id},h)),this.events.emit(t.id,h),await this.acknowledgePayload(e),await this.onMessageEvent(h)}else ms(e)&&this.events.emit(ft.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ft.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=nh(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(ss.payload,e=>this.onProviderPayload(e)),this.provider.on(ss.connect,()=>{this.events.emit(ft.connect)}),this.provider.on(ss.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(ss.error,e=>{this.logger.error(e),this.events.emit(ft.error,e)})}registerEventListeners(){this.events.on(ft.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(ft.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ce.toMiliseconds(O5))}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var iA=Object.defineProperty,Wp=Object.getOwnPropertySymbols,nA=Object.prototype.hasOwnProperty,sA=Object.prototype.propertyIsEnumerable,Yp=(r,e,t)=>e in r?iA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Jp=(r,e)=>{for(var t in e||(e={}))nA.call(e,t)&&Yp(r,t,e[t]);if(Wp)for(var t of Wp(e))sA.call(e,t)&&Yp(r,t,e[t]);return r};class _a extends BD{constructor(e,t,s,o=Ei,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=F5,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!Ht(h)?this.map.set(this.getKey(h),h):j3(h)?this.map.set(h.id,h):B3(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,f)=>{this.isInitialized(),this.map.has(h)?await this.update(h,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:f}),this.map.set(h,f),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(f=>Object.keys(h).every(p=>q6(f[p],h[p]))):this.values),this.update=async(h,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:f});const p=Jp(Jp({},this.getData(h)),f);this.map.set(h,p),await this.persist()},this.delete=async(h,f)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:f}),this.map.delete(h),await this.persist())},this.logger=or(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class oA{constructor(e,t){this.core=e,this.logger=t,this.name=R5,this.version=U5,this.events=new th,this.initialized=!1,this.storagePrefix=Ei,this.ignoredPayloadTypes=[ki],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Uu(),o=await this.core.crypto.setSymKey(s),c=Fr(ce.FIVE_MINUTES),h={protocol:jg},f={topic:o,expiry:c,relay:h,active:!1},p=O3({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:h});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:p}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:h}=I3(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const f=Fr(ce.FIVE_MINUTES),p={topic:o,relay:h,expiry:f,active:!1};return await this.pairings.set(o,p),await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:h}),this.core.expirer.set(o,f),s.activatePairing&&await this.activate({topic:o}),p},this.activate=async({topic:s})=>{this.isInitialized();const o=Fr(ce.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:f,reject:p}=In();this.events.once(_t("pairing_ping",c),({error:d})=>{d?p(d):f()}),await h()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",yt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const h=vs(o,c),f=await this.core.crypto.encode(s,h),p=os[o].req;return this.core.history.set(s,h),this.core.relayer.publish(s,f,p),h.id},this.sendResult=async(s,o,c)=>{const h=nh(s,c),f=await this.core.crypto.encode(o,h),p=await this.core.history.get(o,s),d=os[p.request.method].res;await this.core.relayer.publish(o,f,d),await this.core.history.resolve(h)},this.sendError=async(s,o,c)=>{const h=rh(s,c),f=await this.core.crypto.encode(o,h),p=await this.core.history.get(o,s),d=os[p.request.method]?os[p.request.method].res:os.unregistered_method.res;await this.core.relayer.publish(o,f,d),await this.core.history.resolve(h)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,yt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>wi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s,h=c.method;if(this.pairings.keys.includes(o))switch(h){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,h=(await this.core.history.get(o,c.id)).request.method;if(this.pairings.keys.includes(o))switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(h){await this.sendError(c,s,h),this.logger.error(h)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{bi(o)?this.events.emit(_t("pairing_ping",c),{}):Cr(o)&&this.events.emit(_t("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(h){await this.sendError(c,s,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:h}=o;try{if(this.registeredMethods.includes(h))return;const f=yt("WC_METHOD_UNSUPPORTED",h);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(yt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!Xt(s)){const{message:o}=Q("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!U3(s.uri)){const{message:o}=Q("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!Xt(s)){const{message:c}=Q("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!Xt(s)){const{message:c}=Q("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Ct(s,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(wi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=Q("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=or(t,this.name),this.pairings=new _a(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ft.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);ih(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ms(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))})}registerExpirerEvents(){this.core.expirer.on(vr.expired,async e=>{const{topic:t}=zd(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class aA extends TD{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new wr.EventEmitter,this.name=j5,this.version=B5,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const h={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Fr(ce.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(zr.created,h)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Cr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(zr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(zr.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=or(t,this.name)}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:vs(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(zr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(zr.created,e=>{const t=zr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(zr.updated,e=>{const t=zr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(zr.deleted,e=>{const t=zr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ce.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class cA extends LD{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new wr.EventEmitter,this.name=M5,this.version=L5,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),h={target:c,expiry:o};this.expirations.set(c,h),this.checkExpiry(c,h),this.events.emit(vr.created,{target:c,expiration:h})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(vr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=or(t,this.name)}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return g3(e);if(typeof e=="number")return y3(e);const{message:t}=Q("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ce.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(vr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(vr.created,e=>{const t=vr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(vr.expired,e=>{const t=vr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(vr.deleted,e=>{const t=vr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class uA extends zD{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=mu,this.initialized=!1,this.init=async s=>{jd()||!fh()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Hp,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const c=this.startAbortTimer(ce.FIVE_SECONDS),h=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),h.status===200?(o=await h.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(mu))return s();const c=document.createElement("iframe");c.setAttribute("id",mu),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,s()}),c.addEventListener("error",h=>{o(h)}),document.body.append(c),this.iframe=c}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ce.toMiliseconds(ce.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=or(t,this.name),this.verifyUrl=Hp,this.abortController=new AbortController,this.isDevEnv=lh()&&{}.IS_VITEST}get context(){return Qt(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),ce.toMiliseconds(e))}}var hA=Object.defineProperty,Zp=Object.getOwnPropertySymbols,lA=Object.prototype.hasOwnProperty,fA=Object.prototype.propertyIsEnumerable,Xp=(r,e,t)=>e in r?hA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qp=(r,e)=>{for(var t in e||(e={}))lA.call(e,t)&&Xp(r,t,e[t]);if(Zp)for(var t of Zp(e))fA.call(e,t)&&Xp(r,t,e[t]);return r};class Ah extends ND{constructor(e){super(e),this.protocol=Ug,this.version=p5,this.name=Sh,this.events=new wr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Bg;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:va(ma({level:(e==null?void 0:e.logger)||d5.logger}));this.logger=or(t,this.name),this.heartbeat=new xn.HeartBeat,this.crypto=new q5(this,this.logger,e==null?void 0:e.keychain),this.history=new aA(this,this.logger),this.expirer=new cA(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new U2(Qp(Qp({},g5),e==null?void 0:e.storageOptions)),this.relayer=new rA({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new oA(this,this.logger),this.verify=new uA(this.projectId||"",this.logger)}static async init(e){const t=new Ah(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(P5,s),t}get context(){return Qt(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const pA=Ah,Mg="wc",Lg=2,zg="client",Oh=`${Mg}@${Lg}:${zg}:`,wu={name:zg,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},dA="WALLETCONNECT_DEEPLINK_CHOICE",gA="proposal",qg="Proposal expired",yA="session",qo=ce.SEVEN_DAYS,vA="engine",cs={wc_sessionPropose:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1115}}},_u={min:ce.FIVE_MINUTES,max:ce.SEVEN_DAYS},mA="request",bA=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var wA=Object.defineProperty,_A=Object.defineProperties,EA=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,DA=Object.prototype.hasOwnProperty,IA=Object.prototype.propertyIsEnumerable,td=(r,e,t)=>e in r?wA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yr=(r,e)=>{for(var t in e||(e={}))DA.call(e,t)&&td(r,t,e[t]);if(ed)for(var t of ed(e))IA.call(e,t)&&td(r,t,e[t]);return r},Eu=(r,e)=>_A(r,EA(e));class SA extends HD{constructor(e){super(e),this.name=vA,this.events=new th,this.initialized=!1,this.ignoredPayloadTypes=[ki],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(cs)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const s=Eu(yr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:h,sessionProperties:f,relays:p}=s;let d=o,g,b=!1;if(d&&(b=this.client.core.pairing.pairings.get(d).active),!d||!b){const{topic:O,uri:D}=await this.client.core.pairing.create();d=O,g=D}const E=await this.client.core.crypto.generateKeyPair(),I=yr({requiredNamespaces:c,optionalNamespaces:h,relays:p??[{protocol:jg}],proposer:{publicKey:E,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:S,resolve:R,done:B}=In(ce.FIVE_MINUTES,qg);if(this.events.once(_t("session_connect"),async({error:O,session:D})=>{if(O)S(O);else if(D){D.self.publicKey=E;const x=Eu(yr({},D),{requiredNamespaces:D.requiredNamespaces,optionalNamespaces:D.optionalNamespaces});await this.client.session.set(D.topic,x),await this.setExpiry(D.topic,D.expiry),d&&await this.client.core.pairing.updateMetadata({topic:d,metadata:D.peer.metadata}),R(x)}}),!d){const{message:O}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${d}`);throw new Error(O)}const H=await this.sendRequest(d,"wc_sessionPropose",I),P=Fr(ce.FIVE_MINUTES);return await this.setProposal(H,yr({id:H,expiry:P},I)),{uri:g,approval:B}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:h}=t,f=this.client.proposal.get(s);let{pairingTopic:p,proposer:d,requiredNamespaces:g,optionalNamespaces:b}=f;p=p||"",An(g)||(g=P3(c,"approve()"));const E=await this.client.core.crypto.generateKeyPair(),I=d.publicKey,S=await this.client.core.crypto.generateSharedKey(E,I);p&&s&&(await this.client.core.pairing.updateMetadata({topic:p,metadata:d.metadata}),await this.sendResult(s,p,{relay:{protocol:o??"irn"},responderPublicKey:E}),await this.client.proposal.delete(s,yt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:p}));const R=yr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:g,optionalNamespaces:b,pairingTopic:p,controller:{publicKey:E,metadata:this.client.metadata},expiry:Fr(qo)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(S),await this.sendRequest(S,"wc_sessionSettle",R);const B=Eu(yr({},R),{topic:S,pairingTopic:p,acknowledged:!1,self:R.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:E});return await this.client.session.set(S,B),await this.setExpiry(S,Fr(qo)),{topic:S,acknowledged:()=>new Promise(H=>setTimeout(()=>H(this.client.session.get(S)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,yt("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:h,resolve:f,reject:p}=In();return this.events.once(_t("session_update",c),({error:d})=>{d?p(d):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:h}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:c,resolve:h,reject:f}=In();return this.events.once(_t("session_extend",o),({error:p})=>{p?f(p):h()}),await this.setExpiry(s,Fr(qo)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:h}=t,f=await this.sendRequest(c,"wc_sessionRequest",{request:o,chainId:s},h),{done:p,resolve:d,reject:g}=In(h);this.events.once(_t("session_request",f),({error:E,result:I})=>{E?g(E):d(I)}),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f});const b=await this.client.core.storage.getItem(dA);return v3({id:f,topic:c,wcDeepLink:b}),await p()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;bi(o)?await this.sendResult(c,s,o.result):Cr(o)&&await this.sendError(c,s,o.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:c,resolve:h,reject:f}=In();this.events.once(_t("session_ping",o),({error:p})=>{p?f(p):h()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=oa().toString();let c;const h=f=>{(f==null?void 0:f.id.toString())===o&&(this.client.core.relayer.events.removeListener(ft.message_ack,h),c())};await Promise.all([new Promise(f=>{c=f,this.client.core.relayer.on(ft.message_ack,h)}),this.sendRequest(s,"wc_sessionDelete",yt("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>T3(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var h,f;return((h=c.peerMetadata)==null?void 0:h.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,yt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t)},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,yt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=cs.wc_sessionRequest.req.ttl,{id:o,topic:c,params:h}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:h}),s&&this.client.core.expirer.set(o,Fr(s))},this.sendRequest=async(t,s,o,c,h)=>{const f=vs(s,o);if(fh()&&bA.includes(s)){const g=Sn(JSON.stringify(f));await this.client.core.verify.register({attestationId:g})}const p=await this.client.core.crypto.encode(t,f),d=cs[s].req;return c&&(d.ttl=c),h&&(d.id=h),this.client.core.history.set(t,f),this.client.core.relayer.publish(t,p,d),f.id},this.sendResult=async(t,s,o)=>{const c=nh(t,o),h=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),p=cs[f.request.method].res;this.client.core.relayer.publish(s,h,p),await this.client.core.history.resolve(c)},this.sendError=async(t,s,o)=>{const c=rh(t,o),h=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),p=cs[f.request.method].res;this.client.core.relayer.publish(s,h,p),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{wi(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{wi(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(yr({},s.params));const h=Fr(ce.FIVE_MINUTES),f=yr({id:c,pairingTopic:t,expiry:h},o);await this.setProposal(c,f);const p=Sn(JSON.stringify(s)),d=await this.getVerifyContext(p,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:d})}catch(h){await this.sendError(c,t,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(bi(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const f=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const p=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:p});const d=await this.client.core.crypto.generateSharedKey(f,p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:d});const g=await this.client.core.relayer.subscribe(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:g}),await this.client.core.pairing.activate({topic:t})}else Cr(s)&&(await this.client.proposal.delete(o,yt("USER_DISCONNECTED")),this.events.emit(_t("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:h,controller:f,expiry:p,namespaces:d,requiredNamespaces:g,optionalNamespaces:b,sessionProperties:E,pairingTopic:I}=s.params,S=yr({topic:t,relay:h,expiry:p,namespaces:d,acknowledged:!0,pairingTopic:I,requiredNamespaces:g,optionalNamespaces:b,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},E&&{sessionProperties:E});await this.sendResult(s.id,t,!0),this.events.emit(_t("session_connect"),{session:S}),this.cleanupDuplicatePairings(S)}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;bi(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(_t("session_approve",o),{})):Cr(s)&&(await this.client.session.delete(t,yt("USER_DISCONNECTED")),this.events.emit(_t("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidUpdate(yr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:o})}catch(h){await this.sendError(c,t,h),this.client.logger.error(h)}},this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;bi(s)?this.events.emit(_t("session_update",o),{}):Cr(s)&&this.events.emit(_t("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Fr(qo)),await this.sendResult(o,t,!0),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;bi(s)?this.events.emit(_t("session_extend",o),{}):Cr(s)&&this.events.emit(_t("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult(o,t,!0),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{bi(s)?this.events.emit(_t("session_ping",o),{}):Cr(s)&&this.events.emit(_t("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(ft.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult(o,t,!0)]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(yr({topic:t},c)),await this.setPendingSessionRequest({id:o,topic:t,params:c});const h=Sn(JSON.stringify(s)),f=this.client.session.get(t),p=await this.getVerifyContext(h,f.peer.metadata);this.client.events.emit("session_request",{id:o,topic:t,params:c,verifyContext:p})}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;bi(s)?this.events.emit(_t("session_request",o),{result:s.result}):Cr(s)&&this.events.emit(_t("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidEmit(yr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c})}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.isValidConnect=async t=>{if(!Xt(t)){const{message:p}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(p)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:h,relays:f}=t;if(Ht(s)||await this.isValidPairingTopic(s),!k3(f,!0)){const{message:p}=Q("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(p)}!Ht(o)&&An(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ht(c)&&An(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ht(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=V3(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!Xt(t))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:h}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),p=Go(o,"approve()");if(p)throw new Error(p.message);const d=tp(f.requiredNamespaces,o,"approve()");if(d)throw new Error(d.message);if(!Ct(c,!0)){const{message:g}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(g)}Ht(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async t=>{if(!Xt(t)){const{message:c}=Q("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!W3(o)){const{message:c}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!Xt(t)){const{message:d}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(d)}const{relay:s,controller:o,namespaces:c,expiry:h}=t;if(!Hd(s)){const{message:d}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(d)}const f=M3(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const p=Go(c,"onSessionSettleRequest()");if(p)throw new Error(p.message);if(wi(h)){const{message:d}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(d)}},this.isValidUpdate=async t=>{if(!Xt(t)){const{message:p}=Q("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(p)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),h=Go(o,"update()");if(h)throw new Error(h.message);const f=tp(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!Xt(t)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!Xt(t)){const{message:p}=Q("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(p)}const{topic:s,request:o,chainId:c,expiry:h}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!ep(f,c)){const{message:p}=Q("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(p)}if(!Y3(o)){const{message:p}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(p)}if(!X3(f,c,o.method)){const{message:p}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(p)}if(h&&!r2(h,_u)){const{message:p}=Q("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${_u.min} and ${_u.max}`);throw new Error(p)}},this.isValidRespond=async t=>{if(!Xt(t)){const{message:c}=Q("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!J3(o)){const{message:c}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!Xt(t)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!Xt(t)){const{message:f}=Q("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:h}=this.client.session.get(s);if(!ep(h,c)){const{message:f}=Q("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!Z3(o)){const{message:f}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!Q3(h,c,o.name)){const{message:f}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!Xt(t)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===s.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Ct(o,!1)){const{message:c}=Q("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:e}=Q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(ft.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);ih(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ms(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(vr.expired,async e=>{const{topic:t,id:s}=zd(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,Q("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Ct(e,!1)){const{message:t}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(wi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=Q("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Ct(e,!1)){const{message:t}=Q("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(wi(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=Q("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ct(e,!1)){const{message:t}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!G3(e)){const{message:t}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(wi(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=Q("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class AA extends _a{constructor(e,t){super(e,t,gA,Oh),this.core=e,this.logger=t}}class OA extends _a{constructor(e,t){super(e,t,yA,Oh),this.core=e,this.logger=t}}class xA extends _a{constructor(e,t){super(e,t,mA,Oh,s=>s.id),this.core=e,this.logger=t}}let CA=class Hg extends qD{constructor(e){super(e),this.protocol=Mg,this.version=Lg,this.name=wu.name,this.events=new wr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||wu.name,this.metadata=(e==null?void 0:e.metadata)||h3();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:va(ma({level:(e==null?void 0:e.logger)||wu.logger}));this.core=(e==null?void 0:e.core)||new pA(e),this.logger=or(t,this.name),this.session=new OA(this.core,this.logger),this.proposal=new AA(this.core,this.logger),this.pendingRequest=new xA(this.core,this.logger),this.engine=new SA(this)}static async init(e){const t=new Hg(e);return await t.initialize(),t}get context(){return Qt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};class Yi extends dd{constructor(e){super(e),this.events=new wr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(vs(e.method,e.params||[],e.id||oa().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Cr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ms(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const rd="error",FA="wss://relay.walletconnect.com",PA="wc",$A="universal_provider",id=`${PA}@2:${$A}:`,NA="https://rpc.walletconnect.com/v1",Ii={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ju={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(r,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",f="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",d=500,g="__lodash_placeholder__",b=1,E=2,I=4,S=1,R=2,B=1,H=2,P=4,O=8,D=16,x=32,C=64,l=128,w=256,K=512,Z=30,ae="...",ue=800,pe=16,de=1,Y=2,M=3,j=1/0,G=9007199254740991,ne=17976931348623157e292,se=0/0,ie=4294967295,ge=ie-1,W=ie>>>1,re=[["ary",l],["bind",B],["bindKey",H],["curry",O],["curryRight",D],["flip",K],["partial",x],["partialRight",C],["rearg",w]],J="[object Arguments]",le="[object Array]",be="[object AsyncFunction]",he="[object Boolean]",ye="[object Date]",Ie="[object DOMException]",De="[object Error]",Ce="[object Function]",Ue="[object GeneratorFunction]",Xe="[object Map]",Rt="[object Number]",_r="[object Null]",St="[object Object]",Nr="[object Promise]",Vr="[object Proxy]",Ke="[object RegExp]",Re="[object Set]",Ve="[object String]",Ze="[object Symbol]",nt="[object Undefined]",ke="[object WeakMap]",st="[object WeakSet]",Le="[object ArrayBuffer]",ze="[object DataView]",Qe="[object Float32Array]",je="[object Float64Array]",ot="[object Int8Array]",at="[object Int16Array]",ht="[object Int32Array]",ct="[object Uint8Array]",et="[object Uint8ClampedArray]",Ji="[object Uint16Array]",Zi="[object Uint32Array]",Ea=/\b__p \+= '';/g,kr=/\b(__p \+=) '' \+/g,As=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Os=/&(?:amp|lt|gt|quot|#39);/g,xs=/[&<>"']/g,Cn=RegExp(Os.source),Si=RegExp(xs.source),Fn=/<%-([\s\S]+?)%>/g,Pn=/<%([\s\S]+?)%>/g,Xi=/<%=([\s\S]+?)%>/g,Ai=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Da=/^\w*$/,Ia=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$n=/[\\^$.*+?()[\]{}|]/g,Sa=RegExp($n.source),Nn=/^\s+/,Cs=/\s/,Tn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Gr=/\{\n\/\* \[wrapped with (.+)\] \*/,Aa=/,? & /,Oa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xa=/[()=,{}\[\]\/\s]/,Ca=/\\(\\)?/g,Fa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ar=/\w*$/,Pa=/^[-+]0x[0-9a-f]+$/i,$a=/^0b[01]+$/i,Na=/^\[object .+?Constructor\]$/,Ta=/^0o[0-7]+$/i,Ra=/^(?:0|[1-9]\d*)$/,Wr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qi=/($^)/,Ua=/['\n\r\u2028\u2029\\]/g,en="\\ud800-\\udfff",ja="\\u0300-\\u036f",Ba="\\ufe20-\\ufe2f",tn="\\u20d0-\\u20ff",Fs=ja+Ba+tn,Ps="\\u2700-\\u27bf",Er="a-z\\xdf-\\xf6\\xf8-\\xff",Ma="\\xac\\xb1\\xd7\\xf7",La="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",za="\\u2000-\\u206f",qa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$s="A-Z\\xc0-\\xd6\\xd8-\\xde",Ns="\\ufe0e\\ufe0f",Oi=Ma+La+za+qa,Rn="['’]",xi="["+en+"]",Un="["+Oi+"]",Ci="["+Fs+"]",Ts="\\d+",Ha="["+Ps+"]",Rs="["+Er+"]",Us="[^"+en+Oi+Ts+Ps+Er+$s+"]",rn="\\ud83c[\\udffb-\\udfff]",Ka="(?:"+Ci+"|"+rn+")",js="[^"+en+"]",nn="(?:\\ud83c[\\udde6-\\uddff]){2}",ai="[\\ud800-\\udbff][\\udc00-\\udfff]",er="["+$s+"]",Bs="\\u200d",Ms="(?:"+Rs+"|"+Us+")",Tr="(?:"+er+"|"+Us+")",Ls="(?:"+Rn+"(?:d|ll|m|re|s|t|ve))?",zs="(?:"+Rn+"(?:D|LL|M|RE|S|T|VE))?",qs=Ka+"?",Hs="["+Ns+"]?",Va="(?:"+Bs+"(?:"+[js,nn,ai].join("|")+")"+Hs+qs+")*",Yr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ks="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Vs=Hs+qs+Va,sn="(?:"+[Ha,nn,ai].join("|")+")"+Vs,ka="(?:"+[js+Ci+"?",Ci,nn,ai,xi].join("|")+")",jn=RegExp(Rn,"g"),Ga=RegExp(Ci,"g"),on=RegExp(rn+"(?="+rn+")|"+ka+Vs,"g"),ks=RegExp([er+"?"+Rs+"+"+Ls+"(?="+[Un,er,"$"].join("|")+")",Tr+"+"+zs+"(?="+[Un,er+Ms,"$"].join("|")+")",er+"?"+Ms+"+"+Ls,er+"+"+zs,Ks,Yr,Ts,sn].join("|"),"g"),Gs=RegExp("["+Bs+en+Fs+Ns+"]"),Fi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ws=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wa=-1,Ge={};Ge[Qe]=Ge[je]=Ge[ot]=Ge[at]=Ge[ht]=Ge[ct]=Ge[et]=Ge[Ji]=Ge[Zi]=!0,Ge[J]=Ge[le]=Ge[Le]=Ge[he]=Ge[ze]=Ge[ye]=Ge[De]=Ge[Ce]=Ge[Xe]=Ge[Rt]=Ge[St]=Ge[Ke]=Ge[Re]=Ge[Ve]=Ge[ke]=!1;var He={};He[J]=He[le]=He[Le]=He[ze]=He[he]=He[ye]=He[Qe]=He[je]=He[ot]=He[at]=He[ht]=He[Xe]=He[Rt]=He[St]=He[Ke]=He[Re]=He[Ve]=He[Ze]=He[ct]=He[et]=He[Ji]=He[Zi]=!0,He[De]=He[Ce]=He[ke]=!1;var _={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},V={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ee={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,_e=parseInt,tt=typeof us=="object"&&us&&us.Object===Object&&us,bt=typeof self=="object"&&self&&self.Object===Object&&self,Ne=tt||bt||Function("return this")(),Ye=e&&!e.nodeType&&e,pt=Ye&&!0&&r&&!r.nodeType&&r,Vt=pt&&pt.exports===Ye,wt=Vt&&tt.process,rt=function(){try{var N=pt&&pt.require&&pt.require("util").types;return N||wt&&wt.binding&&wt.binding("util")}catch{}}(),Mt=rt&&rt.isArrayBuffer,Dr=rt&&rt.isDate,cr=rt&&rt.isMap,Rr=rt&&rt.isRegExp,Bn=rt&&rt.isSet,Pi=rt&&rt.isTypedArray;function At(N,L,U){switch(U.length){case 0:return N.call(L);case 1:return N.call(L,U[0]);case 2:return N.call(L,U[0],U[1]);case 3:return N.call(L,U[0],U[1],U[2])}return N.apply(L,U)}function kg(N,L,U,te){for(var we=-1,Be=N==null?0:N.length;++we<Be;){var Et=N[we];L(te,Et,U(Et),N)}return te}function ur(N,L){for(var U=-1,te=N==null?0:N.length;++U<te&&L(N[U],U,N)!==!1;);return N}function Gg(N,L){for(var U=N==null?0:N.length;U--&&L(N[U],U,N)!==!1;);return N}function Fh(N,L){for(var U=-1,te=N==null?0:N.length;++U<te;)if(!L(N[U],U,N))return!1;return!0}function ci(N,L){for(var U=-1,te=N==null?0:N.length,we=0,Be=[];++U<te;){var Et=N[U];L(Et,U,N)&&(Be[we++]=Et)}return Be}function Ys(N,L){var U=N==null?0:N.length;return!!U&&an(N,L,0)>-1}function Ya(N,L,U){for(var te=-1,we=N==null?0:N.length;++te<we;)if(U(L,N[te]))return!0;return!1}function it(N,L){for(var U=-1,te=N==null?0:N.length,we=Array(te);++U<te;)we[U]=L(N[U],U,N);return we}function ui(N,L){for(var U=-1,te=L.length,we=N.length;++U<te;)N[we+U]=L[U];return N}function Ja(N,L,U,te){var we=-1,Be=N==null?0:N.length;for(te&&Be&&(U=N[++we]);++we<Be;)U=L(U,N[we],we,N);return U}function Wg(N,L,U,te){var we=N==null?0:N.length;for(te&&we&&(U=N[--we]);we--;)U=L(U,N[we],we,N);return U}function Za(N,L){for(var U=-1,te=N==null?0:N.length;++U<te;)if(L(N[U],U,N))return!0;return!1}var Yg=Xa("length");function Jg(N){return N.split("")}function Zg(N){return N.match(Oa)||[]}function Ph(N,L,U){var te;return U(N,function(we,Be,Et){if(L(we,Be,Et))return te=Be,!1}),te}function Js(N,L,U,te){for(var we=N.length,Be=U+(te?1:-1);te?Be--:++Be<we;)if(L(N[Be],Be,N))return Be;return-1}function an(N,L,U){return L===L?u0(N,L,U):Js(N,$h,U)}function Xg(N,L,U,te){for(var we=U-1,Be=N.length;++we<Be;)if(te(N[we],L))return we;return-1}function $h(N){return N!==N}function Nh(N,L){var U=N==null?0:N.length;return U?ec(N,L)/U:se}function Xa(N){return function(L){return L==null?t:L[N]}}function Qa(N){return function(L){return N==null?t:N[L]}}function Th(N,L,U,te,we){return we(N,function(Be,Et,Je){U=te?(te=!1,Be):L(U,Be,Et,Je)}),U}function Qg(N,L){var U=N.length;for(N.sort(L);U--;)N[U]=N[U].value;return N}function ec(N,L){for(var U,te=-1,we=N.length;++te<we;){var Be=L(N[te]);Be!==t&&(U=U===t?Be:U+Be)}return U}function tc(N,L){for(var U=-1,te=Array(N);++U<N;)te[U]=L(U);return te}function e0(N,L){return it(L,function(U){return[U,N[U]]})}function Rh(N){return N&&N.slice(0,Mh(N)+1).replace(Nn,"")}function tr(N){return function(L){return N(L)}}function rc(N,L){return it(L,function(U){return N[U]})}function Mn(N,L){return N.has(L)}function Uh(N,L){for(var U=-1,te=N.length;++U<te&&an(L,N[U],0)>-1;);return U}function jh(N,L){for(var U=N.length;U--&&an(L,N[U],0)>-1;);return U}function t0(N,L){for(var U=N.length,te=0;U--;)N[U]===L&&++te;return te}var r0=Qa(_),i0=Qa($);function n0(N){return"\\"+ee[N]}function s0(N,L){return N==null?t:N[L]}function cn(N){return Gs.test(N)}function o0(N){return Fi.test(N)}function a0(N){for(var L,U=[];!(L=N.next()).done;)U.push(L.value);return U}function ic(N){var L=-1,U=Array(N.size);return N.forEach(function(te,we){U[++L]=[we,te]}),U}function Bh(N,L){return function(U){return N(L(U))}}function hi(N,L){for(var U=-1,te=N.length,we=0,Be=[];++U<te;){var Et=N[U];(Et===L||Et===g)&&(N[U]=g,Be[we++]=U)}return Be}function Zs(N){var L=-1,U=Array(N.size);return N.forEach(function(te){U[++L]=te}),U}function c0(N){var L=-1,U=Array(N.size);return N.forEach(function(te){U[++L]=[te,te]}),U}function u0(N,L,U){for(var te=U-1,we=N.length;++te<we;)if(N[te]===L)return te;return-1}function h0(N,L,U){for(var te=U+1;te--;)if(N[te]===L)return te;return te}function un(N){return cn(N)?f0(N):Yg(N)}function Ir(N){return cn(N)?p0(N):Jg(N)}function Mh(N){for(var L=N.length;L--&&Cs.test(N.charAt(L)););return L}var l0=Qa(V);function f0(N){for(var L=on.lastIndex=0;on.test(N);)++L;return L}function p0(N){return N.match(on)||[]}function d0(N){return N.match(ks)||[]}var g0=function N(L){L=L==null?Ne:hn.defaults(Ne.Object(),L,hn.pick(Ne,Ws));var U=L.Array,te=L.Date,we=L.Error,Be=L.Function,Et=L.Math,Je=L.Object,nc=L.RegExp,y0=L.String,hr=L.TypeError,Xs=U.prototype,v0=Be.prototype,ln=Je.prototype,Qs=L["__core-js_shared__"],eo=v0.toString,qe=ln.hasOwnProperty,m0=0,Lh=function(){var i=/[^.]+$/.exec(Qs&&Qs.keys&&Qs.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),to=ln.toString,b0=eo.call(Je),w0=Ne._,_0=nc("^"+eo.call(qe).replace($n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ro=Vt?L.Buffer:t,li=L.Symbol,io=L.Uint8Array,zh=ro?ro.allocUnsafe:t,no=Bh(Je.getPrototypeOf,Je),qh=Je.create,Hh=ln.propertyIsEnumerable,so=Xs.splice,Kh=li?li.isConcatSpreadable:t,Ln=li?li.iterator:t,$i=li?li.toStringTag:t,oo=function(){try{var i=ji(Je,"defineProperty");return i({},"",{}),i}catch{}}(),E0=L.clearTimeout!==Ne.clearTimeout&&L.clearTimeout,D0=te&&te.now!==Ne.Date.now&&te.now,I0=L.setTimeout!==Ne.setTimeout&&L.setTimeout,ao=Et.ceil,co=Et.floor,sc=Je.getOwnPropertySymbols,S0=ro?ro.isBuffer:t,Vh=L.isFinite,A0=Xs.join,O0=Bh(Je.keys,Je),Dt=Et.max,Ut=Et.min,x0=te.now,C0=L.parseInt,kh=Et.random,F0=Xs.reverse,oc=ji(L,"DataView"),zn=ji(L,"Map"),ac=ji(L,"Promise"),fn=ji(L,"Set"),qn=ji(L,"WeakMap"),Hn=ji(Je,"create"),uo=qn&&new qn,pn={},P0=Bi(oc),$0=Bi(zn),N0=Bi(ac),T0=Bi(fn),R0=Bi(qn),ho=li?li.prototype:t,Kn=ho?ho.valueOf:t,Gh=ho?ho.toString:t;function v(i){if(lt(i)&&!Ee(i)&&!(i instanceof $e)){if(i instanceof lr)return i;if(qe.call(i,"__wrapped__"))return Wl(i)}return new lr(i)}var dn=function(){function i(){}return function(n){if(!ut(n))return{};if(qh)return qh(n);i.prototype=n;var a=new i;return i.prototype=t,a}}();function lo(){}function lr(i,n){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}v.templateSettings={escape:Fn,evaluate:Pn,interpolate:Xi,variable:"",imports:{_:v}},v.prototype=lo.prototype,v.prototype.constructor=v,lr.prototype=dn(lo.prototype),lr.prototype.constructor=lr;function $e(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function U0(){var i=new $e(this.__wrapped__);return i.__actions__=kt(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=kt(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=kt(this.__views__),i}function j0(){if(this.__filtered__){var i=new $e(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function B0(){var i=this.__wrapped__.value(),n=this.__dir__,a=Ee(i),u=n<0,y=a?i.length:0,m=J1(0,y,this.__views__),A=m.start,F=m.end,T=F-A,z=u?F:A-1,q=this.__iteratees__,k=q.length,X=0,oe=Ut(T,this.__takeCount__);if(!a||!u&&y==T&&oe==T)return vl(i,this.__actions__);var ve=[];e:for(;T--&&X<oe;){z+=n;for(var Oe=-1,me=i[z];++Oe<k;){var Pe=q[Oe],Te=Pe.iteratee,nr=Pe.type,qt=Te(me);if(nr==Y)me=qt;else if(!qt){if(nr==de)continue e;break e}}ve[X++]=me}return ve}$e.prototype=dn(lo.prototype),$e.prototype.constructor=$e;function Ni(i){var n=-1,a=i==null?0:i.length;for(this.clear();++n<a;){var u=i[n];this.set(u[0],u[1])}}function M0(){this.__data__=Hn?Hn(null):{},this.size=0}function L0(i){var n=this.has(i)&&delete this.__data__[i];return this.size-=n?1:0,n}function z0(i){var n=this.__data__;if(Hn){var a=n[i];return a===p?t:a}return qe.call(n,i)?n[i]:t}function q0(i){var n=this.__data__;return Hn?n[i]!==t:qe.call(n,i)}function H0(i,n){var a=this.__data__;return this.size+=this.has(i)?0:1,a[i]=Hn&&n===t?p:n,this}Ni.prototype.clear=M0,Ni.prototype.delete=L0,Ni.prototype.get=z0,Ni.prototype.has=q0,Ni.prototype.set=H0;function Jr(i){var n=-1,a=i==null?0:i.length;for(this.clear();++n<a;){var u=i[n];this.set(u[0],u[1])}}function K0(){this.__data__=[],this.size=0}function V0(i){var n=this.__data__,a=fo(n,i);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():so.call(n,a,1),--this.size,!0}function k0(i){var n=this.__data__,a=fo(n,i);return a<0?t:n[a][1]}function G0(i){return fo(this.__data__,i)>-1}function W0(i,n){var a=this.__data__,u=fo(a,i);return u<0?(++this.size,a.push([i,n])):a[u][1]=n,this}Jr.prototype.clear=K0,Jr.prototype.delete=V0,Jr.prototype.get=k0,Jr.prototype.has=G0,Jr.prototype.set=W0;function Zr(i){var n=-1,a=i==null?0:i.length;for(this.clear();++n<a;){var u=i[n];this.set(u[0],u[1])}}function Y0(){this.size=0,this.__data__={hash:new Ni,map:new(zn||Jr),string:new Ni}}function J0(i){var n=So(this,i).delete(i);return this.size-=n?1:0,n}function Z0(i){return So(this,i).get(i)}function X0(i){return So(this,i).has(i)}function Q0(i,n){var a=So(this,i),u=a.size;return a.set(i,n),this.size+=a.size==u?0:1,this}Zr.prototype.clear=Y0,Zr.prototype.delete=J0,Zr.prototype.get=Z0,Zr.prototype.has=X0,Zr.prototype.set=Q0;function Ti(i){var n=-1,a=i==null?0:i.length;for(this.__data__=new Zr;++n<a;)this.add(i[n])}function e1(i){return this.__data__.set(i,p),this}function t1(i){return this.__data__.has(i)}Ti.prototype.add=Ti.prototype.push=e1,Ti.prototype.has=t1;function Sr(i){var n=this.__data__=new Jr(i);this.size=n.size}function r1(){this.__data__=new Jr,this.size=0}function i1(i){var n=this.__data__,a=n.delete(i);return this.size=n.size,a}function n1(i){return this.__data__.get(i)}function s1(i){return this.__data__.has(i)}function o1(i,n){var a=this.__data__;if(a instanceof Jr){var u=a.__data__;if(!zn||u.length<o-1)return u.push([i,n]),this.size=++a.size,this;a=this.__data__=new Zr(u)}return a.set(i,n),this.size=a.size,this}Sr.prototype.clear=r1,Sr.prototype.delete=i1,Sr.prototype.get=n1,Sr.prototype.has=s1,Sr.prototype.set=o1;function Wh(i,n){var a=Ee(i),u=!a&&Mi(i),y=!a&&!u&&yi(i),m=!a&&!u&&!y&&mn(i),A=a||u||y||m,F=A?tc(i.length,y0):[],T=F.length;for(var z in i)(n||qe.call(i,z))&&!(A&&(z=="length"||y&&(z=="offset"||z=="parent")||m&&(z=="buffer"||z=="byteLength"||z=="byteOffset")||ti(z,T)))&&F.push(z);return F}function Yh(i){var n=i.length;return n?i[mc(0,n-1)]:t}function a1(i,n){return Ao(kt(i),Ri(n,0,i.length))}function c1(i){return Ao(kt(i))}function cc(i,n,a){(a!==t&&!Ar(i[n],a)||a===t&&!(n in i))&&Xr(i,n,a)}function Vn(i,n,a){var u=i[n];(!(qe.call(i,n)&&Ar(u,a))||a===t&&!(n in i))&&Xr(i,n,a)}function fo(i,n){for(var a=i.length;a--;)if(Ar(i[a][0],n))return a;return-1}function u1(i,n,a,u){return fi(i,function(y,m,A){n(u,y,a(y),A)}),u}function Jh(i,n){return i&&jr(n,Ot(n),i)}function h1(i,n){return i&&jr(n,Wt(n),i)}function Xr(i,n,a){n=="__proto__"&&oo?oo(i,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):i[n]=a}function uc(i,n){for(var a=-1,u=n.length,y=U(u),m=i==null;++a<u;)y[a]=m?t:Hc(i,n[a]);return y}function Ri(i,n,a){return i===i&&(a!==t&&(i=i<=a?i:a),n!==t&&(i=i>=n?i:n)),i}function fr(i,n,a,u,y,m){var A,F=n&b,T=n&E,z=n&I;if(a&&(A=y?a(i,u,y,m):a(i)),A!==t)return A;if(!ut(i))return i;var q=Ee(i);if(q){if(A=X1(i),!F)return kt(i,A)}else{var k=jt(i),X=k==Ce||k==Ue;if(yi(i))return wl(i,F);if(k==St||k==J||X&&!y){if(A=T||X?{}:Ml(i),!F)return T?z1(i,h1(A,i)):L1(i,Jh(A,i))}else{if(!He[k])return y?i:{};A=Q1(i,k,F)}}m||(m=new Sr);var oe=m.get(i);if(oe)return oe;m.set(i,A),gf(i)?i.forEach(function(me){A.add(fr(me,n,a,me,i,m))}):pf(i)&&i.forEach(function(me,Pe){A.set(Pe,fr(me,n,a,Pe,i,m))});var ve=z?T?Cc:xc:T?Wt:Ot,Oe=q?t:ve(i);return ur(Oe||i,function(me,Pe){Oe&&(Pe=me,me=i[Pe]),Vn(A,Pe,fr(me,n,a,Pe,i,m))}),A}function l1(i){var n=Ot(i);return function(a){return Zh(a,i,n)}}function Zh(i,n,a){var u=a.length;if(i==null)return!u;for(i=Je(i);u--;){var y=a[u],m=n[y],A=i[y];if(A===t&&!(y in i)||!m(A))return!1}return!0}function Xh(i,n,a){if(typeof i!="function")throw new hr(h);return Xn(function(){i.apply(t,a)},n)}function kn(i,n,a,u){var y=-1,m=Ys,A=!0,F=i.length,T=[],z=n.length;if(!F)return T;a&&(n=it(n,tr(a))),u?(m=Ya,A=!1):n.length>=o&&(m=Mn,A=!1,n=new Ti(n));e:for(;++y<F;){var q=i[y],k=a==null?q:a(q);if(q=u||q!==0?q:0,A&&k===k){for(var X=z;X--;)if(n[X]===k)continue e;T.push(q)}else m(n,k,u)||T.push(q)}return T}var fi=Sl(Ur),Qh=Sl(lc,!0);function f1(i,n){var a=!0;return fi(i,function(u,y,m){return a=!!n(u,y,m),a}),a}function po(i,n,a){for(var u=-1,y=i.length;++u<y;){var m=i[u],A=n(m);if(A!=null&&(F===t?A===A&&!ir(A):a(A,F)))var F=A,T=m}return T}function p1(i,n,a,u){var y=i.length;for(a=Se(a),a<0&&(a=-a>y?0:y+a),u=u===t||u>y?y:Se(u),u<0&&(u+=y),u=a>u?0:vf(u);a<u;)i[a++]=n;return i}function el(i,n){var a=[];return fi(i,function(u,y,m){n(u,y,m)&&a.push(u)}),a}function Pt(i,n,a,u,y){var m=-1,A=i.length;for(a||(a=ty),y||(y=[]);++m<A;){var F=i[m];n>0&&a(F)?n>1?Pt(F,n-1,a,u,y):ui(y,F):u||(y[y.length]=F)}return y}var hc=Al(),tl=Al(!0);function Ur(i,n){return i&&hc(i,n,Ot)}function lc(i,n){return i&&tl(i,n,Ot)}function go(i,n){return ci(n,function(a){return ri(i[a])})}function Ui(i,n){n=di(n,i);for(var a=0,u=n.length;i!=null&&a<u;)i=i[Br(n[a++])];return a&&a==u?i:t}function rl(i,n,a){var u=n(i);return Ee(i)?u:ui(u,a(i))}function Lt(i){return i==null?i===t?nt:_r:$i&&$i in Je(i)?Y1(i):cy(i)}function fc(i,n){return i>n}function d1(i,n){return i!=null&&qe.call(i,n)}function g1(i,n){return i!=null&&n in Je(i)}function y1(i,n,a){return i>=Ut(n,a)&&i<Dt(n,a)}function pc(i,n,a){for(var u=a?Ya:Ys,y=i[0].length,m=i.length,A=m,F=U(m),T=1/0,z=[];A--;){var q=i[A];A&&n&&(q=it(q,tr(n))),T=Ut(q.length,T),F[A]=!a&&(n||y>=120&&q.length>=120)?new Ti(A&&q):t}q=i[0];var k=-1,X=F[0];e:for(;++k<y&&z.length<T;){var oe=q[k],ve=n?n(oe):oe;if(oe=a||oe!==0?oe:0,!(X?Mn(X,ve):u(z,ve,a))){for(A=m;--A;){var Oe=F[A];if(!(Oe?Mn(Oe,ve):u(i[A],ve,a)))continue e}X&&X.push(ve),z.push(oe)}}return z}function v1(i,n,a,u){return Ur(i,function(y,m,A){n(u,a(y),m,A)}),u}function Gn(i,n,a){n=di(n,i),i=Hl(i,n);var u=i==null?i:i[Br(dr(n))];return u==null?t:At(u,i,a)}function il(i){return lt(i)&&Lt(i)==J}function m1(i){return lt(i)&&Lt(i)==Le}function b1(i){return lt(i)&&Lt(i)==ye}function Wn(i,n,a,u,y){return i===n?!0:i==null||n==null||!lt(i)&&!lt(n)?i!==i&&n!==n:w1(i,n,a,u,Wn,y)}function w1(i,n,a,u,y,m){var A=Ee(i),F=Ee(n),T=A?le:jt(i),z=F?le:jt(n);T=T==J?St:T,z=z==J?St:z;var q=T==St,k=z==St,X=T==z;if(X&&yi(i)){if(!yi(n))return!1;A=!0,q=!1}if(X&&!q)return m||(m=new Sr),A||mn(i)?Ul(i,n,a,u,y,m):G1(i,n,T,a,u,y,m);if(!(a&S)){var oe=q&&qe.call(i,"__wrapped__"),ve=k&&qe.call(n,"__wrapped__");if(oe||ve){var Oe=oe?i.value():i,me=ve?n.value():n;return m||(m=new Sr),y(Oe,me,a,u,m)}}return X?(m||(m=new Sr),W1(i,n,a,u,y,m)):!1}function _1(i){return lt(i)&&jt(i)==Xe}function dc(i,n,a,u){var y=a.length,m=y,A=!u;if(i==null)return!m;for(i=Je(i);y--;){var F=a[y];if(A&&F[2]?F[1]!==i[F[0]]:!(F[0]in i))return!1}for(;++y<m;){F=a[y];var T=F[0],z=i[T],q=F[1];if(A&&F[2]){if(z===t&&!(T in i))return!1}else{var k=new Sr;if(u)var X=u(z,q,T,i,n,k);if(!(X===t?Wn(q,z,S|R,u,k):X))return!1}}return!0}function nl(i){if(!ut(i)||iy(i))return!1;var n=ri(i)?_0:Na;return n.test(Bi(i))}function E1(i){return lt(i)&&Lt(i)==Ke}function D1(i){return lt(i)&&jt(i)==Re}function I1(i){return lt(i)&&$o(i.length)&&!!Ge[Lt(i)]}function sl(i){return typeof i=="function"?i:i==null?Yt:typeof i=="object"?Ee(i)?cl(i[0],i[1]):al(i):xf(i)}function gc(i){if(!Zn(i))return O0(i);var n=[];for(var a in Je(i))qe.call(i,a)&&a!="constructor"&&n.push(a);return n}function S1(i){if(!ut(i))return ay(i);var n=Zn(i),a=[];for(var u in i)u=="constructor"&&(n||!qe.call(i,u))||a.push(u);return a}function yc(i,n){return i<n}function ol(i,n){var a=-1,u=Gt(i)?U(i.length):[];return fi(i,function(y,m,A){u[++a]=n(y,m,A)}),u}function al(i){var n=Pc(i);return n.length==1&&n[0][2]?zl(n[0][0],n[0][1]):function(a){return a===i||dc(a,i,n)}}function cl(i,n){return Nc(i)&&Ll(n)?zl(Br(i),n):function(a){var u=Hc(a,i);return u===t&&u===n?Kc(a,i):Wn(n,u,S|R)}}function yo(i,n,a,u,y){i!==n&&hc(n,function(m,A){if(y||(y=new Sr),ut(m))A1(i,n,A,a,yo,u,y);else{var F=u?u(Rc(i,A),m,A+"",i,n,y):t;F===t&&(F=m),cc(i,A,F)}},Wt)}function A1(i,n,a,u,y,m,A){var F=Rc(i,a),T=Rc(n,a),z=A.get(T);if(z){cc(i,a,z);return}var q=m?m(F,T,a+"",i,n,A):t,k=q===t;if(k){var X=Ee(T),oe=!X&&yi(T),ve=!X&&!oe&&mn(T);q=T,X||oe||ve?Ee(F)?q=F:dt(F)?q=kt(F):oe?(k=!1,q=wl(T,!0)):ve?(k=!1,q=_l(T,!0)):q=[]:Qn(T)||Mi(T)?(q=F,Mi(F)?q=mf(F):(!ut(F)||ri(F))&&(q=Ml(T))):k=!1}k&&(A.set(T,q),y(q,T,u,m,A),A.delete(T)),cc(i,a,q)}function ul(i,n){var a=i.length;if(a)return n+=n<0?a:0,ti(n,a)?i[n]:t}function hl(i,n,a){n.length?n=it(n,function(m){return Ee(m)?function(A){return Ui(A,m.length===1?m[0]:m)}:m}):n=[Yt];var u=-1;n=it(n,tr(fe()));var y=ol(i,function(m,A,F){var T=it(n,function(z){return z(m)});return{criteria:T,index:++u,value:m}});return Qg(y,function(m,A){return M1(m,A,a)})}function O1(i,n){return ll(i,n,function(a,u){return Kc(i,u)})}function ll(i,n,a){for(var u=-1,y=n.length,m={};++u<y;){var A=n[u],F=Ui(i,A);a(F,A)&&Yn(m,di(A,i),F)}return m}function x1(i){return function(n){return Ui(n,i)}}function vc(i,n,a,u){var y=u?Xg:an,m=-1,A=n.length,F=i;for(i===n&&(n=kt(n)),a&&(F=it(i,tr(a)));++m<A;)for(var T=0,z=n[m],q=a?a(z):z;(T=y(F,q,T,u))>-1;)F!==i&&so.call(F,T,1),so.call(i,T,1);return i}function fl(i,n){for(var a=i?n.length:0,u=a-1;a--;){var y=n[a];if(a==u||y!==m){var m=y;ti(y)?so.call(i,y,1):_c(i,y)}}return i}function mc(i,n){return i+co(kh()*(n-i+1))}function C1(i,n,a,u){for(var y=-1,m=Dt(ao((n-i)/(a||1)),0),A=U(m);m--;)A[u?m:++y]=i,i+=a;return A}function bc(i,n){var a="";if(!i||n<1||n>G)return a;do n%2&&(a+=i),n=co(n/2),n&&(i+=i);while(n);return a}function Fe(i,n){return Uc(ql(i,n,Yt),i+"")}function F1(i){return Yh(bn(i))}function P1(i,n){var a=bn(i);return Ao(a,Ri(n,0,a.length))}function Yn(i,n,a,u){if(!ut(i))return i;n=di(n,i);for(var y=-1,m=n.length,A=m-1,F=i;F!=null&&++y<m;){var T=Br(n[y]),z=a;if(T==="__proto__"||T==="constructor"||T==="prototype")return i;if(y!=A){var q=F[T];z=u?u(q,T,F):t,z===t&&(z=ut(q)?q:ti(n[y+1])?[]:{})}Vn(F,T,z),F=F[T]}return i}var pl=uo?function(i,n){return uo.set(i,n),i}:Yt,$1=oo?function(i,n){return oo(i,"toString",{configurable:!0,enumerable:!1,value:kc(n),writable:!0})}:Yt;function N1(i){return Ao(bn(i))}function pr(i,n,a){var u=-1,y=i.length;n<0&&(n=-n>y?0:y+n),a=a>y?y:a,a<0&&(a+=y),y=n>a?0:a-n>>>0,n>>>=0;for(var m=U(y);++u<y;)m[u]=i[u+n];return m}function T1(i,n){var a;return fi(i,function(u,y,m){return a=n(u,y,m),!a}),!!a}function vo(i,n,a){var u=0,y=i==null?u:i.length;if(typeof n=="number"&&n===n&&y<=W){for(;u<y;){var m=u+y>>>1,A=i[m];A!==null&&!ir(A)&&(a?A<=n:A<n)?u=m+1:y=m}return y}return wc(i,n,Yt,a)}function wc(i,n,a,u){var y=0,m=i==null?0:i.length;if(m===0)return 0;n=a(n);for(var A=n!==n,F=n===null,T=ir(n),z=n===t;y<m;){var q=co((y+m)/2),k=a(i[q]),X=k!==t,oe=k===null,ve=k===k,Oe=ir(k);if(A)var me=u||ve;else z?me=ve&&(u||X):F?me=ve&&X&&(u||!oe):T?me=ve&&X&&!oe&&(u||!Oe):oe||Oe?me=!1:me=u?k<=n:k<n;me?y=q+1:m=q}return Ut(m,ge)}function dl(i,n){for(var a=-1,u=i.length,y=0,m=[];++a<u;){var A=i[a],F=n?n(A):A;if(!a||!Ar(F,T)){var T=F;m[y++]=A===0?0:A}}return m}function gl(i){return typeof i=="number"?i:ir(i)?se:+i}function rr(i){if(typeof i=="string")return i;if(Ee(i))return it(i,rr)+"";if(ir(i))return Gh?Gh.call(i):"";var n=i+"";return n=="0"&&1/i==-j?"-0":n}function pi(i,n,a){var u=-1,y=Ys,m=i.length,A=!0,F=[],T=F;if(a)A=!1,y=Ya;else if(m>=o){var z=n?null:V1(i);if(z)return Zs(z);A=!1,y=Mn,T=new Ti}else T=n?[]:F;e:for(;++u<m;){var q=i[u],k=n?n(q):q;if(q=a||q!==0?q:0,A&&k===k){for(var X=T.length;X--;)if(T[X]===k)continue e;n&&T.push(k),F.push(q)}else y(T,k,a)||(T!==F&&T.push(k),F.push(q))}return F}function _c(i,n){return n=di(n,i),i=Hl(i,n),i==null||delete i[Br(dr(n))]}function yl(i,n,a,u){return Yn(i,n,a(Ui(i,n)),u)}function mo(i,n,a,u){for(var y=i.length,m=u?y:-1;(u?m--:++m<y)&&n(i[m],m,i););return a?pr(i,u?0:m,u?m+1:y):pr(i,u?m+1:0,u?y:m)}function vl(i,n){var a=i;return a instanceof $e&&(a=a.value()),Ja(n,function(u,y){return y.func.apply(y.thisArg,ui([u],y.args))},a)}function Ec(i,n,a){var u=i.length;if(u<2)return u?pi(i[0]):[];for(var y=-1,m=U(u);++y<u;)for(var A=i[y],F=-1;++F<u;)F!=y&&(m[y]=kn(m[y]||A,i[F],n,a));return pi(Pt(m,1),n,a)}function ml(i,n,a){for(var u=-1,y=i.length,m=n.length,A={};++u<y;){var F=u<m?n[u]:t;a(A,i[u],F)}return A}function Dc(i){return dt(i)?i:[]}function Ic(i){return typeof i=="function"?i:Yt}function di(i,n){return Ee(i)?i:Nc(i,n)?[i]:Gl(Me(i))}var R1=Fe;function gi(i,n,a){var u=i.length;return a=a===t?u:a,!n&&a>=u?i:pr(i,n,a)}var bl=E0||function(i){return Ne.clearTimeout(i)};function wl(i,n){if(n)return i.slice();var a=i.length,u=zh?zh(a):new i.constructor(a);return i.copy(u),u}function Sc(i){var n=new i.constructor(i.byteLength);return new io(n).set(new io(i)),n}function U1(i,n){var a=n?Sc(i.buffer):i.buffer;return new i.constructor(a,i.byteOffset,i.byteLength)}function j1(i){var n=new i.constructor(i.source,ar.exec(i));return n.lastIndex=i.lastIndex,n}function B1(i){return Kn?Je(Kn.call(i)):{}}function _l(i,n){var a=n?Sc(i.buffer):i.buffer;return new i.constructor(a,i.byteOffset,i.length)}function El(i,n){if(i!==n){var a=i!==t,u=i===null,y=i===i,m=ir(i),A=n!==t,F=n===null,T=n===n,z=ir(n);if(!F&&!z&&!m&&i>n||m&&A&&T&&!F&&!z||u&&A&&T||!a&&T||!y)return 1;if(!u&&!m&&!z&&i<n||z&&a&&y&&!u&&!m||F&&a&&y||!A&&y||!T)return-1}return 0}function M1(i,n,a){for(var u=-1,y=i.criteria,m=n.criteria,A=y.length,F=a.length;++u<A;){var T=El(y[u],m[u]);if(T){if(u>=F)return T;var z=a[u];return T*(z=="desc"?-1:1)}}return i.index-n.index}function Dl(i,n,a,u){for(var y=-1,m=i.length,A=a.length,F=-1,T=n.length,z=Dt(m-A,0),q=U(T+z),k=!u;++F<T;)q[F]=n[F];for(;++y<A;)(k||y<m)&&(q[a[y]]=i[y]);for(;z--;)q[F++]=i[y++];return q}function Il(i,n,a,u){for(var y=-1,m=i.length,A=-1,F=a.length,T=-1,z=n.length,q=Dt(m-F,0),k=U(q+z),X=!u;++y<q;)k[y]=i[y];for(var oe=y;++T<z;)k[oe+T]=n[T];for(;++A<F;)(X||y<m)&&(k[oe+a[A]]=i[y++]);return k}function kt(i,n){var a=-1,u=i.length;for(n||(n=U(u));++a<u;)n[a]=i[a];return n}function jr(i,n,a,u){var y=!a;a||(a={});for(var m=-1,A=n.length;++m<A;){var F=n[m],T=u?u(a[F],i[F],F,a,i):t;T===t&&(T=i[F]),y?Xr(a,F,T):Vn(a,F,T)}return a}function L1(i,n){return jr(i,$c(i),n)}function z1(i,n){return jr(i,jl(i),n)}function bo(i,n){return function(a,u){var y=Ee(a)?kg:u1,m=n?n():{};return y(a,i,fe(u,2),m)}}function gn(i){return Fe(function(n,a){var u=-1,y=a.length,m=y>1?a[y-1]:t,A=y>2?a[2]:t;for(m=i.length>3&&typeof m=="function"?(y--,m):t,A&&zt(a[0],a[1],A)&&(m=y<3?t:m,y=1),n=Je(n);++u<y;){var F=a[u];F&&i(n,F,u,m)}return n})}function Sl(i,n){return function(a,u){if(a==null)return a;if(!Gt(a))return i(a,u);for(var y=a.length,m=n?y:-1,A=Je(a);(n?m--:++m<y)&&u(A[m],m,A)!==!1;);return a}}function Al(i){return function(n,a,u){for(var y=-1,m=Je(n),A=u(n),F=A.length;F--;){var T=A[i?F:++y];if(a(m[T],T,m)===!1)break}return n}}function q1(i,n,a){var u=n&B,y=Jn(i);function m(){var A=this&&this!==Ne&&this instanceof m?y:i;return A.apply(u?a:this,arguments)}return m}function Ol(i){return function(n){n=Me(n);var a=cn(n)?Ir(n):t,u=a?a[0]:n.charAt(0),y=a?gi(a,1).join(""):n.slice(1);return u[i]()+y}}function yn(i){return function(n){return Ja(Af(Sf(n).replace(jn,"")),i,"")}}function Jn(i){return function(){var n=arguments;switch(n.length){case 0:return new i;case 1:return new i(n[0]);case 2:return new i(n[0],n[1]);case 3:return new i(n[0],n[1],n[2]);case 4:return new i(n[0],n[1],n[2],n[3]);case 5:return new i(n[0],n[1],n[2],n[3],n[4]);case 6:return new i(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new i(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=dn(i.prototype),u=i.apply(a,n);return ut(u)?u:a}}function H1(i,n,a){var u=Jn(i);function y(){for(var m=arguments.length,A=U(m),F=m,T=vn(y);F--;)A[F]=arguments[F];var z=m<3&&A[0]!==T&&A[m-1]!==T?[]:hi(A,T);if(m-=z.length,m<a)return $l(i,n,wo,y.placeholder,t,A,z,t,t,a-m);var q=this&&this!==Ne&&this instanceof y?u:i;return At(q,this,A)}return y}function xl(i){return function(n,a,u){var y=Je(n);if(!Gt(n)){var m=fe(a,3);n=Ot(n),a=function(F){return m(y[F],F,y)}}var A=i(n,a,u);return A>-1?y[m?n[A]:A]:t}}function Cl(i){return ei(function(n){var a=n.length,u=a,y=lr.prototype.thru;for(i&&n.reverse();u--;){var m=n[u];if(typeof m!="function")throw new hr(h);if(y&&!A&&Io(m)=="wrapper")var A=new lr([],!0)}for(u=A?u:a;++u<a;){m=n[u];var F=Io(m),T=F=="wrapper"?Fc(m):t;T&&Tc(T[0])&&T[1]==(l|O|x|w)&&!T[4].length&&T[9]==1?A=A[Io(T[0])].apply(A,T[3]):A=m.length==1&&Tc(m)?A[F]():A.thru(m)}return function(){var z=arguments,q=z[0];if(A&&z.length==1&&Ee(q))return A.plant(q).value();for(var k=0,X=a?n[k].apply(this,z):q;++k<a;)X=n[k].call(this,X);return X}})}function wo(i,n,a,u,y,m,A,F,T,z){var q=n&l,k=n&B,X=n&H,oe=n&(O|D),ve=n&K,Oe=X?t:Jn(i);function me(){for(var Pe=arguments.length,Te=U(Pe),nr=Pe;nr--;)Te[nr]=arguments[nr];if(oe)var qt=vn(me),sr=t0(Te,qt);if(u&&(Te=Dl(Te,u,y,oe)),m&&(Te=Il(Te,m,A,oe)),Pe-=sr,oe&&Pe<z){var gt=hi(Te,qt);return $l(i,n,wo,me.placeholder,a,Te,gt,F,T,z-Pe)}var Or=k?a:this,ni=X?Or[i]:i;return Pe=Te.length,F?Te=uy(Te,F):ve&&Pe>1&&Te.reverse(),q&&T<Pe&&(Te.length=T),this&&this!==Ne&&this instanceof me&&(ni=Oe||Jn(ni)),ni.apply(Or,Te)}return me}function Fl(i,n){return function(a,u){return v1(a,i,n(u),{})}}function _o(i,n){return function(a,u){var y;if(a===t&&u===t)return n;if(a!==t&&(y=a),u!==t){if(y===t)return u;typeof a=="string"||typeof u=="string"?(a=rr(a),u=rr(u)):(a=gl(a),u=gl(u)),y=i(a,u)}return y}}function Ac(i){return ei(function(n){return n=it(n,tr(fe())),Fe(function(a){var u=this;return i(n,function(y){return At(y,u,a)})})})}function Eo(i,n){n=n===t?" ":rr(n);var a=n.length;if(a<2)return a?bc(n,i):n;var u=bc(n,ao(i/un(n)));return cn(n)?gi(Ir(u),0,i).join(""):u.slice(0,i)}function K1(i,n,a,u){var y=n&B,m=Jn(i);function A(){for(var F=-1,T=arguments.length,z=-1,q=u.length,k=U(q+T),X=this&&this!==Ne&&this instanceof A?m:i;++z<q;)k[z]=u[z];for(;T--;)k[z++]=arguments[++F];return At(X,y?a:this,k)}return A}function Pl(i){return function(n,a,u){return u&&typeof u!="number"&&zt(n,a,u)&&(a=u=t),n=ii(n),a===t?(a=n,n=0):a=ii(a),u=u===t?n<a?1:-1:ii(u),C1(n,a,u,i)}}function Do(i){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=gr(n),a=gr(a)),i(n,a)}}function $l(i,n,a,u,y,m,A,F,T,z){var q=n&O,k=q?A:t,X=q?t:A,oe=q?m:t,ve=q?t:m;n|=q?x:C,n&=~(q?C:x),n&P||(n&=~(B|H));var Oe=[i,n,y,oe,k,ve,X,F,T,z],me=a.apply(t,Oe);return Tc(i)&&Kl(me,Oe),me.placeholder=u,Vl(me,i,n)}function Oc(i){var n=Et[i];return function(a,u){if(a=gr(a),u=u==null?0:Ut(Se(u),292),u&&Vh(a)){var y=(Me(a)+"e").split("e"),m=n(y[0]+"e"+(+y[1]+u));return y=(Me(m)+"e").split("e"),+(y[0]+"e"+(+y[1]-u))}return n(a)}}var V1=fn&&1/Zs(new fn([,-0]))[1]==j?function(i){return new fn(i)}:Yc;function Nl(i){return function(n){var a=jt(n);return a==Xe?ic(n):a==Re?c0(n):e0(n,i(n))}}function Qr(i,n,a,u,y,m,A,F){var T=n&H;if(!T&&typeof i!="function")throw new hr(h);var z=u?u.length:0;if(z||(n&=~(x|C),u=y=t),A=A===t?A:Dt(Se(A),0),F=F===t?F:Se(F),z-=y?y.length:0,n&C){var q=u,k=y;u=y=t}var X=T?t:Fc(i),oe=[i,n,a,u,y,q,k,m,A,F];if(X&&oy(oe,X),i=oe[0],n=oe[1],a=oe[2],u=oe[3],y=oe[4],F=oe[9]=oe[9]===t?T?0:i.length:Dt(oe[9]-z,0),!F&&n&(O|D)&&(n&=~(O|D)),!n||n==B)var ve=q1(i,n,a);else n==O||n==D?ve=H1(i,n,F):(n==x||n==(B|x))&&!y.length?ve=K1(i,n,a,u):ve=wo.apply(t,oe);var Oe=X?pl:Kl;return Vl(Oe(ve,oe),i,n)}function Tl(i,n,a,u){return i===t||Ar(i,ln[a])&&!qe.call(u,a)?n:i}function Rl(i,n,a,u,y,m){return ut(i)&&ut(n)&&(m.set(n,i),yo(i,n,t,Rl,m),m.delete(n)),i}function k1(i){return Qn(i)?t:i}function Ul(i,n,a,u,y,m){var A=a&S,F=i.length,T=n.length;if(F!=T&&!(A&&T>F))return!1;var z=m.get(i),q=m.get(n);if(z&&q)return z==n&&q==i;var k=-1,X=!0,oe=a&R?new Ti:t;for(m.set(i,n),m.set(n,i);++k<F;){var ve=i[k],Oe=n[k];if(u)var me=A?u(Oe,ve,k,n,i,m):u(ve,Oe,k,i,n,m);if(me!==t){if(me)continue;X=!1;break}if(oe){if(!Za(n,function(Pe,Te){if(!Mn(oe,Te)&&(ve===Pe||y(ve,Pe,a,u,m)))return oe.push(Te)})){X=!1;break}}else if(!(ve===Oe||y(ve,Oe,a,u,m))){X=!1;break}}return m.delete(i),m.delete(n),X}function G1(i,n,a,u,y,m,A){switch(a){case ze:if(i.byteLength!=n.byteLength||i.byteOffset!=n.byteOffset)return!1;i=i.buffer,n=n.buffer;case Le:return!(i.byteLength!=n.byteLength||!m(new io(i),new io(n)));case he:case ye:case Rt:return Ar(+i,+n);case De:return i.name==n.name&&i.message==n.message;case Ke:case Ve:return i==n+"";case Xe:var F=ic;case Re:var T=u&S;if(F||(F=Zs),i.size!=n.size&&!T)return!1;var z=A.get(i);if(z)return z==n;u|=R,A.set(i,n);var q=Ul(F(i),F(n),u,y,m,A);return A.delete(i),q;case Ze:if(Kn)return Kn.call(i)==Kn.call(n)}return!1}function W1(i,n,a,u,y,m){var A=a&S,F=xc(i),T=F.length,z=xc(n),q=z.length;if(T!=q&&!A)return!1;for(var k=T;k--;){var X=F[k];if(!(A?X in n:qe.call(n,X)))return!1}var oe=m.get(i),ve=m.get(n);if(oe&&ve)return oe==n&&ve==i;var Oe=!0;m.set(i,n),m.set(n,i);for(var me=A;++k<T;){X=F[k];var Pe=i[X],Te=n[X];if(u)var nr=A?u(Te,Pe,X,n,i,m):u(Pe,Te,X,i,n,m);if(!(nr===t?Pe===Te||y(Pe,Te,a,u,m):nr)){Oe=!1;break}me||(me=X=="constructor")}if(Oe&&!me){var qt=i.constructor,sr=n.constructor;qt!=sr&&"constructor"in i&&"constructor"in n&&!(typeof qt=="function"&&qt instanceof qt&&typeof sr=="function"&&sr instanceof sr)&&(Oe=!1)}return m.delete(i),m.delete(n),Oe}function ei(i){return Uc(ql(i,t,Zl),i+"")}function xc(i){return rl(i,Ot,$c)}function Cc(i){return rl(i,Wt,jl)}var Fc=uo?function(i){return uo.get(i)}:Yc;function Io(i){for(var n=i.name+"",a=pn[n],u=qe.call(pn,n)?a.length:0;u--;){var y=a[u],m=y.func;if(m==null||m==i)return y.name}return n}function vn(i){var n=qe.call(v,"placeholder")?v:i;return n.placeholder}function fe(){var i=v.iteratee||Gc;return i=i===Gc?sl:i,arguments.length?i(arguments[0],arguments[1]):i}function So(i,n){var a=i.__data__;return ry(n)?a[typeof n=="string"?"string":"hash"]:a.map}function Pc(i){for(var n=Ot(i),a=n.length;a--;){var u=n[a],y=i[u];n[a]=[u,y,Ll(y)]}return n}function ji(i,n){var a=s0(i,n);return nl(a)?a:t}function Y1(i){var n=qe.call(i,$i),a=i[$i];try{i[$i]=t;var u=!0}catch{}var y=to.call(i);return u&&(n?i[$i]=a:delete i[$i]),y}var $c=sc?function(i){return i==null?[]:(i=Je(i),ci(sc(i),function(n){return Hh.call(i,n)}))}:Jc,jl=sc?function(i){for(var n=[];i;)ui(n,$c(i)),i=no(i);return n}:Jc,jt=Lt;(oc&&jt(new oc(new ArrayBuffer(1)))!=ze||zn&&jt(new zn)!=Xe||ac&&jt(ac.resolve())!=Nr||fn&&jt(new fn)!=Re||qn&&jt(new qn)!=ke)&&(jt=function(i){var n=Lt(i),a=n==St?i.constructor:t,u=a?Bi(a):"";if(u)switch(u){case P0:return ze;case $0:return Xe;case N0:return Nr;case T0:return Re;case R0:return ke}return n});function J1(i,n,a){for(var u=-1,y=a.length;++u<y;){var m=a[u],A=m.size;switch(m.type){case"drop":i+=A;break;case"dropRight":n-=A;break;case"take":n=Ut(n,i+A);break;case"takeRight":i=Dt(i,n-A);break}}return{start:i,end:n}}function Z1(i){var n=i.match(Gr);return n?n[1].split(Aa):[]}function Bl(i,n,a){n=di(n,i);for(var u=-1,y=n.length,m=!1;++u<y;){var A=Br(n[u]);if(!(m=i!=null&&a(i,A)))break;i=i[A]}return m||++u!=y?m:(y=i==null?0:i.length,!!y&&$o(y)&&ti(A,y)&&(Ee(i)||Mi(i)))}function X1(i){var n=i.length,a=new i.constructor(n);return n&&typeof i[0]=="string"&&qe.call(i,"index")&&(a.index=i.index,a.input=i.input),a}function Ml(i){return typeof i.constructor=="function"&&!Zn(i)?dn(no(i)):{}}function Q1(i,n,a){var u=i.constructor;switch(n){case Le:return Sc(i);case he:case ye:return new u(+i);case ze:return U1(i,a);case Qe:case je:case ot:case at:case ht:case ct:case et:case Ji:case Zi:return _l(i,a);case Xe:return new u;case Rt:case Ve:return new u(i);case Ke:return j1(i);case Re:return new u;case Ze:return B1(i)}}function ey(i,n){var a=n.length;if(!a)return i;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),i.replace(Tn,`{
/* [wrapped with `+n+`] */
`)}function ty(i){return Ee(i)||Mi(i)||!!(Kh&&i&&i[Kh])}function ti(i,n){var a=typeof i;return n=n??G,!!n&&(a=="number"||a!="symbol"&&Ra.test(i))&&i>-1&&i%1==0&&i<n}function zt(i,n,a){if(!ut(a))return!1;var u=typeof n;return(u=="number"?Gt(a)&&ti(n,a.length):u=="string"&&n in a)?Ar(a[n],i):!1}function Nc(i,n){if(Ee(i))return!1;var a=typeof i;return a=="number"||a=="symbol"||a=="boolean"||i==null||ir(i)?!0:Da.test(i)||!Ai.test(i)||n!=null&&i in Je(n)}function ry(i){var n=typeof i;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?i!=="__proto__":i===null}function Tc(i){var n=Io(i),a=v[n];if(typeof a!="function"||!(n in $e.prototype))return!1;if(i===a)return!0;var u=Fc(a);return!!u&&i===u[0]}function iy(i){return!!Lh&&Lh in i}var ny=Qs?ri:Zc;function Zn(i){var n=i&&i.constructor,a=typeof n=="function"&&n.prototype||ln;return i===a}function Ll(i){return i===i&&!ut(i)}function zl(i,n){return function(a){return a==null?!1:a[i]===n&&(n!==t||i in Je(a))}}function sy(i){var n=Fo(i,function(u){return a.size===d&&a.clear(),u}),a=n.cache;return n}function oy(i,n){var a=i[1],u=n[1],y=a|u,m=y<(B|H|l),A=u==l&&a==O||u==l&&a==w&&i[7].length<=n[8]||u==(l|w)&&n[7].length<=n[8]&&a==O;if(!(m||A))return i;u&B&&(i[2]=n[2],y|=a&B?0:P);var F=n[3];if(F){var T=i[3];i[3]=T?Dl(T,F,n[4]):F,i[4]=T?hi(i[3],g):n[4]}return F=n[5],F&&(T=i[5],i[5]=T?Il(T,F,n[6]):F,i[6]=T?hi(i[5],g):n[6]),F=n[7],F&&(i[7]=F),u&l&&(i[8]=i[8]==null?n[8]:Ut(i[8],n[8])),i[9]==null&&(i[9]=n[9]),i[0]=n[0],i[1]=y,i}function ay(i){var n=[];if(i!=null)for(var a in Je(i))n.push(a);return n}function cy(i){return to.call(i)}function ql(i,n,a){return n=Dt(n===t?i.length-1:n,0),function(){for(var u=arguments,y=-1,m=Dt(u.length-n,0),A=U(m);++y<m;)A[y]=u[n+y];y=-1;for(var F=U(n+1);++y<n;)F[y]=u[y];return F[n]=a(A),At(i,this,F)}}function Hl(i,n){return n.length<2?i:Ui(i,pr(n,0,-1))}function uy(i,n){for(var a=i.length,u=Ut(n.length,a),y=kt(i);u--;){var m=n[u];i[u]=ti(m,a)?y[m]:t}return i}function Rc(i,n){if(!(n==="constructor"&&typeof i[n]=="function")&&n!="__proto__")return i[n]}var Kl=kl(pl),Xn=I0||function(i,n){return Ne.setTimeout(i,n)},Uc=kl($1);function Vl(i,n,a){var u=n+"";return Uc(i,ey(u,hy(Z1(u),a)))}function kl(i){var n=0,a=0;return function(){var u=x0(),y=pe-(u-a);if(a=u,y>0){if(++n>=ue)return arguments[0]}else n=0;return i.apply(t,arguments)}}function Ao(i,n){var a=-1,u=i.length,y=u-1;for(n=n===t?u:n;++a<n;){var m=mc(a,y),A=i[m];i[m]=i[a],i[a]=A}return i.length=n,i}var Gl=sy(function(i){var n=[];return i.charCodeAt(0)===46&&n.push(""),i.replace(Ia,function(a,u,y,m){n.push(y?m.replace(Ca,"$1"):u||a)}),n});function Br(i){if(typeof i=="string"||ir(i))return i;var n=i+"";return n=="0"&&1/i==-j?"-0":n}function Bi(i){if(i!=null){try{return eo.call(i)}catch{}try{return i+""}catch{}}return""}function hy(i,n){return ur(re,function(a){var u="_."+a[0];n&a[1]&&!Ys(i,u)&&i.push(u)}),i.sort()}function Wl(i){if(i instanceof $e)return i.clone();var n=new lr(i.__wrapped__,i.__chain__);return n.__actions__=kt(i.__actions__),n.__index__=i.__index__,n.__values__=i.__values__,n}function ly(i,n,a){(a?zt(i,n,a):n===t)?n=1:n=Dt(Se(n),0);var u=i==null?0:i.length;if(!u||n<1)return[];for(var y=0,m=0,A=U(ao(u/n));y<u;)A[m++]=pr(i,y,y+=n);return A}function fy(i){for(var n=-1,a=i==null?0:i.length,u=0,y=[];++n<a;){var m=i[n];m&&(y[u++]=m)}return y}function py(){var i=arguments.length;if(!i)return[];for(var n=U(i-1),a=arguments[0],u=i;u--;)n[u-1]=arguments[u];return ui(Ee(a)?kt(a):[a],Pt(n,1))}var dy=Fe(function(i,n){return dt(i)?kn(i,Pt(n,1,dt,!0)):[]}),gy=Fe(function(i,n){var a=dr(n);return dt(a)&&(a=t),dt(i)?kn(i,Pt(n,1,dt,!0),fe(a,2)):[]}),yy=Fe(function(i,n){var a=dr(n);return dt(a)&&(a=t),dt(i)?kn(i,Pt(n,1,dt,!0),t,a):[]});function vy(i,n,a){var u=i==null?0:i.length;return u?(n=a||n===t?1:Se(n),pr(i,n<0?0:n,u)):[]}function my(i,n,a){var u=i==null?0:i.length;return u?(n=a||n===t?1:Se(n),n=u-n,pr(i,0,n<0?0:n)):[]}function by(i,n){return i&&i.length?mo(i,fe(n,3),!0,!0):[]}function wy(i,n){return i&&i.length?mo(i,fe(n,3),!0):[]}function _y(i,n,a,u){var y=i==null?0:i.length;return y?(a&&typeof a!="number"&&zt(i,n,a)&&(a=0,u=y),p1(i,n,a,u)):[]}function Yl(i,n,a){var u=i==null?0:i.length;if(!u)return-1;var y=a==null?0:Se(a);return y<0&&(y=Dt(u+y,0)),Js(i,fe(n,3),y)}function Jl(i,n,a){var u=i==null?0:i.length;if(!u)return-1;var y=u-1;return a!==t&&(y=Se(a),y=a<0?Dt(u+y,0):Ut(y,u-1)),Js(i,fe(n,3),y,!0)}function Zl(i){var n=i==null?0:i.length;return n?Pt(i,1):[]}function Ey(i){var n=i==null?0:i.length;return n?Pt(i,j):[]}function Dy(i,n){var a=i==null?0:i.length;return a?(n=n===t?1:Se(n),Pt(i,n)):[]}function Iy(i){for(var n=-1,a=i==null?0:i.length,u={};++n<a;){var y=i[n];u[y[0]]=y[1]}return u}function Xl(i){return i&&i.length?i[0]:t}function Sy(i,n,a){var u=i==null?0:i.length;if(!u)return-1;var y=a==null?0:Se(a);return y<0&&(y=Dt(u+y,0)),an(i,n,y)}function Ay(i){var n=i==null?0:i.length;return n?pr(i,0,-1):[]}var Oy=Fe(function(i){var n=it(i,Dc);return n.length&&n[0]===i[0]?pc(n):[]}),xy=Fe(function(i){var n=dr(i),a=it(i,Dc);return n===dr(a)?n=t:a.pop(),a.length&&a[0]===i[0]?pc(a,fe(n,2)):[]}),Cy=Fe(function(i){var n=dr(i),a=it(i,Dc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===i[0]?pc(a,t,n):[]});function Fy(i,n){return i==null?"":A0.call(i,n)}function dr(i){var n=i==null?0:i.length;return n?i[n-1]:t}function Py(i,n,a){var u=i==null?0:i.length;if(!u)return-1;var y=u;return a!==t&&(y=Se(a),y=y<0?Dt(u+y,0):Ut(y,u-1)),n===n?h0(i,n,y):Js(i,$h,y,!0)}function $y(i,n){return i&&i.length?ul(i,Se(n)):t}var Ny=Fe(Ql);function Ql(i,n){return i&&i.length&&n&&n.length?vc(i,n):i}function Ty(i,n,a){return i&&i.length&&n&&n.length?vc(i,n,fe(a,2)):i}function Ry(i,n,a){return i&&i.length&&n&&n.length?vc(i,n,t,a):i}var Uy=ei(function(i,n){var a=i==null?0:i.length,u=uc(i,n);return fl(i,it(n,function(y){return ti(y,a)?+y:y}).sort(El)),u});function jy(i,n){var a=[];if(!(i&&i.length))return a;var u=-1,y=[],m=i.length;for(n=fe(n,3);++u<m;){var A=i[u];n(A,u,i)&&(a.push(A),y.push(u))}return fl(i,y),a}function jc(i){return i==null?i:F0.call(i)}function By(i,n,a){var u=i==null?0:i.length;return u?(a&&typeof a!="number"&&zt(i,n,a)?(n=0,a=u):(n=n==null?0:Se(n),a=a===t?u:Se(a)),pr(i,n,a)):[]}function My(i,n){return vo(i,n)}function Ly(i,n,a){return wc(i,n,fe(a,2))}function zy(i,n){var a=i==null?0:i.length;if(a){var u=vo(i,n);if(u<a&&Ar(i[u],n))return u}return-1}function qy(i,n){return vo(i,n,!0)}function Hy(i,n,a){return wc(i,n,fe(a,2),!0)}function Ky(i,n){var a=i==null?0:i.length;if(a){var u=vo(i,n,!0)-1;if(Ar(i[u],n))return u}return-1}function Vy(i){return i&&i.length?dl(i):[]}function ky(i,n){return i&&i.length?dl(i,fe(n,2)):[]}function Gy(i){var n=i==null?0:i.length;return n?pr(i,1,n):[]}function Wy(i,n,a){return i&&i.length?(n=a||n===t?1:Se(n),pr(i,0,n<0?0:n)):[]}function Yy(i,n,a){var u=i==null?0:i.length;return u?(n=a||n===t?1:Se(n),n=u-n,pr(i,n<0?0:n,u)):[]}function Jy(i,n){return i&&i.length?mo(i,fe(n,3),!1,!0):[]}function Zy(i,n){return i&&i.length?mo(i,fe(n,3)):[]}var Xy=Fe(function(i){return pi(Pt(i,1,dt,!0))}),Qy=Fe(function(i){var n=dr(i);return dt(n)&&(n=t),pi(Pt(i,1,dt,!0),fe(n,2))}),ev=Fe(function(i){var n=dr(i);return n=typeof n=="function"?n:t,pi(Pt(i,1,dt,!0),t,n)});function tv(i){return i&&i.length?pi(i):[]}function rv(i,n){return i&&i.length?pi(i,fe(n,2)):[]}function iv(i,n){return n=typeof n=="function"?n:t,i&&i.length?pi(i,t,n):[]}function Bc(i){if(!(i&&i.length))return[];var n=0;return i=ci(i,function(a){if(dt(a))return n=Dt(a.length,n),!0}),tc(n,function(a){return it(i,Xa(a))})}function ef(i,n){if(!(i&&i.length))return[];var a=Bc(i);return n==null?a:it(a,function(u){return At(n,t,u)})}var nv=Fe(function(i,n){return dt(i)?kn(i,n):[]}),sv=Fe(function(i){return Ec(ci(i,dt))}),ov=Fe(function(i){var n=dr(i);return dt(n)&&(n=t),Ec(ci(i,dt),fe(n,2))}),av=Fe(function(i){var n=dr(i);return n=typeof n=="function"?n:t,Ec(ci(i,dt),t,n)}),cv=Fe(Bc);function uv(i,n){return ml(i||[],n||[],Vn)}function hv(i,n){return ml(i||[],n||[],Yn)}var lv=Fe(function(i){var n=i.length,a=n>1?i[n-1]:t;return a=typeof a=="function"?(i.pop(),a):t,ef(i,a)});function tf(i){var n=v(i);return n.__chain__=!0,n}function fv(i,n){return n(i),i}function Oo(i,n){return n(i)}var pv=ei(function(i){var n=i.length,a=n?i[0]:0,u=this.__wrapped__,y=function(m){return uc(m,i)};return n>1||this.__actions__.length||!(u instanceof $e)||!ti(a)?this.thru(y):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:Oo,args:[y],thisArg:t}),new lr(u,this.__chain__).thru(function(m){return n&&!m.length&&m.push(t),m}))});function dv(){return tf(this)}function gv(){return new lr(this.value(),this.__chain__)}function yv(){this.__values__===t&&(this.__values__=yf(this.value()));var i=this.__index__>=this.__values__.length,n=i?t:this.__values__[this.__index__++];return{done:i,value:n}}function vv(){return this}function mv(i){for(var n,a=this;a instanceof lo;){var u=Wl(a);u.__index__=0,u.__values__=t,n?y.__wrapped__=u:n=u;var y=u;a=a.__wrapped__}return y.__wrapped__=i,n}function bv(){var i=this.__wrapped__;if(i instanceof $e){var n=i;return this.__actions__.length&&(n=new $e(this)),n=n.reverse(),n.__actions__.push({func:Oo,args:[jc],thisArg:t}),new lr(n,this.__chain__)}return this.thru(jc)}function wv(){return vl(this.__wrapped__,this.__actions__)}var _v=bo(function(i,n,a){qe.call(i,a)?++i[a]:Xr(i,a,1)});function Ev(i,n,a){var u=Ee(i)?Fh:f1;return a&&zt(i,n,a)&&(n=t),u(i,fe(n,3))}function Dv(i,n){var a=Ee(i)?ci:el;return a(i,fe(n,3))}var Iv=xl(Yl),Sv=xl(Jl);function Av(i,n){return Pt(xo(i,n),1)}function Ov(i,n){return Pt(xo(i,n),j)}function xv(i,n,a){return a=a===t?1:Se(a),Pt(xo(i,n),a)}function rf(i,n){var a=Ee(i)?ur:fi;return a(i,fe(n,3))}function nf(i,n){var a=Ee(i)?Gg:Qh;return a(i,fe(n,3))}var Cv=bo(function(i,n,a){qe.call(i,a)?i[a].push(n):Xr(i,a,[n])});function Fv(i,n,a,u){i=Gt(i)?i:bn(i),a=a&&!u?Se(a):0;var y=i.length;return a<0&&(a=Dt(y+a,0)),No(i)?a<=y&&i.indexOf(n,a)>-1:!!y&&an(i,n,a)>-1}var Pv=Fe(function(i,n,a){var u=-1,y=typeof n=="function",m=Gt(i)?U(i.length):[];return fi(i,function(A){m[++u]=y?At(n,A,a):Gn(A,n,a)}),m}),$v=bo(function(i,n,a){Xr(i,a,n)});function xo(i,n){var a=Ee(i)?it:ol;return a(i,fe(n,3))}function Nv(i,n,a,u){return i==null?[]:(Ee(n)||(n=n==null?[]:[n]),a=u?t:a,Ee(a)||(a=a==null?[]:[a]),hl(i,n,a))}var Tv=bo(function(i,n,a){i[a?0:1].push(n)},function(){return[[],[]]});function Rv(i,n,a){var u=Ee(i)?Ja:Th,y=arguments.length<3;return u(i,fe(n,4),a,y,fi)}function Uv(i,n,a){var u=Ee(i)?Wg:Th,y=arguments.length<3;return u(i,fe(n,4),a,y,Qh)}function jv(i,n){var a=Ee(i)?ci:el;return a(i,Po(fe(n,3)))}function Bv(i){var n=Ee(i)?Yh:F1;return n(i)}function Mv(i,n,a){(a?zt(i,n,a):n===t)?n=1:n=Se(n);var u=Ee(i)?a1:P1;return u(i,n)}function Lv(i){var n=Ee(i)?c1:N1;return n(i)}function zv(i){if(i==null)return 0;if(Gt(i))return No(i)?un(i):i.length;var n=jt(i);return n==Xe||n==Re?i.size:gc(i).length}function qv(i,n,a){var u=Ee(i)?Za:T1;return a&&zt(i,n,a)&&(n=t),u(i,fe(n,3))}var Hv=Fe(function(i,n){if(i==null)return[];var a=n.length;return a>1&&zt(i,n[0],n[1])?n=[]:a>2&&zt(n[0],n[1],n[2])&&(n=[n[0]]),hl(i,Pt(n,1),[])}),Co=D0||function(){return Ne.Date.now()};function Kv(i,n){if(typeof n!="function")throw new hr(h);return i=Se(i),function(){if(--i<1)return n.apply(this,arguments)}}function sf(i,n,a){return n=a?t:n,n=i&&n==null?i.length:n,Qr(i,l,t,t,t,t,n)}function of(i,n){var a;if(typeof n!="function")throw new hr(h);return i=Se(i),function(){return--i>0&&(a=n.apply(this,arguments)),i<=1&&(n=t),a}}var Mc=Fe(function(i,n,a){var u=B;if(a.length){var y=hi(a,vn(Mc));u|=x}return Qr(i,u,n,a,y)}),af=Fe(function(i,n,a){var u=B|H;if(a.length){var y=hi(a,vn(af));u|=x}return Qr(n,u,i,a,y)});function cf(i,n,a){n=a?t:n;var u=Qr(i,O,t,t,t,t,t,n);return u.placeholder=cf.placeholder,u}function uf(i,n,a){n=a?t:n;var u=Qr(i,D,t,t,t,t,t,n);return u.placeholder=uf.placeholder,u}function hf(i,n,a){var u,y,m,A,F,T,z=0,q=!1,k=!1,X=!0;if(typeof i!="function")throw new hr(h);n=gr(n)||0,ut(a)&&(q=!!a.leading,k="maxWait"in a,m=k?Dt(gr(a.maxWait)||0,n):m,X="trailing"in a?!!a.trailing:X);function oe(gt){var Or=u,ni=y;return u=y=t,z=gt,A=i.apply(ni,Or),A}function ve(gt){return z=gt,F=Xn(Pe,n),q?oe(gt):A}function Oe(gt){var Or=gt-T,ni=gt-z,Cf=n-Or;return k?Ut(Cf,m-ni):Cf}function me(gt){var Or=gt-T,ni=gt-z;return T===t||Or>=n||Or<0||k&&ni>=m}function Pe(){var gt=Co();if(me(gt))return Te(gt);F=Xn(Pe,Oe(gt))}function Te(gt){return F=t,X&&u?oe(gt):(u=y=t,A)}function nr(){F!==t&&bl(F),z=0,u=T=y=F=t}function qt(){return F===t?A:Te(Co())}function sr(){var gt=Co(),Or=me(gt);if(u=arguments,y=this,T=gt,Or){if(F===t)return ve(T);if(k)return bl(F),F=Xn(Pe,n),oe(T)}return F===t&&(F=Xn(Pe,n)),A}return sr.cancel=nr,sr.flush=qt,sr}var Vv=Fe(function(i,n){return Xh(i,1,n)}),kv=Fe(function(i,n,a){return Xh(i,gr(n)||0,a)});function Gv(i){return Qr(i,K)}function Fo(i,n){if(typeof i!="function"||n!=null&&typeof n!="function")throw new hr(h);var a=function(){var u=arguments,y=n?n.apply(this,u):u[0],m=a.cache;if(m.has(y))return m.get(y);var A=i.apply(this,u);return a.cache=m.set(y,A)||m,A};return a.cache=new(Fo.Cache||Zr),a}Fo.Cache=Zr;function Po(i){if(typeof i!="function")throw new hr(h);return function(){var n=arguments;switch(n.length){case 0:return!i.call(this);case 1:return!i.call(this,n[0]);case 2:return!i.call(this,n[0],n[1]);case 3:return!i.call(this,n[0],n[1],n[2])}return!i.apply(this,n)}}function Wv(i){return of(2,i)}var Yv=R1(function(i,n){n=n.length==1&&Ee(n[0])?it(n[0],tr(fe())):it(Pt(n,1),tr(fe()));var a=n.length;return Fe(function(u){for(var y=-1,m=Ut(u.length,a);++y<m;)u[y]=n[y].call(this,u[y]);return At(i,this,u)})}),Lc=Fe(function(i,n){var a=hi(n,vn(Lc));return Qr(i,x,t,n,a)}),lf=Fe(function(i,n){var a=hi(n,vn(lf));return Qr(i,C,t,n,a)}),Jv=ei(function(i,n){return Qr(i,w,t,t,t,n)});function Zv(i,n){if(typeof i!="function")throw new hr(h);return n=n===t?n:Se(n),Fe(i,n)}function Xv(i,n){if(typeof i!="function")throw new hr(h);return n=n==null?0:Dt(Se(n),0),Fe(function(a){var u=a[n],y=gi(a,0,n);return u&&ui(y,u),At(i,this,y)})}function Qv(i,n,a){var u=!0,y=!0;if(typeof i!="function")throw new hr(h);return ut(a)&&(u="leading"in a?!!a.leading:u,y="trailing"in a?!!a.trailing:y),hf(i,n,{leading:u,maxWait:n,trailing:y})}function em(i){return sf(i,1)}function tm(i,n){return Lc(Ic(n),i)}function rm(){if(!arguments.length)return[];var i=arguments[0];return Ee(i)?i:[i]}function im(i){return fr(i,I)}function nm(i,n){return n=typeof n=="function"?n:t,fr(i,I,n)}function sm(i){return fr(i,b|I)}function om(i,n){return n=typeof n=="function"?n:t,fr(i,b|I,n)}function am(i,n){return n==null||Zh(i,n,Ot(n))}function Ar(i,n){return i===n||i!==i&&n!==n}var cm=Do(fc),um=Do(function(i,n){return i>=n}),Mi=il(function(){return arguments}())?il:function(i){return lt(i)&&qe.call(i,"callee")&&!Hh.call(i,"callee")},Ee=U.isArray,hm=Mt?tr(Mt):m1;function Gt(i){return i!=null&&$o(i.length)&&!ri(i)}function dt(i){return lt(i)&&Gt(i)}function lm(i){return i===!0||i===!1||lt(i)&&Lt(i)==he}var yi=S0||Zc,fm=Dr?tr(Dr):b1;function pm(i){return lt(i)&&i.nodeType===1&&!Qn(i)}function dm(i){if(i==null)return!0;if(Gt(i)&&(Ee(i)||typeof i=="string"||typeof i.splice=="function"||yi(i)||mn(i)||Mi(i)))return!i.length;var n=jt(i);if(n==Xe||n==Re)return!i.size;if(Zn(i))return!gc(i).length;for(var a in i)if(qe.call(i,a))return!1;return!0}function gm(i,n){return Wn(i,n)}function ym(i,n,a){a=typeof a=="function"?a:t;var u=a?a(i,n):t;return u===t?Wn(i,n,t,a):!!u}function zc(i){if(!lt(i))return!1;var n=Lt(i);return n==De||n==Ie||typeof i.message=="string"&&typeof i.name=="string"&&!Qn(i)}function vm(i){return typeof i=="number"&&Vh(i)}function ri(i){if(!ut(i))return!1;var n=Lt(i);return n==Ce||n==Ue||n==be||n==Vr}function ff(i){return typeof i=="number"&&i==Se(i)}function $o(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=G}function ut(i){var n=typeof i;return i!=null&&(n=="object"||n=="function")}function lt(i){return i!=null&&typeof i=="object"}var pf=cr?tr(cr):_1;function mm(i,n){return i===n||dc(i,n,Pc(n))}function bm(i,n,a){return a=typeof a=="function"?a:t,dc(i,n,Pc(n),a)}function wm(i){return df(i)&&i!=+i}function _m(i){if(ny(i))throw new we(c);return nl(i)}function Em(i){return i===null}function Dm(i){return i==null}function df(i){return typeof i=="number"||lt(i)&&Lt(i)==Rt}function Qn(i){if(!lt(i)||Lt(i)!=St)return!1;var n=no(i);if(n===null)return!0;var a=qe.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&eo.call(a)==b0}var qc=Rr?tr(Rr):E1;function Im(i){return ff(i)&&i>=-G&&i<=G}var gf=Bn?tr(Bn):D1;function No(i){return typeof i=="string"||!Ee(i)&&lt(i)&&Lt(i)==Ve}function ir(i){return typeof i=="symbol"||lt(i)&&Lt(i)==Ze}var mn=Pi?tr(Pi):I1;function Sm(i){return i===t}function Am(i){return lt(i)&&jt(i)==ke}function Om(i){return lt(i)&&Lt(i)==st}var xm=Do(yc),Cm=Do(function(i,n){return i<=n});function yf(i){if(!i)return[];if(Gt(i))return No(i)?Ir(i):kt(i);if(Ln&&i[Ln])return a0(i[Ln]());var n=jt(i),a=n==Xe?ic:n==Re?Zs:bn;return a(i)}function ii(i){if(!i)return i===0?i:0;if(i=gr(i),i===j||i===-j){var n=i<0?-1:1;return n*ne}return i===i?i:0}function Se(i){var n=ii(i),a=n%1;return n===n?a?n-a:n:0}function vf(i){return i?Ri(Se(i),0,ie):0}function gr(i){if(typeof i=="number")return i;if(ir(i))return se;if(ut(i)){var n=typeof i.valueOf=="function"?i.valueOf():i;i=ut(n)?n+"":n}if(typeof i!="string")return i===0?i:+i;i=Rh(i);var a=$a.test(i);return a||Ta.test(i)?_e(i.slice(2),a?2:8):Pa.test(i)?se:+i}function mf(i){return jr(i,Wt(i))}function Fm(i){return i?Ri(Se(i),-G,G):i===0?i:0}function Me(i){return i==null?"":rr(i)}var Pm=gn(function(i,n){if(Zn(n)||Gt(n)){jr(n,Ot(n),i);return}for(var a in n)qe.call(n,a)&&Vn(i,a,n[a])}),bf=gn(function(i,n){jr(n,Wt(n),i)}),To=gn(function(i,n,a,u){jr(n,Wt(n),i,u)}),$m=gn(function(i,n,a,u){jr(n,Ot(n),i,u)}),Nm=ei(uc);function Tm(i,n){var a=dn(i);return n==null?a:Jh(a,n)}var Rm=Fe(function(i,n){i=Je(i);var a=-1,u=n.length,y=u>2?n[2]:t;for(y&&zt(n[0],n[1],y)&&(u=1);++a<u;)for(var m=n[a],A=Wt(m),F=-1,T=A.length;++F<T;){var z=A[F],q=i[z];(q===t||Ar(q,ln[z])&&!qe.call(i,z))&&(i[z]=m[z])}return i}),Um=Fe(function(i){return i.push(t,Rl),At(wf,t,i)});function jm(i,n){return Ph(i,fe(n,3),Ur)}function Bm(i,n){return Ph(i,fe(n,3),lc)}function Mm(i,n){return i==null?i:hc(i,fe(n,3),Wt)}function Lm(i,n){return i==null?i:tl(i,fe(n,3),Wt)}function zm(i,n){return i&&Ur(i,fe(n,3))}function qm(i,n){return i&&lc(i,fe(n,3))}function Hm(i){return i==null?[]:go(i,Ot(i))}function Km(i){return i==null?[]:go(i,Wt(i))}function Hc(i,n,a){var u=i==null?t:Ui(i,n);return u===t?a:u}function Vm(i,n){return i!=null&&Bl(i,n,d1)}function Kc(i,n){return i!=null&&Bl(i,n,g1)}var km=Fl(function(i,n,a){n!=null&&typeof n.toString!="function"&&(n=to.call(n)),i[n]=a},kc(Yt)),Gm=Fl(function(i,n,a){n!=null&&typeof n.toString!="function"&&(n=to.call(n)),qe.call(i,n)?i[n].push(a):i[n]=[a]},fe),Wm=Fe(Gn);function Ot(i){return Gt(i)?Wh(i):gc(i)}function Wt(i){return Gt(i)?Wh(i,!0):S1(i)}function Ym(i,n){var a={};return n=fe(n,3),Ur(i,function(u,y,m){Xr(a,n(u,y,m),u)}),a}function Jm(i,n){var a={};return n=fe(n,3),Ur(i,function(u,y,m){Xr(a,y,n(u,y,m))}),a}var Zm=gn(function(i,n,a){yo(i,n,a)}),wf=gn(function(i,n,a,u){yo(i,n,a,u)}),Xm=ei(function(i,n){var a={};if(i==null)return a;var u=!1;n=it(n,function(m){return m=di(m,i),u||(u=m.length>1),m}),jr(i,Cc(i),a),u&&(a=fr(a,b|E|I,k1));for(var y=n.length;y--;)_c(a,n[y]);return a});function Qm(i,n){return _f(i,Po(fe(n)))}var eb=ei(function(i,n){return i==null?{}:O1(i,n)});function _f(i,n){if(i==null)return{};var a=it(Cc(i),function(u){return[u]});return n=fe(n),ll(i,a,function(u,y){return n(u,y[0])})}function tb(i,n,a){n=di(n,i);var u=-1,y=n.length;for(y||(y=1,i=t);++u<y;){var m=i==null?t:i[Br(n[u])];m===t&&(u=y,m=a),i=ri(m)?m.call(i):m}return i}function rb(i,n,a){return i==null?i:Yn(i,n,a)}function ib(i,n,a,u){return u=typeof u=="function"?u:t,i==null?i:Yn(i,n,a,u)}var Ef=Nl(Ot),Df=Nl(Wt);function nb(i,n,a){var u=Ee(i),y=u||yi(i)||mn(i);if(n=fe(n,4),a==null){var m=i&&i.constructor;y?a=u?new m:[]:ut(i)?a=ri(m)?dn(no(i)):{}:a={}}return(y?ur:Ur)(i,function(A,F,T){return n(a,A,F,T)}),a}function sb(i,n){return i==null?!0:_c(i,n)}function ob(i,n,a){return i==null?i:yl(i,n,Ic(a))}function ab(i,n,a,u){return u=typeof u=="function"?u:t,i==null?i:yl(i,n,Ic(a),u)}function bn(i){return i==null?[]:rc(i,Ot(i))}function cb(i){return i==null?[]:rc(i,Wt(i))}function ub(i,n,a){return a===t&&(a=n,n=t),a!==t&&(a=gr(a),a=a===a?a:0),n!==t&&(n=gr(n),n=n===n?n:0),Ri(gr(i),n,a)}function hb(i,n,a){return n=ii(n),a===t?(a=n,n=0):a=ii(a),i=gr(i),y1(i,n,a)}function lb(i,n,a){if(a&&typeof a!="boolean"&&zt(i,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof i=="boolean"&&(a=i,i=t)),i===t&&n===t?(i=0,n=1):(i=ii(i),n===t?(n=i,i=0):n=ii(n)),i>n){var u=i;i=n,n=u}if(a||i%1||n%1){var y=kh();return Ut(i+y*(n-i+We("1e-"+((y+"").length-1))),n)}return mc(i,n)}var fb=yn(function(i,n,a){return n=n.toLowerCase(),i+(a?If(n):n)});function If(i){return Vc(Me(i).toLowerCase())}function Sf(i){return i=Me(i),i&&i.replace(Wr,r0).replace(Ga,"")}function pb(i,n,a){i=Me(i),n=rr(n);var u=i.length;a=a===t?u:Ri(Se(a),0,u);var y=a;return a-=n.length,a>=0&&i.slice(a,y)==n}function db(i){return i=Me(i),i&&Si.test(i)?i.replace(xs,i0):i}function gb(i){return i=Me(i),i&&Sa.test(i)?i.replace($n,"\\$&"):i}var yb=yn(function(i,n,a){return i+(a?"-":"")+n.toLowerCase()}),vb=yn(function(i,n,a){return i+(a?" ":"")+n.toLowerCase()}),mb=Ol("toLowerCase");function bb(i,n,a){i=Me(i),n=Se(n);var u=n?un(i):0;if(!n||u>=n)return i;var y=(n-u)/2;return Eo(co(y),a)+i+Eo(ao(y),a)}function wb(i,n,a){i=Me(i),n=Se(n);var u=n?un(i):0;return n&&u<n?i+Eo(n-u,a):i}function _b(i,n,a){i=Me(i),n=Se(n);var u=n?un(i):0;return n&&u<n?Eo(n-u,a)+i:i}function Eb(i,n,a){return a||n==null?n=0:n&&(n=+n),C0(Me(i).replace(Nn,""),n||0)}function Db(i,n,a){return(a?zt(i,n,a):n===t)?n=1:n=Se(n),bc(Me(i),n)}function Ib(){var i=arguments,n=Me(i[0]);return i.length<3?n:n.replace(i[1],i[2])}var Sb=yn(function(i,n,a){return i+(a?"_":"")+n.toLowerCase()});function Ab(i,n,a){return a&&typeof a!="number"&&zt(i,n,a)&&(n=a=t),a=a===t?ie:a>>>0,a?(i=Me(i),i&&(typeof n=="string"||n!=null&&!qc(n))&&(n=rr(n),!n&&cn(i))?gi(Ir(i),0,a):i.split(n,a)):[]}var Ob=yn(function(i,n,a){return i+(a?" ":"")+Vc(n)});function xb(i,n,a){return i=Me(i),a=a==null?0:Ri(Se(a),0,i.length),n=rr(n),i.slice(a,a+n.length)==n}function Cb(i,n,a){var u=v.templateSettings;a&&zt(i,n,a)&&(n=t),i=Me(i),n=To({},n,u,Tl);var y=To({},n.imports,u.imports,Tl),m=Ot(y),A=rc(y,m),F,T,z=0,q=n.interpolate||Qi,k="__p += '",X=nc((n.escape||Qi).source+"|"+q.source+"|"+(q===Xi?Fa:Qi).source+"|"+(n.evaluate||Qi).source+"|$","g"),oe="//# sourceURL="+(qe.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Wa+"]")+`
`;i.replace(X,function(me,Pe,Te,nr,qt,sr){return Te||(Te=nr),k+=i.slice(z,sr).replace(Ua,n0),Pe&&(F=!0,k+=`' +
__e(`+Pe+`) +
'`),qt&&(T=!0,k+=`';
`+qt+`;
__p += '`),Te&&(k+=`' +
((__t = (`+Te+`)) == null ? '' : __t) +
'`),z=sr+me.length,me}),k+=`';
`;var ve=qe.call(n,"variable")&&n.variable;if(!ve)k=`with (obj) {
`+k+`
}
`;else if(xa.test(ve))throw new we(f);k=(T?k.replace(Ea,""):k).replace(kr,"$1").replace(As,"$1;"),k="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(F?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+k+`return __p
}`;var Oe=Of(function(){return Be(m,oe+"return "+k).apply(t,A)});if(Oe.source=k,zc(Oe))throw Oe;return Oe}function Fb(i){return Me(i).toLowerCase()}function Pb(i){return Me(i).toUpperCase()}function $b(i,n,a){if(i=Me(i),i&&(a||n===t))return Rh(i);if(!i||!(n=rr(n)))return i;var u=Ir(i),y=Ir(n),m=Uh(u,y),A=jh(u,y)+1;return gi(u,m,A).join("")}function Nb(i,n,a){if(i=Me(i),i&&(a||n===t))return i.slice(0,Mh(i)+1);if(!i||!(n=rr(n)))return i;var u=Ir(i),y=jh(u,Ir(n))+1;return gi(u,0,y).join("")}function Tb(i,n,a){if(i=Me(i),i&&(a||n===t))return i.replace(Nn,"");if(!i||!(n=rr(n)))return i;var u=Ir(i),y=Uh(u,Ir(n));return gi(u,y).join("")}function Rb(i,n){var a=Z,u=ae;if(ut(n)){var y="separator"in n?n.separator:y;a="length"in n?Se(n.length):a,u="omission"in n?rr(n.omission):u}i=Me(i);var m=i.length;if(cn(i)){var A=Ir(i);m=A.length}if(a>=m)return i;var F=a-un(u);if(F<1)return u;var T=A?gi(A,0,F).join(""):i.slice(0,F);if(y===t)return T+u;if(A&&(F+=T.length-F),qc(y)){if(i.slice(F).search(y)){var z,q=T;for(y.global||(y=nc(y.source,Me(ar.exec(y))+"g")),y.lastIndex=0;z=y.exec(q);)var k=z.index;T=T.slice(0,k===t?F:k)}}else if(i.indexOf(rr(y),F)!=F){var X=T.lastIndexOf(y);X>-1&&(T=T.slice(0,X))}return T+u}function Ub(i){return i=Me(i),i&&Cn.test(i)?i.replace(Os,l0):i}var jb=yn(function(i,n,a){return i+(a?" ":"")+n.toUpperCase()}),Vc=Ol("toUpperCase");function Af(i,n,a){return i=Me(i),n=a?t:n,n===t?o0(i)?d0(i):Zg(i):i.match(n)||[]}var Of=Fe(function(i,n){try{return At(i,t,n)}catch(a){return zc(a)?a:new we(a)}}),Bb=ei(function(i,n){return ur(n,function(a){a=Br(a),Xr(i,a,Mc(i[a],i))}),i});function Mb(i){var n=i==null?0:i.length,a=fe();return i=n?it(i,function(u){if(typeof u[1]!="function")throw new hr(h);return[a(u[0]),u[1]]}):[],Fe(function(u){for(var y=-1;++y<n;){var m=i[y];if(At(m[0],this,u))return At(m[1],this,u)}})}function Lb(i){return l1(fr(i,b))}function kc(i){return function(){return i}}function zb(i,n){return i==null||i!==i?n:i}var qb=Cl(),Hb=Cl(!0);function Yt(i){return i}function Gc(i){return sl(typeof i=="function"?i:fr(i,b))}function Kb(i){return al(fr(i,b))}function Vb(i,n){return cl(i,fr(n,b))}var kb=Fe(function(i,n){return function(a){return Gn(a,i,n)}}),Gb=Fe(function(i,n){return function(a){return Gn(i,a,n)}});function Wc(i,n,a){var u=Ot(n),y=go(n,u);a==null&&!(ut(n)&&(y.length||!u.length))&&(a=n,n=i,i=this,y=go(n,Ot(n)));var m=!(ut(a)&&"chain"in a)||!!a.chain,A=ri(i);return ur(y,function(F){var T=n[F];i[F]=T,A&&(i.prototype[F]=function(){var z=this.__chain__;if(m||z){var q=i(this.__wrapped__),k=q.__actions__=kt(this.__actions__);return k.push({func:T,args:arguments,thisArg:i}),q.__chain__=z,q}return T.apply(i,ui([this.value()],arguments))})}),i}function Wb(){return Ne._===this&&(Ne._=w0),this}function Yc(){}function Yb(i){return i=Se(i),Fe(function(n){return ul(n,i)})}var Jb=Ac(it),Zb=Ac(Fh),Xb=Ac(Za);function xf(i){return Nc(i)?Xa(Br(i)):x1(i)}function Qb(i){return function(n){return i==null?t:Ui(i,n)}}var ew=Pl(),tw=Pl(!0);function Jc(){return[]}function Zc(){return!1}function rw(){return{}}function iw(){return""}function nw(){return!0}function sw(i,n){if(i=Se(i),i<1||i>G)return[];var a=ie,u=Ut(i,ie);n=fe(n),i-=ie;for(var y=tc(u,n);++a<i;)n(a);return y}function ow(i){return Ee(i)?it(i,Br):ir(i)?[i]:kt(Gl(Me(i)))}function aw(i){var n=++m0;return Me(i)+n}var cw=_o(function(i,n){return i+n},0),uw=Oc("ceil"),hw=_o(function(i,n){return i/n},1),lw=Oc("floor");function fw(i){return i&&i.length?po(i,Yt,fc):t}function pw(i,n){return i&&i.length?po(i,fe(n,2),fc):t}function dw(i){return Nh(i,Yt)}function gw(i,n){return Nh(i,fe(n,2))}function yw(i){return i&&i.length?po(i,Yt,yc):t}function vw(i,n){return i&&i.length?po(i,fe(n,2),yc):t}var mw=_o(function(i,n){return i*n},1),bw=Oc("round"),ww=_o(function(i,n){return i-n},0);function _w(i){return i&&i.length?ec(i,Yt):0}function Ew(i,n){return i&&i.length?ec(i,fe(n,2)):0}return v.after=Kv,v.ary=sf,v.assign=Pm,v.assignIn=bf,v.assignInWith=To,v.assignWith=$m,v.at=Nm,v.before=of,v.bind=Mc,v.bindAll=Bb,v.bindKey=af,v.castArray=rm,v.chain=tf,v.chunk=ly,v.compact=fy,v.concat=py,v.cond=Mb,v.conforms=Lb,v.constant=kc,v.countBy=_v,v.create=Tm,v.curry=cf,v.curryRight=uf,v.debounce=hf,v.defaults=Rm,v.defaultsDeep=Um,v.defer=Vv,v.delay=kv,v.difference=dy,v.differenceBy=gy,v.differenceWith=yy,v.drop=vy,v.dropRight=my,v.dropRightWhile=by,v.dropWhile=wy,v.fill=_y,v.filter=Dv,v.flatMap=Av,v.flatMapDeep=Ov,v.flatMapDepth=xv,v.flatten=Zl,v.flattenDeep=Ey,v.flattenDepth=Dy,v.flip=Gv,v.flow=qb,v.flowRight=Hb,v.fromPairs=Iy,v.functions=Hm,v.functionsIn=Km,v.groupBy=Cv,v.initial=Ay,v.intersection=Oy,v.intersectionBy=xy,v.intersectionWith=Cy,v.invert=km,v.invertBy=Gm,v.invokeMap=Pv,v.iteratee=Gc,v.keyBy=$v,v.keys=Ot,v.keysIn=Wt,v.map=xo,v.mapKeys=Ym,v.mapValues=Jm,v.matches=Kb,v.matchesProperty=Vb,v.memoize=Fo,v.merge=Zm,v.mergeWith=wf,v.method=kb,v.methodOf=Gb,v.mixin=Wc,v.negate=Po,v.nthArg=Yb,v.omit=Xm,v.omitBy=Qm,v.once=Wv,v.orderBy=Nv,v.over=Jb,v.overArgs=Yv,v.overEvery=Zb,v.overSome=Xb,v.partial=Lc,v.partialRight=lf,v.partition=Tv,v.pick=eb,v.pickBy=_f,v.property=xf,v.propertyOf=Qb,v.pull=Ny,v.pullAll=Ql,v.pullAllBy=Ty,v.pullAllWith=Ry,v.pullAt=Uy,v.range=ew,v.rangeRight=tw,v.rearg=Jv,v.reject=jv,v.remove=jy,v.rest=Zv,v.reverse=jc,v.sampleSize=Mv,v.set=rb,v.setWith=ib,v.shuffle=Lv,v.slice=By,v.sortBy=Hv,v.sortedUniq=Vy,v.sortedUniqBy=ky,v.split=Ab,v.spread=Xv,v.tail=Gy,v.take=Wy,v.takeRight=Yy,v.takeRightWhile=Jy,v.takeWhile=Zy,v.tap=fv,v.throttle=Qv,v.thru=Oo,v.toArray=yf,v.toPairs=Ef,v.toPairsIn=Df,v.toPath=ow,v.toPlainObject=mf,v.transform=nb,v.unary=em,v.union=Xy,v.unionBy=Qy,v.unionWith=ev,v.uniq=tv,v.uniqBy=rv,v.uniqWith=iv,v.unset=sb,v.unzip=Bc,v.unzipWith=ef,v.update=ob,v.updateWith=ab,v.values=bn,v.valuesIn=cb,v.without=nv,v.words=Af,v.wrap=tm,v.xor=sv,v.xorBy=ov,v.xorWith=av,v.zip=cv,v.zipObject=uv,v.zipObjectDeep=hv,v.zipWith=lv,v.entries=Ef,v.entriesIn=Df,v.extend=bf,v.extendWith=To,Wc(v,v),v.add=cw,v.attempt=Of,v.camelCase=fb,v.capitalize=If,v.ceil=uw,v.clamp=ub,v.clone=im,v.cloneDeep=sm,v.cloneDeepWith=om,v.cloneWith=nm,v.conformsTo=am,v.deburr=Sf,v.defaultTo=zb,v.divide=hw,v.endsWith=pb,v.eq=Ar,v.escape=db,v.escapeRegExp=gb,v.every=Ev,v.find=Iv,v.findIndex=Yl,v.findKey=jm,v.findLast=Sv,v.findLastIndex=Jl,v.findLastKey=Bm,v.floor=lw,v.forEach=rf,v.forEachRight=nf,v.forIn=Mm,v.forInRight=Lm,v.forOwn=zm,v.forOwnRight=qm,v.get=Hc,v.gt=cm,v.gte=um,v.has=Vm,v.hasIn=Kc,v.head=Xl,v.identity=Yt,v.includes=Fv,v.indexOf=Sy,v.inRange=hb,v.invoke=Wm,v.isArguments=Mi,v.isArray=Ee,v.isArrayBuffer=hm,v.isArrayLike=Gt,v.isArrayLikeObject=dt,v.isBoolean=lm,v.isBuffer=yi,v.isDate=fm,v.isElement=pm,v.isEmpty=dm,v.isEqual=gm,v.isEqualWith=ym,v.isError=zc,v.isFinite=vm,v.isFunction=ri,v.isInteger=ff,v.isLength=$o,v.isMap=pf,v.isMatch=mm,v.isMatchWith=bm,v.isNaN=wm,v.isNative=_m,v.isNil=Dm,v.isNull=Em,v.isNumber=df,v.isObject=ut,v.isObjectLike=lt,v.isPlainObject=Qn,v.isRegExp=qc,v.isSafeInteger=Im,v.isSet=gf,v.isString=No,v.isSymbol=ir,v.isTypedArray=mn,v.isUndefined=Sm,v.isWeakMap=Am,v.isWeakSet=Om,v.join=Fy,v.kebabCase=yb,v.last=dr,v.lastIndexOf=Py,v.lowerCase=vb,v.lowerFirst=mb,v.lt=xm,v.lte=Cm,v.max=fw,v.maxBy=pw,v.mean=dw,v.meanBy=gw,v.min=yw,v.minBy=vw,v.stubArray=Jc,v.stubFalse=Zc,v.stubObject=rw,v.stubString=iw,v.stubTrue=nw,v.multiply=mw,v.nth=$y,v.noConflict=Wb,v.noop=Yc,v.now=Co,v.pad=bb,v.padEnd=wb,v.padStart=_b,v.parseInt=Eb,v.random=lb,v.reduce=Rv,v.reduceRight=Uv,v.repeat=Db,v.replace=Ib,v.result=tb,v.round=bw,v.runInContext=N,v.sample=Bv,v.size=zv,v.snakeCase=Sb,v.some=qv,v.sortedIndex=My,v.sortedIndexBy=Ly,v.sortedIndexOf=zy,v.sortedLastIndex=qy,v.sortedLastIndexBy=Hy,v.sortedLastIndexOf=Ky,v.startCase=Ob,v.startsWith=xb,v.subtract=ww,v.sum=_w,v.sumBy=Ew,v.template=Cb,v.times=sw,v.toFinite=ii,v.toInteger=Se,v.toLength=vf,v.toLower=Fb,v.toNumber=gr,v.toSafeInteger=Fm,v.toString=Me,v.toUpper=Pb,v.trim=$b,v.trimEnd=Nb,v.trimStart=Tb,v.truncate=Rb,v.unescape=Ub,v.uniqueId=aw,v.upperCase=jb,v.upperFirst=Vc,v.each=rf,v.eachRight=nf,v.first=Xl,Wc(v,function(){var i={};return Ur(v,function(n,a){qe.call(v.prototype,a)||(i[a]=n)}),i}(),{chain:!1}),v.VERSION=s,ur(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){v[i].placeholder=v}),ur(["drop","take"],function(i,n){$e.prototype[i]=function(a){a=a===t?1:Dt(Se(a),0);var u=this.__filtered__&&!n?new $e(this):this.clone();return u.__filtered__?u.__takeCount__=Ut(a,u.__takeCount__):u.__views__.push({size:Ut(a,ie),type:i+(u.__dir__<0?"Right":"")}),u},$e.prototype[i+"Right"]=function(a){return this.reverse()[i](a).reverse()}}),ur(["filter","map","takeWhile"],function(i,n){var a=n+1,u=a==de||a==M;$e.prototype[i]=function(y){var m=this.clone();return m.__iteratees__.push({iteratee:fe(y,3),type:a}),m.__filtered__=m.__filtered__||u,m}}),ur(["head","last"],function(i,n){var a="take"+(n?"Right":"");$e.prototype[i]=function(){return this[a](1).value()[0]}}),ur(["initial","tail"],function(i,n){var a="drop"+(n?"":"Right");$e.prototype[i]=function(){return this.__filtered__?new $e(this):this[a](1)}}),$e.prototype.compact=function(){return this.filter(Yt)},$e.prototype.find=function(i){return this.filter(i).head()},$e.prototype.findLast=function(i){return this.reverse().find(i)},$e.prototype.invokeMap=Fe(function(i,n){return typeof i=="function"?new $e(this):this.map(function(a){return Gn(a,i,n)})}),$e.prototype.reject=function(i){return this.filter(Po(fe(i)))},$e.prototype.slice=function(i,n){i=Se(i);var a=this;return a.__filtered__&&(i>0||n<0)?new $e(a):(i<0?a=a.takeRight(-i):i&&(a=a.drop(i)),n!==t&&(n=Se(n),a=n<0?a.dropRight(-n):a.take(n-i)),a)},$e.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},$e.prototype.toArray=function(){return this.take(ie)},Ur($e.prototype,function(i,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),y=v[u?"take"+(n=="last"?"Right":""):n],m=u||/^find/.test(n);y&&(v.prototype[n]=function(){var A=this.__wrapped__,F=u?[1]:arguments,T=A instanceof $e,z=F[0],q=T||Ee(A),k=function(Pe){var Te=y.apply(v,ui([Pe],F));return u&&X?Te[0]:Te};q&&a&&typeof z=="function"&&z.length!=1&&(T=q=!1);var X=this.__chain__,oe=!!this.__actions__.length,ve=m&&!X,Oe=T&&!oe;if(!m&&q){A=Oe?A:new $e(this);var me=i.apply(A,F);return me.__actions__.push({func:Oo,args:[k],thisArg:t}),new lr(me,X)}return ve&&Oe?i.apply(this,F):(me=this.thru(k),ve?u?me.value()[0]:me.value():me)})}),ur(["pop","push","shift","sort","splice","unshift"],function(i){var n=Xs[i],a=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",u=/^(?:pop|shift)$/.test(i);v.prototype[i]=function(){var y=arguments;if(u&&!this.__chain__){var m=this.value();return n.apply(Ee(m)?m:[],y)}return this[a](function(A){return n.apply(Ee(A)?A:[],y)})}}),Ur($e.prototype,function(i,n){var a=v[n];if(a){var u=a.name+"";qe.call(pn,u)||(pn[u]=[]),pn[u].push({name:n,func:a})}}),pn[wo(t,H).name]=[{name:"wrapper",func:t}],$e.prototype.clone=U0,$e.prototype.reverse=j0,$e.prototype.value=B0,v.prototype.at=pv,v.prototype.chain=dv,v.prototype.commit=gv,v.prototype.next=yv,v.prototype.plant=mv,v.prototype.reverse=bv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=wv,v.prototype.first=v.prototype.head,Ln&&(v.prototype[Ln]=vv),v},hn=g0();pt?((pt.exports=hn)._=hn,Ye._=hn):Ne._=hn}).call(us)})(Ju,Ju.exports);var TA=Object.defineProperty,RA=Object.defineProperties,UA=Object.getOwnPropertyDescriptors,nd=Object.getOwnPropertySymbols,jA=Object.prototype.hasOwnProperty,BA=Object.prototype.propertyIsEnumerable,sd=(r,e,t)=>e in r?TA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ho=(r,e)=>{for(var t in e||(e={}))jA.call(e,t)&&sd(r,t,e[t]);if(nd)for(var t of nd(e))BA.call(e,t)&&sd(r,t,e[t]);return r},MA=(r,e)=>RA(r,UA(e));function br(r,e,t){let s;const o=Zu(r);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${NA}?chainId=eip155:${o}&projectId=${t}`),s}function Zu(r){return r.includes("eip155")?Number(r.split(":")[1]):Number(r)}function Kg(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function LA(r,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(r));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function zA(r={},e={}){const t=od(r),s=od(e);return Ju.exports.merge(t,s)}function od(r){var e,t,s,o;const c={};if(!An(r))return c;for(const[h,f]of Object.entries(r)){const p=dh(h)?[h]:f.chains,d=f.methods||[],g=f.events||[],b=f.rpcMap||{},E=ko(h);c[E]=MA(Ho(Ho({},c[E]),f),{chains:iu(p,(e=c[E])==null?void 0:e.chains),methods:iu(d,(t=c[E])==null?void 0:t.methods),events:iu(g,(s=c[E])==null?void 0:s.events),rpcMap:Ho(Ho({},b),(o=c[E])==null?void 0:o.rpcMap)})}return c}function qA(r){return r.includes(":")?r.split(":")[2]:r}function HA(r){const e={};for(const[t,s]of Object.entries(r)){const o=s.methods||[],c=s.events||[],h=s.accounts||[],f=dh(t)?[t]:s.chains?s.chains:Kg(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:h}}return e}const Vg={},mt=r=>Vg[r],Du=(r,e)=>{Vg[r]=e};class KA{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||br(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||br(e,this.namespace);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}}class VA{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=Zu(e);if(!this.httpProviders[s]){const o=t||br(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||br(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Zu(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class kA{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||br(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||br(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}}class GA{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||br(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||br(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}}class WA{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}}class YA{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||br(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||br(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}}class JA{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=mt("events"),this.client=mt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||br(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||br(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Yi(new Vi(s,mt("disableProviderPing")))}}var ZA=Object.defineProperty,XA=Object.defineProperties,QA=Object.getOwnPropertyDescriptors,ad=Object.getOwnPropertySymbols,eO=Object.prototype.hasOwnProperty,tO=Object.prototype.propertyIsEnumerable,cd=(r,e,t)=>e in r?ZA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ko=(r,e)=>{for(var t in e||(e={}))eO.call(e,t)&&cd(r,t,e[t]);if(ad)for(var t of ad(e))tO.call(e,t)&&cd(r,t,e[t]);return r},Iu=(r,e)=>XA(r,QA(e));class xh{constructor(e){this.events=new th,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:va(ma({level:(e==null?void 0:e.logger)||rd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new xh(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Ko({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:yt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=HA(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==qg)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Kr(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await CA.init({logger:this.providerOpts.logger||rd,relayUrl:this.providerOpts.relayUrl||FA,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ko(t)))];Du("client",this.client),Du("events",this.events),Du("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=LA(t,this.session),o=Kg(s),c=zA(this.namespaces,this.optionalNamespaces),h=Iu(Ko({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new VA({namespace:h});break;case"solana":this.rpcProviders[t]=new kA({namespace:h});break;case"cosmos":this.rpcProviders[t]=new GA({namespace:h});break;case"polkadot":this.rpcProviders[t]=new KA({namespace:h});break;case"cip34":this.rpcProviders[t]=new WA({namespace:h});break;case"elrond":this.rpcProviders[t]=new YA({namespace:h});break;case"multiversx":this.rpcProviders[t]=new JA({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&Kr(o)&&this.events.emit("accountsChanged",o.map(qA))}else s.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Iu(Ko({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Iu(Ko({},yt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Ii.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(h=>ko(h)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=ko(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${id}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${id}/${e}`)}}const rO=xh,iO="wc",nO="ethereum_provider",sO=`${iO}@2:${nO}:`,oO="https://rpc.walletconnect.com/v1/",Xu=["eth_sendTransaction","personal_sign"],aO=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Qu=["chainChanged","accountsChanged"],cO=["message","disconnect","connect"];var uO=Object.defineProperty,hO=Object.defineProperties,lO=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,fO=Object.prototype.hasOwnProperty,pO=Object.prototype.propertyIsEnumerable,hd=(r,e,t)=>e in r?uO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hs=(r,e)=>{for(var t in e||(e={}))fO.call(e,t)&&hd(r,t,e[t]);if(ud)for(var t of ud(e))pO.call(e,t)&&hd(r,t,e[t]);return r},ld=(r,e)=>hO(r,lO(e));function na(r){return Number(r[0].split(":")[1])}function Su(r){return`0x${r.toString(16)}`}function dO(r){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:h,rpcMap:f}=r;if(!Kr(e))throw new Error("Invalid chains");const p={chains:e,methods:s||Xu,events:c||Qu,rpcMap:hs({},e.length?{[na(e)]:f[na(e)]}:{})},d=c==null?void 0:c.filter(I=>!Qu.includes(I)),g=s==null?void 0:s.filter(I=>!Xu.includes(I));if(!t&&!h&&!o&&!(d!=null&&d.length)&&!(g!=null&&g.length))return{required:e.length?p:void 0};const b=(d==null?void 0:d.length)&&(g==null?void 0:g.length)||!t,E={chains:[...new Set(b?p.chains.concat(t||[]):t)],methods:[...new Set(p.methods.concat(o!=null&&o.length?o:aO))],events:[...new Set(p.events.concat(h||cO))],rpcMap:f};return{required:e.length?p:void 0,optional:t.length?E:void 0}}class Ch{constructor(){this.events=new wr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=sO,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Ch;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=dO(this.rpc);try{const o=await new Promise(async(h,f)=>{var p;this.rpc.showQrModal&&((p=this.modal)==null||p.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ld(hs({namespaces:hs({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(d=>{h(d)}).catch(d=>{f(new Error(d.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const c=WE(o.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:Su(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Su(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",ld(hs({},yt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Su(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],h=o.concat(c);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Xu:[],p=o.length?(e==null?void 0:e.events)||Qu:[],d=(e==null?void 0:e.optionalMethods)||[],g=(e==null?void 0:e.optionalEvents)||[],b=(e==null?void 0:e.rpcMap)||this.buildRpcMap(h,e.projectId),E=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(I=>this.formatChainId(I)),optionalChains:c.map(I=>this.formatChainId(I)),methods:f,events:p,optionalMethods:d,optionalEvents:g,rpcMap:b,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:E,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?na(this.rpc.chains):na(this.rpc.optionalChains),this.signer=await rO.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await Sw(()=>import("./index-2583cf53.js").then(o=>o.i),["assets/index-2583cf53.js","assets/index-d2d9d8b3.js","assets/index-ce95718a.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(hs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&Kr(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&Kr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${oO}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const CO=Ch;export{CO as EthereumProvider,cO as OPTIONAL_EVENTS,aO as OPTIONAL_METHODS,Qu as REQUIRED_EVENTS,Xu as REQUIRED_METHODS,Ch as default};
